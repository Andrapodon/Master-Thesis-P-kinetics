<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marc PErez">
<meta name="dcterms.date" content="2025-02-13">

<title>Modeling of relative Yield, P-Uptake and P-Balance â€“ My Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-7229ea2d82a3ea005184f5867d77b5fa.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">My Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Article</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../notebooks/presentation.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="mlr3.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="mlr3.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modeling of relative Yield, P-Uptake and P-Balance</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marc PErez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>RES <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/RES.rds"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Dmlr <span class="ot">&lt;-</span> RES<span class="sc">$</span>nlme.coef.mrg</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Dmlr<span class="sc">$</span>soil_0_20_P_CO2_log[<span class="fu">is.infinite</span>(Dmlr<span class="sc">$</span>soil_0_20_P_CO2_log)] <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Dmlr<span class="sc">$</span>soil_0_20_P_AAE10_log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]        NA 3.0773123        NA 2.9069011        NA 2.9601051        NA
  [8] 2.9069011        NA 3.9815491        NA 3.7954892 3.5973123        NA
 [15]        NA 3.5890591        NA 4.4485164        NA 4.2541933 3.9926809
 [22]        NA        NA 4.4578296 1.8870696 2.1162555 2.3321439 2.2300144
 [29] 2.4069451 2.3321439 2.3887628        NA 2.1972246 1.8245493        NA
 [36] 2.3795461 2.4849066 2.3223877 2.3418058 2.3418058 2.1400662 2.2925348
 [43] 0.8329091 1.9878743 1.7047481 2.9069011 1.7047481 1.1939225 1.7917595
 [50]        NA 1.6292405 1.7749524 2.6461748 1.4586150        NA 1.9878743
 [57] 2.1282317 2.1162555 1.8870696 2.1162555 3.1441523 3.4111477 3.2425924
 [64]        NA 3.1863526 3.4045252 3.1945831 3.1863526 3.1045867        NA
 [71] 2.7850112 2.7972813 2.9014216 2.8449094 2.8094027 2.7850112 3.2580965
 [78] 3.0007198 2.4069451 2.6026897 2.8033604 2.6026897 2.5726122 2.7663191
 [85] 2.7343675        NA 2.9069011 2.8903718        NA 3.0587071 2.9069011
 [92] 2.9069011 3.1045867 2.8390785 2.6741486 3.3809947 4.2017031 4.3907386
 [99] 4.3000028 4.0412953        NA 4.1697612 4.0656021 4.2640873 4.0656021
[106] 3.1822118 2.6461748 3.3809947 3.0540012        NA 3.0726933 3.0955776
[113] 2.6461748 3.0056826        NA 3.4873751 3.5945688 3.7424202 3.8044378
[120] 3.5945688 3.4531571 4.0412953 3.6480575 2.7013612 2.7472709 2.8507065
[127] 2.7472709        NA 2.6100698 2.4069451 2.6390573 2.7013612 3.1223649
[134] 2.8622009        NA 2.9123507 3.1223649 2.8507065 3.0106209 3.0492730
[141] 2.1860513 2.9391619 2.9014216 2.9652731 2.9391619 2.8903718 3.1570004
[148]        NA 3.1045867 3.1570004 2.7972813 2.4336134 2.8033604 2.7146947
[155] 2.3608540 2.2407097 2.7146947 2.3702437        NA 3.4468079 3.2580965
[162]        NA 3.4011974 3.3534067 3.3141860 3.0056826 3.5055574 3.2580965
[169] 3.1986731 3.5025499 3.3741687 3.4812401        NA 3.3741687 3.3741687
[176] 3.4750672 3.3393220        NA 3.6163088 3.4719665 3.6988298 3.6788291
[183] 3.4242627 3.5496174 3.5496174 3.2542430        NA 2.7343675 3.1223649
[190] 2.8390785 2.8033604 2.7343675 2.8390785 3.1267605 2.7972813 3.2771447
[197] 3.5973123        NA 3.5751507 3.5695327 3.5695327 3.8712010 3.1441523
[204] 3.6163088 4.0741419 3.7352858 3.8329798 3.9039908 3.6584202 3.6635616
[211] 3.6635616 3.7376696        NA 3.8133070 3.6963515 3.6963515 3.7954892
[218] 3.5890591        NA 3.9512437 3.9160150 3.7773481        NA 3.6737658
[225] 3.8372995 3.7447871 3.6813512 3.6838669 3.4307562 3.7954892 3.6838669
[232] 2.9338569 2.4765384 2.7911651 2.7725887 2.6741486 2.9338569 2.7725887
[239] 2.5649494        NA 2.6741486 2.6672282 2.9123507 2.6878475 2.7013612
[246] 2.9704145        NA 2.6878475 2.6390573 2.9123507 2.7600099 2.8213789
[253] 3.0540012 2.8903718 3.2228678 3.0252911        NA 3.2228678 3.2695689
[260] 3.0106209 3.0106209 2.7911651        NA 2.4510051 2.4423470 2.2823824
[267] 2.5416020 2.6461748 2.2823824 2.7911651 2.4510051 3.5174978 3.6609943
[274] 3.9019727 3.4843123        NA 3.4078419 3.4372078 3.9019727 3.6323091
[281] 3.4078419 3.4499875 3.6813512 3.3741687 3.2733640 3.3286267        NA
[288] 3.3877744 3.6813512 3.3741687 3.4307562 4.1541846 3.5263605 3.5467397
[295]        NA 4.1541846 3.8649314 3.4339872 3.6296601 3.5263605 3.8372995
[302] 3.0955776 3.2386785 3.4594663 3.2386785 3.3178158 3.4339872 3.1484534
[309] 3.6712245 3.6712245        NA 3.7062281 3.6349511 3.6428355 3.7977339
[316] 4.2766661        NA 3.6349511 3.7424202 4.2766661 3.8607297 3.6712245
[323]        NA 3.4339872 3.7208625 3.7352858 3.6323091 3.9569964 3.5174978
[330] 3.4339872 3.9569964 3.4688560 4.1125119 3.5204608 3.6661225 3.6082116
[337] 3.7887248 3.4688560 4.1125119        NA 3.6270041 4.0758411 4.0621657
[344] 4.1447208        NA 3.9627161 3.9926809 3.9627161 4.1447208 4.2556127
[351] 4.0360090 2.9856819 2.5095993 3.0301337        NA 3.0301337 2.7013612
[358] 2.7212954 2.8094027 2.6810215 2.9856819 2.9177707 2.7408400        NA
[365] 2.8213789 2.9177707 3.0155349 2.9549103 2.5572273 2.9549103 2.9014216
[372] 3.5263605        NA 3.6136170 3.4563167 3.2958369 3.4563167 3.6216707
[379] 3.5234150 3.5263605 3.3286267 2.9014216 2.9391619 2.7663191 2.9391619
[386] 2.6246686 2.8390785 2.5014360 2.7663191        NA 3.1696856 4.1383614
[393]        NA 3.8501476 4.1141472 4.0342406 4.1141472 4.1383614 3.9759363
[400] 3.9239516 4.2253728 3.9180051        NA 3.8351420 4.2061840 3.9796817
[407] 3.9376908 3.8774316 4.2061840 3.9852735 3.9852735 3.6686767 3.5723456
[414] 3.6686767 3.2228678 3.5695327 3.3568971 3.2347492        NA 3.5582011
[421] 3.5723456 3.7037681 4.2106450 3.6054978 3.8066625 3.8416005 3.7013020
[428] 3.8066625 4.2106450        NA 3.5582011 4.3832759 4.6288867 4.3502779
[435] 4.2499228 4.3956830 4.3832759 4.3254563        NA 4.6288867 4.3385971
[442] 4.3770141 4.5358201 4.3081110 4.2282925        NA 4.3515674 4.3515674
[449] 4.5358201 4.5174313 4.4601444 4.2668963 4.1972019 4.2456340 4.3294167
[456] 4.3993753 4.3993753 4.2456340 4.2668963        NA 4.1287460 3.9702919
[463] 3.7376696 3.9702919 4.0758411 3.9039908 4.0656021 4.1972019        NA
[470] 3.9473901 4.1972019</code></pre>
</div>
<div class="sourceCode cell-code hidden" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- RES$data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<details class="code-fold hidden">
<summary>Benchmark helper function</summary>
<div class="sourceCode cell-code hidden" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Benchmark helper function"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3verse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"regr.mse"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">interactive</span>())</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>get_benchi_table <span class="ot">&lt;-</span> <span class="cf">function</span>(tasks, <span class="at">nfolds =</span> <span class="dv">5</span>) {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  learners <span class="ot">&lt;-</span> <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">"regr.featureless"</span>, <span class="st">"regr.lm"</span>, <span class="st">"regr.xgboost"</span>, <span class="st">"regr.ranger"</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  learners<span class="sc">$</span>regr.xgboost<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">set_values</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.04</span>, </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">300</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">2</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  benchi <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">benchmark</span>(<span class="fu">benchmark_grid</span>(</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      tasks, </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      learners, </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> nfolds)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"benchmark.rds"</span>, </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">"cache/"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">hash =</span> <span class="fu">list</span>(tasks, nfolds)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(benchi<span class="sc">$</span><span class="fu">aggregate</span>(mse), </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> task_id,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> learner_id,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> regr.mse</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(res) <span class="ot">&lt;-</span> res<span class="sc">$</span>task_id</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> res[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"regr."</span>, <span class="st">""</span>, <span class="fu">colnames</span>(res))</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">any</span>(<span class="fu">colnames</span>(res) <span class="sc">==</span> <span class="st">"featureless"</span>))</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> res <span class="sc">/</span> res<span class="sc">$</span>featureless</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  res[, <span class="sc">-</span><span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Testing prediction quality using</p>
<ul>
<li>Linear models</li>
<li>Random forests (default parameters)</li>
<li>XGBoost (with parameter tuning)</li>
</ul>
<p><strong>Weather Variables:</strong></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Weather_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"anavg_temp"</span>, <span class="st">"ansum_prec"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"juvdev_prec"</span>, <span class="st">"juvdev_sun"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ansum_sun"</span>, <span class="st">"juvdev_temp"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(Weather_vars <span class="sc">%in%</span> <span class="fu">names</span>(Dmlr)))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Weather_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "anavg_temp"  "ansum_prec"  "juvdev_prec" "juvdev_sun"  "ansum_sun"  
[6] "juvdev_temp"</code></pre>
</div>
</div>
<p><strong>Phosphor Variable sets:</strong></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>P_var_sets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyweather =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="st">"k"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">PS =</span> <span class="st">"PS_log"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">kPS =</span> <span class="fu">c</span>(<span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10 =</span> <span class="st">"soil_0_20_P_AAE10_log"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2 =</span> <span class="st">"soil_0_20_P_CO2_log"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2 =</span> <span class="fu">c</span>(<span class="st">"soil_0_20_P_AAE10_log"</span>, <span class="st">"soil_0_20_P_CO2_log"</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"soil_0_20_P_AAE10_log"</span>, <span class="st">"soil_0_20_P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"soil_0_20_P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Response Variables</strong></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Y_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ymain_rel"</span>, <span class="st">"annual_P_uptake"</span>, <span class="st">"annual_P_balance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-weather-data" class="level2">
<h2 class="anchored" data-anchor-id="with-weather-data">With Weather data</h2>
<section id="todo-group---cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="todo-group---cross-validation">TODO: Group - cross validation</h3>
<pre><code>\(nam){
  mytsk &lt;- as_task_regr(
    Dmlr[complete.cases(Dmlr$Ymain_rel), c(y, Weather_vars, P_var_sets[[nam]], "Site")],
    target = y,
    id = nam)
  mytsk$set_col_roles("Site", "group")
  mytsk
}</code></pre>
<p>Algorithm learns to predict location from weather since we do not do stratified cross-validation (leaving out locations).</p>
</section>
<section id="ymain_rel" class="level3">
<h3 class="anchored" data-anchor-id="ymain_rel">Ymain_rel</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"Ymain_rel"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, Weather_vars, P_var_sets[[nam]])],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>() <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.542</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">0.505</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.195</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">0.596</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.618</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.598</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.638</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.651</td>
<td style="text-align: right;">0.647</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: right;">0.625</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.201</td>
<td style="text-align: right;">0.518</td>
<td style="text-align: right;">0.520</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.487</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: right;">0.603</td>
<td style="text-align: right;">0.585</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.555</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.294</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.582</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.578</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.594</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.347</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.607</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.575</td>
</tr>
</tbody>
</table>
</section>
<section id="annual_p_uptake" class="level3">
<h3 class="anchored" data-anchor-id="annual_p_uptake">annual_P_uptake</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"annual_P_uptake"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, Weather_vars, P_var_sets[[nam]])],</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>()  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">0.784</td>
<td style="text-align: right;">0.782</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.380</td>
<td style="text-align: right;">0.763</td>
<td style="text-align: right;">0.766</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0.757</td>
<td style="text-align: right;">0.816</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">0.814</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.822</td>
<td style="text-align: right;">0.834</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.797</td>
<td style="text-align: right;">0.846</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.855</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.819</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.840</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.649</td>
<td style="text-align: right;">0.648</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.564</td>
<td style="text-align: right;">0.609</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.617</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.459</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">0.474</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.619</td>
<td style="text-align: right;">0.621</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.642</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">0.580</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.465</td>
<td style="text-align: right;">0.528</td>
<td style="text-align: right;">0.423</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.428</td>
</tr>
</tbody>
</table>
</section>
<section id="annual_p_balance" class="level3">
<h3 class="anchored" data-anchor-id="annual_p_balance">annual_P_balance</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"annual_P_balance"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, Weather_vars, P_var_sets[[nam]])],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>()  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">0.102</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.565</td>
<td style="text-align: right;">0.243</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.627</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.774</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.860</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.392</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.561</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">0.707</td>
<td style="text-align: right;">0.695</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.732</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.827</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.866</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">0.121</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">-0.008</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">0.127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.608</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.282</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">0.524</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.591</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.585</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.617</td>
<td style="text-align: right;">0.596</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.302</td>
<td style="text-align: right;">0.626</td>
<td style="text-align: right;">0.631</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="without-weather-data" class="level2">
<h2 class="anchored" data-anchor-id="without-weather-data">Without Weather data</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"onlyweather"</span> <span class="sc">%in%</span> <span class="fu">names</span>(P_var_sets))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  P_var_sets <span class="ot">&lt;-</span> P_var_sets[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>xgboost &amp; ranger are no good in this setting since only very few variables available</p>
<section id="ymain_rel-1" class="level3">
<h3 class="anchored" data-anchor-id="ymain_rel-1">Ymain_rel</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"Ymain_rel"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, P_var_sets[[nam]])],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>()  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">-0.010</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">-0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">-0.124</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">-0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">-0.107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">-0.009</td>
<td style="text-align: right;">-0.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.095</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">-0.032</td>
<td style="text-align: right;">-0.044</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">-0.200</td>
<td style="text-align: right;">-0.312</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">-0.141</td>
<td style="text-align: right;">-0.221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">-0.343</td>
<td style="text-align: right;">-0.353</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">-0.009</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">-0.086</td>
<td style="text-align: right;">-0.226</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">-0.045</td>
<td style="text-align: right;">-0.059</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">-0.168</td>
<td style="text-align: right;">-0.196</td>
</tr>
</tbody>
</table>
</section>
<section id="annual_p_uptake-1" class="level3">
<h3 class="anchored" data-anchor-id="annual_p_uptake-1">annual_P_uptake</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"annual_P_uptake"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, P_var_sets[[nam]])],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>()  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">-0.028</td>
<td style="text-align: right;">-0.103</td>
<td style="text-align: right;">-0.170</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">-0.024</td>
<td style="text-align: right;">-0.123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">-0.152</td>
<td style="text-align: right;">-0.199</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">-0.129</td>
<td style="text-align: right;">-0.254</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">-0.078</td>
<td style="text-align: right;">-0.176</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">-0.012</td>
<td style="text-align: right;">-0.058</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">-0.066</td>
<td style="text-align: right;">-0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">-0.059</td>
<td style="text-align: right;">-0.083</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">-0.265</td>
<td style="text-align: right;">-0.434</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">-0.278</td>
<td style="text-align: right;">-0.485</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">-0.225</td>
<td style="text-align: right;">-0.317</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">-0.139</td>
<td style="text-align: right;">-0.398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">-0.126</td>
<td style="text-align: right;">-0.276</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-0.194</td>
<td style="text-align: right;">-0.310</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">-0.229</td>
<td style="text-align: right;">-0.363</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">-0.054</td>
<td style="text-align: right;">-0.206</td>
<td style="text-align: right;">-0.295</td>
</tr>
</tbody>
</table>
</section>
<section id="annual_p_balance-1" class="level3">
<h3 class="anchored" data-anchor-id="annual_p_balance-1">annual_P_balance</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"annual_P_balance"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(P_var_sets), \(nam) <span class="fu">as_task_regr</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    Dmlr[<span class="fu">complete.cases</span>(Dmlr[,<span class="fu">c</span>(<span class="st">"Ymain_rel"</span>,Weather_vars,P_var_sets<span class="sc">$</span>AAE10_CO2_kPS)]),<span class="fu">c</span>(y, P_var_sets[[nam]])],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> y,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> nam)) <span class="sc">|&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_benchi_table</span>()  <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.499</td>
<td style="text-align: right;">0.629</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.598</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">0.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.598</td>
<td style="text-align: right;">0.681</td>
<td style="text-align: right;">0.667</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">0.401</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">0.498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.700</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.589</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.680</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">lm</th>
<th style="text-align: right;">xgboost</th>
<th style="text-align: right;">ranger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.160</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.274</td>
<td style="text-align: right;">0.178</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.244</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">-0.102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: right;">0.201</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">0.274</td>
<td style="text-align: right;">0.243</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Dmlr<span class="sc">$</span>annual_P_balance, Dmlr<span class="sc">$</span>PS) <span class="co"># 0.54389</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5611764</code></pre>
</div>
<div class="sourceCode cell-code hidden" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Dmlr<span class="sc">$</span>fert_P_tot, Dmlr<span class="sc">$</span>PS) <span class="co"># 0.48236</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5455537</code></pre>
</div>
<div class="sourceCode cell-code hidden" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Dmlr<span class="sc">$</span>annual_P_uptake, Dmlr<span class="sc">$</span>PS) <span class="co"># 0.070678</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09920453</code></pre>
</div>
</div>
<p>We did manage to have high predictive power for weather. This could also be due to our regression models recovering location&amp;year from it and hence still overfitting on the test set.</p>
<p>Without Weather data we only managed for annual balance to get some predictive power (30%). Since we the balance is uptake - fert_P, this means that we mostly predicted fert_P. Interestingly PS is best to predict this quantity</p>
</section>
<section id="legacy-code" class="level3">
<h3 class="anchored" data-anchor-id="legacy-code">Legacy Code</h3>
<div class="cell">
<details class="code-fold hidden">
<summary>XGBoost - Parameter Tuning</summary>
<div class="sourceCode cell-code hidden" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "XGBoost - Parameter Tuning"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter estimates for XGBoost</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Dmlr[<span class="fu">complete.cases</span>(Dmlr<span class="sc">$</span>annual_P_balance),], </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"annual_P_balance"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS<span class="co">#, Weather_vars</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">target =</span> <span class="st">"annual_P_balance"</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"regr.xgboost"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="dv">500</span>  <span class="co"># More iterations due to lower learning rate</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create search space</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ps</span>(</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">p_int</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">p_dbl</span>(<span class="fl">0.001</span>, <span class="fl">0.3</span>, <span class="at">tags =</span> <span class="st">"logscale"</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup tuning</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>instance <span class="ot">&lt;-</span> <span class="fu">ti</span>(</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">task =</span> t,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> l,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>),</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">"regr.mse"</span>),</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">terminator =</span> <span class="fu">trm</span>(<span class="st">"none"</span>),</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">search_space =</span> ps</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid search</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>tuner <span class="ot">&lt;-</span> mlr3tuning<span class="sc">::</span><span class="fu">tnr</span>(<span class="st">"grid_search"</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>tuner<span class="sc">$</span><span class="fu">optimize</span>(instance)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>instance<span class="sc">$</span>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ymain_rel max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.067444 &lt;list[5]&gt; &lt;list[2]&gt; 177.18</num></list></list></num></int></p>
<p>P uptake max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 137.41</num></list></list></num></int></p>
<p>annual_P_balance max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 145.21</num></list></list></num></int></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef$kPS &lt;- nlme.coef$k * nlme.coef$PS</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef.mrg &lt;- merge(nlme.coef,allP[allP$year&gt;=2017,],by = "uid")</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # add log-transformed versions</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Dmlr$kPS_log &lt;- log(Dmlr$kPS)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dmlr$PS_log &lt;- log(Dmlr$PS)</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dmlr$soil_0_20_P_AAE10_log &lt;- log(Dmlr$soil_0_20_P_AAE10)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Dmlr$soil_0_20_P_CO2_log &lt;- log(Dmlr$soil_0_20_P_CO2)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dmlr$k</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(Dmlr, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Ymain_rel"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS, Weather_vars))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Ymain_rel soil_0_20_P_AAE10_log soil_0_20_P_CO2_log     PS_log          k
1      178.42                    NA                  NA -2.7715938 0.10467464
2          NA             3.0773123        -1.386294361 -2.7715938 0.10467464
3      179.72                    NA                  NA -3.0042091 0.12262173
4          NA             2.9069011        -1.771956842 -3.0042091 0.12262173
5      190.64                    NA                  NA -2.7693913 0.10448023
6          NA             2.9601051        -1.469675970 -2.7693913 0.10448023
7      178.51                    NA                  NA -2.9077724 0.11568444
8          NA             2.9069011        -1.514127733 -2.9077724 0.11568444
9      210.05                    NA                  NA -2.3473051 0.12628437
10         NA             3.9815491        -0.843970070 -2.3473051 0.12628437
11     209.45                    NA                  NA -2.1364490 0.11502207
12         NA             3.7954892        -0.941608540 -2.1364490 0.11502207
13         NA             3.5973123        -0.941608540 -2.6235787 0.09040112
14     215.86                    NA                  NA -2.6235787 0.09040112
15     218.63                    NA                  NA -2.6642037 0.08666599
16         NA             3.5890591        -1.171182982 -2.6642037 0.08666599
17     219.32                    NA                  NA -1.3169035 0.08586286
18         NA             4.4485164        -0.105360516 -1.3169035 0.08586286
19     234.23                    NA                  NA -1.5753641 0.08620806
20         NA             4.2541933        -0.527632742 -1.5753641 0.08620806
21         NA             3.9926809        -0.562118918 -1.7576162 0.08640235
22     232.41                    NA                  NA -1.7576162 0.08640235
23     238.82                    NA                  NA -1.5768721 0.08620766
24         NA             4.4578296        -0.248461359 -1.5768721 0.08620766
25      65.60             1.8870696        -1.469675970 -2.9145147 0.20191085
26      72.33             2.1162555        -1.237874356 -2.9145147 0.20191085
27      84.81             2.3321439        -1.272965676 -2.9145147 0.20191085
28         NA             2.2300144        -1.469675970 -2.9145147 0.20191085
29         NA             2.4069451        -1.171182982 -2.9145147 0.20191085
30         NA             2.3321439        -1.272965676 -2.9145147 0.20191085
31      92.91             2.3887628        -1.237874356 -2.9145147 0.20191085
32     189.25                    NA                  NA -2.9145147 0.20191085
33         NA             2.1972246        -1.078809661 -2.9145147 0.20191085
34      69.17             1.8245493        -1.347073648 -2.6264148 0.23310593
35     167.07                    NA                  NA -2.6264148 0.23310593
36         NA             2.3795461        -1.108662625 -2.6264148 0.23310593
37     106.32             2.4849066        -1.171182982 -2.6264148 0.23310593
38      82.00             2.3223877        -1.021651248 -2.6264148 0.23310593
39         NA             2.3418058        -1.108662625 -2.6264148 0.23310593
40      84.97             2.3418058        -1.108662625 -2.6264148 0.23310593
41         NA             2.1400662        -1.386294361 -2.6264148 0.23310593
42         NA             2.2925348        -0.941608540 -2.6264148 0.23310593
43      74.25             0.8329091        -1.832581464 -3.3408312 0.15014993
44      89.08             1.9878743        -1.514127733 -3.3408312 0.15014993
45         NA             1.7047481        -1.660731207 -3.3408312 0.15014993
46         NA             2.9069011        -1.237874356 -3.3408312 0.15014993
47      81.01             1.7047481        -1.660731207 -3.3408312 0.15014993
48         NA             1.1939225        -2.207274913 -3.3408312 0.15014993
49         NA             1.7917595        -1.609437912 -3.3408312 0.15014993
50     194.54                    NA                  NA -3.3408312 0.15014993
51      66.00             1.6292405        -1.272965676 -3.3408312 0.15014993
52         NA             1.7749524        -1.469675970 -3.8896385 0.13492618
53      79.31             2.6461748        -1.237874356 -3.8896385 0.13492618
54         NA             1.4586150        -2.207274913 -3.8896385 0.13492618
55     149.91                    NA                  NA -3.8896385 0.13492618
56      92.33             1.9878743        -1.237874356 -3.8896385 0.13492618
57         NA             2.1282317        -1.469675970 -3.8896385 0.13492618
58         NA             2.1162555        -1.386294361 -3.8896385 0.13492618
59      74.44             1.8870696        -1.347073648 -3.8896385 0.13492618
60      80.85             2.1162555        -1.386294361 -3.8896385 0.13492618
61      91.33             3.1441523        -0.248461359 -1.4927360 0.11739091
62         NA             3.4111477        -0.198450939 -1.4927360 0.11739091
63         NA             3.2425924        -0.314710745 -1.4927360 0.11739091
64     203.81                    NA                  NA -1.4927360 0.11739091
65      91.61             3.1863526        -0.198450939 -1.4927360 0.11739091
66     109.20             3.4045252        -0.314710745 -1.4927360 0.11739091
67         NA             3.1945831        -0.198450939 -1.4927360 0.11739091
68         NA             3.1863526        -0.198450939 -1.4927360 0.11739091
69      63.16             3.1045867        -0.385662481 -1.4927360 0.11739091
70     198.18                    NA                  NA -2.1350669 0.17309044
71         NA             2.7850112        -0.673344553 -2.1350669 0.17309044
72         NA             2.7972813        -0.843970070 -2.1350669 0.17309044
73         NA             2.9014216        -0.356674944 -2.1350669 0.17309044
74      68.61             2.8449094        -0.634878272 -2.1350669 0.17309044
75      73.44             2.8094027        -0.733969175 -2.1350669 0.17309044
76      78.32             2.7850112        -0.673344553 -2.1350669 0.17309044
77     101.92             3.2580965        -0.510825624 -2.1350669 0.17309044
78         NA             3.0007198        -0.562118918 -2.1350669 0.17309044
79      80.26             2.4069451        -1.171182982 -2.2181329 0.17801699
80      95.57             2.6026897        -0.941608540 -2.2181329 0.17801699
81         NA             2.8033604        -0.843970070 -2.2181329 0.17801699
82         NA             2.6026897        -0.941608540 -2.2181329 0.17801699
83         NA             2.5726122        -1.237874356 -2.2181329 0.17801699
84      72.56             2.7663191        -2.525728644 -2.2181329 0.17801699
85         NA             2.7343675        -0.673344553 -2.2181329 0.17801699
86     190.38                    NA                  NA -2.2181329 0.17801699
87     107.85             2.9069011        -0.867500568 -2.2181329 0.17801699
88         NA             2.8903718        -0.867500568 -2.2067423 0.17736688
89     204.59                    NA                  NA -2.2067423 0.17736688
90      52.11             3.0587071        -0.579818495 -2.2067423 0.17736688
91         NA             2.9069011        -0.733969175 -2.2067423 0.17736688
92      93.51             2.9069011        -0.733969175 -2.2067423 0.17736688
93      72.61             3.1045867        -0.916290732 -2.2067423 0.17736688
94         NA             2.8390785        -0.941608540 -2.2067423 0.17736688
95      69.74             2.6741486        -0.941608540 -2.2067423 0.17736688
96         NA             3.3809947        -0.385662481 -2.2067423 0.17736688
97      62.97             4.2017031         0.765467842 -0.9083699 0.23219455
98      90.42             4.3907386         0.636576829 -0.9083699 0.23219455
99         NA             4.3000028         0.652325186 -0.9083699 0.23219455
100     90.11             4.0412953         0.239016900 -0.9083699 0.23219455
101    222.79                    NA                  NA -0.9083699 0.23219455
102        NA             4.1697612         0.604315967 -0.9083699 0.23219455
103     94.15             4.0656021         0.494696242 -0.9083699 0.23219455
104        NA             4.2640873         0.559615788 -0.9083699 0.23219455
105        NA             4.0656021         0.494696242 -0.9083699 0.23219455
106        NA             3.1822118        -0.198450939 -1.6359640 0.15615814
107     97.94             2.6461748        -0.733969175 -1.6359640 0.15615814
108    104.41             3.3809947        -0.342490309 -1.6359640 0.15615814
109     81.58             3.0540012        -0.510825624 -1.6359640 0.15615814
110    204.59                    NA                  NA -1.6359640 0.15615814
111        NA             3.0726933        -0.634878272 -1.6359640 0.15615814
112     85.44             3.0955776        -1.171182982 -1.6359640 0.15615814
113        NA             2.6461748        -0.733969175 -1.6359640 0.15615814
114        NA             3.0056826        -0.478035801 -1.6359640 0.15615814
115    195.84                    NA                  NA -1.3788326 0.17699689
116     76.88             3.4873751        -0.105360516 -1.3788326 0.17699689
117        NA             3.5945688         0.231111721 -1.3788326 0.17699689
118     83.33             3.7424202        -0.105360516 -1.3788326 0.17699689
119        NA             3.8044378         0.165514438 -1.3788326 0.17699689
120     87.03             3.5945688         0.231111721 -1.3788326 0.17699689
121     47.89             3.4531571        -0.051293294 -1.3788326 0.17699689
122        NA             4.0412953         0.425267735 -1.3788326 0.17699689
123        NA             3.6480575         0.048790164 -1.3788326 0.17699689
124    125.95             2.7013612        -1.272965676 -3.3238864 0.22062441
125     66.48             2.7472709        -1.514127733 -3.3238864 0.22062441
126     83.27             2.8507065        -0.994252273 -3.3238864 0.22062441
127        NA             2.7472709        -1.272965676 -3.3238864 0.22062441
128    139.69                    NA                  NA -3.3238864 0.22062441
129        NA             2.6100698        -1.771956842 -3.3238864 0.22062441
130        NA             2.4069451        -1.609437912 -3.3238864 0.22062441
131    132.89             2.6390573        -1.171182982 -3.3238864 0.22062441
132        NA             2.7013612        -1.272965676 -3.3238864 0.22062441
133        NA             3.1223649        -1.108662625 -3.2178905 0.18943117
134     75.56             2.8622009        -1.237874356 -3.2178905 0.18943117
135    140.99                    NA                  NA -3.2178905 0.18943117
136        NA             2.9123507        -1.966112856 -3.2178905 0.18943117
137    117.88             3.1223649        -1.108662625 -3.2178905 0.18943117
138        NA             2.8507065        -1.347073648 -3.2178905 0.18943117
139     65.52             3.0106209        -1.386294361 -3.2178905 0.18943117
140     91.54             3.0492730        -1.078809661 -3.2178905 0.18943117
141        NA             2.1860513        -1.386294361 -3.2178905 0.18943117
142        NA             2.9391619        -1.237874356 -3.6548744 0.28439752
143     65.33             2.9014216        -1.609437912 -3.6548744 0.28439752
144        NA             2.9652731        -1.469675970 -3.6548744 0.28439752
145    133.86             2.9391619        -1.237874356 -3.6548744 0.28439752
146        NA             2.8903718        -2.120263536 -3.6548744 0.28439752
147     77.26             3.1570004        -1.108662625 -3.6548744 0.28439752
148    132.58                    NA                  NA -3.6548744 0.28439752
149        NA             3.1045867        -1.347073648 -3.6548744 0.28439752
150     93.11             3.1570004        -0.941608540 -3.6548744 0.28439752
151     89.10             2.7972813        -1.272965676 -3.3755708 0.21679430
152        NA             2.4336134        -2.407945609 -3.3755708 0.21679430
153     86.78             2.8033604        -1.609437912 -3.3755708 0.21679430
154        NA             2.7146947        -1.386294361 -3.3755708 0.21679430
155        NA             2.3608540        -1.514127733 -3.3755708 0.21679430
156     54.11             2.2407097        -1.237874356 -3.3755708 0.21679430
157    126.90             2.7146947        -1.386294361 -3.3755708 0.21679430
158        NA             2.3702437        -1.237874356 -3.3755708 0.21679430
159    117.94                    NA                  NA -3.3755708 0.21679430
160        NA             3.4468079        -0.916290732 -2.3555262 0.34791259
161        NA             3.2580965        -0.994252273 -2.3555262 0.34791259
162    135.70                    NA                  NA -2.3555262 0.34791259
163    109.78             3.4011974        -0.693147181 -2.3555262 0.34791259
164     87.36             3.3534067        -1.078809661 -2.3555262 0.34791259
165        NA             3.3141860        -0.733969175 -2.3555262 0.34791259
166        NA             3.0056826        -0.916290732 -2.3555262 0.34791259
167     90.60             3.5055574        -0.693147181 -2.3555262 0.34791259
168    145.89             3.2580965        -0.994252273 -2.3555262 0.34791259
169        NA             3.1986731        -0.867500568 -2.4402754 0.30702495
170     92.78             3.5025499        -0.673344553 -2.4402754 0.30702495
171    139.72             3.3741687        -0.798507696 -2.4402754 0.30702495
172        NA             3.4812401        -1.108662625 -2.4402754 0.30702495
173    151.13                    NA                  NA -2.4402754 0.30702495
174     79.12             3.3741687        -1.108662625 -2.4402754 0.30702495
175        NA             3.3741687        -0.798507696 -2.4402754 0.30702495
176     94.92             3.4750672        -0.579818495 -2.4402754 0.30702495
177        NA             3.3393220        -0.941608540 -2.4402754 0.30702495
178    153.12                    NA                  NA -2.5704141 0.25060055
179     87.56             3.6163088        -0.693147181 -2.5704141 0.25060055
180        NA             3.4719665        -0.798507696 -2.5704141 0.25060055
181     92.11             3.6988298        -0.634878272 -2.5704141 0.25060055
182        NA             3.6788291        -1.108662625 -2.5704141 0.25060055
183        NA             3.4242627        -0.867500568 -2.5704141 0.25060055
184    138.29             3.5496174        -0.733969175 -2.5704141 0.25060055
185        NA             3.5496174        -0.733969175 -2.5704141 0.25060055
186     77.97             3.2542430        -1.272965676 -2.5704141 0.25060055
187    125.74                    NA                  NA -2.8188200 0.16133292
188        NA             2.7343675        -0.941608540 -2.8188200 0.16133292
189     96.55             3.1223649        -1.171182982 -2.8188200 0.16133292
190    137.97             2.8390785        -1.108662625 -2.8188200 0.16133292
191     90.00             2.8033604        -0.843970070 -2.8188200 0.16133292
192        NA             2.7343675        -1.078809661 -2.8188200 0.16133292
193        NA             2.8390785        -1.108662625 -2.8188200 0.16133292
194     96.80             3.1267605        -0.798507696 -2.8188200 0.16133292
195        NA             2.7972813        -1.771956842 -2.8188200 0.16133292
196        NA             3.2771447        -0.510825624 -2.0165660 0.29038401
197        NA             3.5973123        -0.385662481 -2.0165660 0.29038401
198    148.44                    NA                  NA -2.0165660 0.29038401
199        NA             3.5751507        -0.510825624 -2.0165660 0.29038401
200        NA             3.5695327        -0.478035801 -2.0165660 0.29038401
201    134.81             3.5695327        -0.478035801 -2.0165660 0.29038401
202     88.53             3.8712010        -0.430782916 -2.0165660 0.29038401
203     84.67             3.1441523        -0.776528789 -2.0165660 0.29038401
204     58.00             3.6163088        -0.400477567 -2.0165660 0.29038401
205    117.78             4.0741419        -0.094310679 -1.8173600 0.22557569
206     92.53             3.7352858        -0.733969175 -1.8173600 0.22557569
207        NA             3.8329798        -0.579818495 -1.8173600 0.22557569
208     97.18             3.9039908        -0.385662481 -1.8173600 0.22557569
209        NA             3.6584202        -0.478035801 -1.8173600 0.22557569
210    132.12             3.6635616        -0.527632742 -1.8173600 0.22557569
211        NA             3.6635616        -0.527632742 -1.8173600 0.22557569
212        NA             3.7376696        -0.430782916 -1.8173600 0.22557569
213    140.29                    NA                  NA -1.8173600 0.22557569
214     91.44             3.8133070        -0.274436846 -1.6506135 0.13768829
215    137.66             3.6963515        -0.478035801 -1.6506135 0.13768829
216        NA             3.6963515        -0.478035801 -1.6506135 0.13768829
217        NA             3.7954892        -0.446287103 -1.6506135 0.13768829
218        NA             3.5890591        -0.400477567 -1.6506135 0.13768829
219    123.83                    NA                  NA -1.6506135 0.13768829
220     90.98             3.9512437        -0.162518929 -1.6506135 0.13768829
221     98.28             3.9160150        -0.446287103 -1.6506135 0.13768829
222        NA             3.7773481        -0.314710745 -1.6506135 0.13768829
223    119.84                    NA                  NA -1.7109028 0.06500092
224     92.34             3.6737658        -0.693147181 -1.7109028 0.06500092
225     94.74             3.8372995        -0.510825624 -1.7109028 0.06500092
226    108.89             3.7447871        -0.356674944 -1.7109028 0.06500092
227        NA             3.6813512        -0.162518929 -1.7109028 0.06500092
228        NA             3.6838669        -0.579818495 -1.7109028 0.06500092
229        NA             3.4307562        -0.693147181 -1.7109028 0.06500092
230        NA             3.7954892        -0.673344553 -1.7109028 0.06500092
231    132.91             3.6838669        -0.579818495 -1.7109028 0.06500092
232        NA             2.9338569        -0.941608540 -3.0602039 0.22808615
233     98.67             2.4765384        -1.272965676 -3.0602039 0.22808615
234     98.64             2.7911651        -1.021651248 -3.0602039 0.22808615
235        NA             2.7725887        -0.941608540 -3.0602039 0.22808615
236    108.37             2.6741486        -1.108662625 -3.0602039 0.22808615
237     90.23             2.9338569        -0.941608540 -3.0602039 0.22808615
238        NA             2.7725887        -1.108662625 -3.0602039 0.22808615
239     94.74             2.5649494        -1.469675970 -3.0602039 0.22808615
240    123.40                    NA                  NA -3.0602039 0.22808615
241        NA             2.6741486        -1.108662625 -3.0602039 0.22808615
242        NA             2.6672282        -1.021651248 -2.9064446 0.20616803
243     81.61             2.9123507        -1.078809661 -2.9064446 0.20616803
244    115.94             2.6878475        -1.108662625 -2.9064446 0.20616803
245        NA             2.7013612        -1.237874356 -2.9064446 0.20616803
246     83.91             2.9704145        -1.078809661 -2.9064446 0.20616803
247    156.85                    NA                  NA -2.9064446 0.20616803
248        NA             2.6878475        -1.108662625 -2.9064446 0.20616803
249     89.10             2.6390573        -1.469675970 -2.9064446 0.20616803
250        NA             2.9123507        -1.078809661 -2.9064446 0.20616803
251     82.03             2.7600099        -1.237874356 -2.9064446 0.20616803
252    104.22             2.8213789        -1.078809661 -2.6081966 0.15273297
253        NA             3.0540012        -0.673344553 -2.6081966 0.15273297
254        NA             2.8903718        -1.108662625 -2.6081966 0.15273297
255        NA             3.2228678        -0.941608540 -2.6081966 0.15273297
256     83.28             3.0252911        -0.916290732 -2.6081966 0.15273297
257    152.86                    NA                  NA -2.6081966 0.15273297
258     93.87             3.2228678        -0.941608540 -2.6081966 0.15273297
259     92.86             3.2695689        -1.347073648 -2.6081966 0.15273297
260        NA             3.0106209        -1.078809661 -2.6081966 0.15273297
261    113.04             3.0106209        -1.078809661 -2.6081966 0.15273297
262        NA             2.7911651        -1.237874356 -2.5903371 0.14899842
263    164.73                    NA                  NA -2.5903371 0.14899842
264        NA             2.4510051        -1.171182982 -2.5903371 0.14899842
265        NA             2.4423470        -0.127833372 -2.5903371 0.14899842
266     96.24             2.2823824        -1.514127733 -2.5903371 0.14899842
267    104.70             2.5416020        -1.237874356 -2.5903371 0.14899842
268     97.49             2.6461748        -1.021651248 -2.5903371 0.14899842
269        NA             2.2823824        -1.078809661 -2.5903371 0.14899842
270     91.95             2.7911651        -1.237874356 -2.5903371 0.14899842
271    110.14             2.4510051        -1.171182982 -2.5903371 0.14899842
272    100.00             3.5174978        -0.527632742 -2.0944336 0.19984180
273     98.85             3.6609943        -0.400477567 -2.0944336 0.19984180
274     92.15             3.9019727        -0.174353387 -2.0944336 0.19984180
275     86.47             3.4843123        -0.562118918 -2.0944336 0.19984180
276    133.02                    NA                  NA -2.0944336 0.19984180
277        NA             3.4078419        -0.446287103 -2.0944336 0.19984180
278        NA             3.4372078        -0.342490309 -2.0944336 0.19984180
279        NA             3.9019727        -0.174353387 -2.0944336 0.19984180
280        NA             3.6323091        -0.162518929 -2.0944336 0.19984180
281    107.57             3.4078419        -0.446287103 -2.0944336 0.19984180
282        NA             3.4499875        -0.385662481 -1.6439616 0.10705720
283        NA             3.6813512        -0.301105093 -1.6439616 0.10705720
284        NA             3.3741687        -0.248461359 -1.6439616 0.10705720
285     96.38             3.2733640        -0.400477567 -1.6439616 0.10705720
286     94.92             3.3286267        -0.400477567 -1.6439616 0.10705720
287    134.75                    NA                  NA -1.6439616 0.10705720
288        NA             3.3877744        -0.105360516 -1.6439616 0.10705720
289     92.53             3.6813512        -0.301105093 -1.6439616 0.10705720
290    140.42             3.3741687        -0.248461359 -1.6439616 0.10705720
291    100.00             3.4307562        -0.198450939 -1.6439616 0.10705720
292        NA             4.1541846        -0.127833372 -2.1715576 0.21193823
293        NA             3.5263605        -0.385662481 -2.1715576 0.21193823
294    113.27             3.5467397        -0.430782916 -2.1715576 0.21193823
295    160.75                    NA                  NA -2.1715576 0.21193823
296     95.02             4.1541846        -0.127833372 -2.1715576 0.21193823
297        NA             3.8649314        -0.020202707 -2.1715576 0.21193823
298     97.18             3.4339872        -0.673344553 -2.1715576 0.21193823
299        NA             3.6296601        -0.430782916 -2.1715576 0.21193823
300    126.25             3.5263605        -0.385662481 -2.1715576 0.21193823
301     96.34             3.8372995        -0.139262067 -2.1715576 0.21193823
302     99.28             3.0955776        -0.733969175 -2.0030331 0.18423357
303        NA             3.2386785        -0.634878272 -2.0030331 0.18423357
304    104.28             3.4594663        -0.430782916 -2.0030331 0.18423357
305    119.16             3.2386785        -0.634878272 -2.0030331 0.18423357
306        NA             3.3178158        -0.673344553 -2.0030331 0.18423357
307        NA             3.4339872        -0.094310679 -2.0030331 0.18423357
308    102.07             3.1484534        -0.673344553 -2.0030331 0.18423357
309        NA             3.6712245        -0.478035801 -2.0030331 0.18423357
310     94.25             3.6712245        -0.478035801 -2.0030331 0.18423357
311    158.67                    NA                  NA -2.0030331 0.18423357
312        NA             3.7062281        -0.210721031 -1.5511331 0.13120470
313        NA             3.6349511         0.019802627 -1.5511331 0.13120470
314    100.75             3.6428355        -0.162518929 -1.5511331 0.13120470
315     96.66             3.7977339         0.039220713 -1.5511331 0.13120470
316     93.30             4.2766661         0.357674444 -1.5511331 0.13120470
317    161.09                    NA                  NA -1.5511331 0.13120470
318    130.60             3.6349511         0.019802627 -1.5511331 0.13120470
319    108.69             3.7424202        -0.040821995 -1.5511331 0.13120470
320        NA             4.2766661         0.357674444 -1.5511331 0.13120470
321        NA             3.8607297         0.343589704 -1.5511331 0.13120470
322        NA             3.6712245         0.122217633 -1.2221855 0.10473925
323    157.02                    NA                  NA -1.2221855 0.10473925
324        NA             3.4339872        -0.162518929 -1.2221855 0.10473925
325     99.69             3.7208625         0.048790164 -1.2221855 0.10473925
326        NA             3.7352858         0.277631737 -1.2221855 0.10473925
327     85.16             3.6323091         0.076961041 -1.2221855 0.10473925
328     97.51             3.9569964        -0.040821995 -1.2221855 0.10473925
329    111.65             3.5174978        -0.094310679 -1.2221855 0.10473925
330    128.34             3.4339872        -0.162518929 -1.2221855 0.10473925
331        NA             3.9569964        -0.040821995 -1.2221855 0.10473925
332        NA             3.4688560        -0.235722334 -1.2647377 0.13141530
333        NA             4.1125119         0.148420005 -1.2647377 0.13141530
334     93.42             3.5204608        -0.385662481 -1.2647377 0.13141530
335        NA             3.6661225         0.009950331 -1.2647377 0.13141530
336     88.06             3.6082116        -0.235722334 -1.2647377 0.13141530
337        NA             3.7887248        -0.040821995 -1.2647377 0.13141530
338    130.43             3.4688560        -0.235722334 -1.2647377 0.13141530
339     94.44             4.1125119         0.148420005 -1.2647377 0.13141530
340    169.15                    NA                  NA -1.2647377 0.13141530
341    106.17             3.6270041        -0.210721031 -1.2647377 0.13141530
342        NA             4.0758411         0.239016900 -1.2757306 0.21076772
343    106.02             4.0621657        -0.051293294 -1.2757306 0.21076772
344        NA             4.1447208        -0.198450939 -1.2757306 0.21076772
345    158.15                    NA                  NA -1.2757306 0.21076772
346    133.49             3.9627161        -0.105360516 -1.2757306 0.21076772
347    100.42             3.9926809        -0.105360516 -1.2757306 0.21076772
348        NA             3.9627161        -0.105360516 -1.2757306 0.21076772
349     94.25             4.1447208        -0.198450939 -1.2757306 0.21076772
350        NA             4.2556127         0.300104592 -1.2757306 0.21076772
351     96.86             4.0360090         0.076961041 -1.2757306 0.21076772
352     91.63             2.9856819        -1.272965676 -3.8181685 0.18211399
353     86.01             2.5095993        -1.660731207 -3.8181685 0.18211399
354     69.73             3.0301337        -1.272965676 -3.8181685 0.18211399
355    164.56                    NA                  NA -3.8181685 0.18211399
356        NA             3.0301337        -1.272965676 -3.8181685 0.18211399
357        NA             2.7013612        -1.660731207 -3.8181685 0.18211399
358    104.08             2.7212954        -1.237874356 -3.8181685 0.18211399
359        NA             2.8094027        -1.272965676 -3.8181685 0.18211399
360     80.08             2.6810215        -1.771956842 -3.8181685 0.18211399
361        NA             2.9856819        -1.272965676 -3.8181685 0.18211399
362     67.05             2.9177707        -1.609437912 -3.7414147 0.22288952
363        NA             2.7408400        -1.609437912 -3.7414147 0.22288952
364    153.73                    NA                  NA -3.7414147 0.22288952
365     81.18             2.8213789        -1.832581464 -3.7414147 0.22288952
366        NA             2.9177707        -1.609437912 -3.7414147 0.22288952
367     61.28             3.0155349        -1.771956842 -3.7414147 0.22288952
368        NA             2.9549103        -1.609437912 -3.7414147 0.22288952
369        NA             2.5572273        -1.832581464 -3.7414147 0.22288952
370     66.34             2.9549103        -1.609437912 -3.7414147 0.22288952
371     94.25             2.9014216        -1.469675970 -3.7414147 0.22288952
372     75.10             3.5263605        -1.108662625 -3.8931747 0.14517478
373    166.64                    NA                  NA -3.8931747 0.14517478
374        NA             3.6136170        -0.693147181 -3.8931747 0.14517478
375        NA             3.4563167        -1.108662625 -3.8931747 0.14517478
376        NA             3.2958369        -1.660731207 -3.8931747 0.14517478
377    129.31             3.4563167        -1.108662625 -3.8931747 0.14517478
378    110.97             3.6216707        -0.867500568 -3.8931747 0.14517478
379     94.92             3.5234150        -1.347073648 -3.8931747 0.14517478
380        NA             3.5263605        -1.108662625 -3.8931747 0.14517478
381     98.91             3.3286267        -1.469675970 -3.8931747 0.14517478
382     88.90             2.9014216        -1.469675970 -3.6735278 0.26166020
383        NA             2.9391619        -1.386294361 -3.6735278 0.26166020
384        NA             2.7663191        -1.469675970 -3.6735278 0.26166020
385     65.52             2.9391619        -1.386294361 -3.6735278 0.26166020
386        NA             2.6246686        -1.966112856 -3.6735278 0.26166020
387     64.66             2.8390785        -1.832581464 -3.6735278 0.26166020
388        NA             2.5014360        -1.771956842 -3.6735278 0.26166020
389     75.85             2.7663191        -1.469675970 -3.6735278 0.26166020
390    165.68                    NA                  NA -3.6735278 0.26166020
391     71.26             3.1696856        -1.272965676 -3.6735278 0.26166020
392     86.78             4.1383614         0.067658648 -2.0697768 0.21782370
393    153.64                    NA                  NA -2.0697768 0.21782370
394    106.63             3.8501476        -0.478035801 -2.0697768 0.21782370
395        NA             4.1141472         0.009950331 -2.0697768 0.21782370
396        NA             4.0342406         0.190620360 -2.0697768 0.21782370
397    135.27             4.1141472         0.009950331 -2.0697768 0.21782370
398        NA             4.1383614         0.067658648 -2.0697768 0.21782370
399        NA             3.9759363        -0.446287103 -2.0697768 0.21782370
400    100.10             3.9239516        -0.072570693 -2.0697768 0.21782370
401    114.85             4.2253728        -0.235722334 -2.0697768 0.21782370
402    105.43             3.9180051        -0.478035801 -2.3967665 0.21384349
403    162.91                    NA                  NA -2.3967665 0.21384349
404        NA             3.8351420        -0.693147181 -2.3967665 0.21384349
405     97.89             4.2061840         0.173953307 -2.3967665 0.21384349
406     99.69             3.9796817        -0.235722334 -2.3967665 0.21384349
407    109.77             3.9376908        -0.579818495 -2.3967665 0.21384349
408        NA             3.8774316        -0.072570693 -2.3967665 0.21384349
409        NA             4.2061840         0.173953307 -2.3967665 0.21384349
410    145.25             3.9852735        -0.301105093 -2.3967665 0.21384349
411        NA             3.9852735        -0.301105093 -2.3967665 0.21384349
412     88.12             3.6686767        -0.634878272 -2.6575735 0.21147919
413    129.95             3.5723456        -0.798507696 -2.6575735 0.21147919
414        NA             3.6686767        -0.634878272 -2.6575735 0.21147919
415     97.83             3.2228678        -1.272965676 -2.6575735 0.21147919
416        NA             3.5695327        -1.171182982 -2.6575735 0.21147919
417    108.05             3.3568971        -0.733969175 -2.6575735 0.21147919
418        NA             3.2347492        -0.994252273 -2.6575735 0.21147919
419    168.54                    NA                  NA -2.6575735 0.21147919
420    108.65             3.5582011        -0.994252273 -2.6575735 0.21147919
421        NA             3.5723456        -0.798507696 -2.6575735 0.21147919
422        NA             3.7037681        -0.385662481 -2.6521244 0.21152273
423        NA             4.2106450         0.418710335 -2.6521244 0.21152273
424        NA             3.6054978        -0.634878272 -2.6521244 0.21152273
425    117.23             3.8066625        -0.356674944 -2.6521244 0.21152273
426    110.24             3.8416005        -0.356674944 -2.6521244 0.21152273
427    102.63             3.7013020        -0.634878272 -2.6521244 0.21152273
428        NA             3.8066625        -0.356674944 -2.6521244 0.21152273
429     81.61             4.2106450         0.418710335 -2.6521244 0.21152273
430    168.54                    NA                  NA -2.6521244 0.21152273
431    109.17             3.5582011        -0.579818495 -2.6521244 0.21152273
432        NA             4.3832759         0.190620360 -1.4624073 0.18550740
433     89.46             4.6288867         0.703097511 -1.4624073 0.18550740
434        NA             4.3502779        -0.094310679 -1.4624073 0.18550740
435    113.99             4.2499228        -0.174353387 -1.4624073 0.18550740
436     98.22             4.3956830         0.438254931 -1.4624073 0.18550740
437    131.88             4.3832759         0.190620360 -1.4624073 0.18550740
438        NA             4.3254563         0.262364264 -1.4624073 0.18550740
439    166.55                    NA                  NA -1.4624073 0.18550740
440        NA             4.6288867         0.703097511 -1.4624073 0.18550740
441    106.02             4.3385971         0.076961041 -1.4624073 0.18550740
442        NA             4.3770141         0.683096845 -1.2422076 0.13496530
443     99.62             4.5358201         0.900161350 -1.2422076 0.13496530
444    111.18             4.3081110         0.488580015 -1.2422076 0.13496530
445    103.50             4.2282925         0.067658648 -1.2422076 0.13496530
446    177.90                    NA                  NA -1.2422076 0.13496530
447        NA             4.3515674         0.451075619 -1.2422076 0.13496530
448    143.00             4.3515674         0.451075619 -1.2422076 0.13496530
449        NA             4.5358201         0.900161350 -1.2422076 0.13496530
450    113.35             4.5174313         0.678033543 -1.2422076 0.13496530
451        NA             4.4601444         0.357674444 -1.2422076 0.13496530
452        NA             4.2668963         0.165514438 -1.5757798 0.20749743
453    134.86             4.1972019        -0.105360516 -1.5757798 0.20749743
454        NA             4.2456340         0.254642218 -1.5757798 0.20749743
455        NA             4.3294167         0.703097511 -1.5757798 0.20749743
456     89.85             4.3993753         0.963174318 -1.5757798 0.20749743
457        NA             4.3993753         0.963174318 -1.5757798 0.20749743
458    132.21             4.2456340         0.254642218 -1.5757798 0.20749743
459    114.85             4.2668963         0.113328685 -1.5757798 0.20749743
460    163.00                    NA                  NA -1.5757798 0.20749743
461     92.89             4.1287460         0.076961041 -1.5757798 0.20749743
462    125.60             3.9702919         0.425267735 -2.1617951 0.28873132
463        NA             3.7376696        -0.274436846 -2.1617951 0.28873132
464        NA             3.9702919         0.425267735 -2.1617951 0.28873132
465    110.14             4.0758411         0.717839793 -2.1617951 0.28873132
466    128.47             3.9039908         0.398776120 -2.1617951 0.28873132
467    107.89             4.0656021         0.536493371 -2.1617951 0.28873132
468        NA             4.1972019         0.457424847 -2.1617951 0.28873132
469    177.56                    NA                  NA -2.1617951 0.28873132
470        NA             3.9473901         0.542324291 -2.1617951 0.28873132
471     81.03             4.1972019         0.457424847 -2.1617951 0.28873132
      kPS_log anavg_temp ansum_prec juvdev_prec juvdev_sun ansum_sun
1   -5.028492       13.3     1784.4       -0.22      -0.02    2195.9
2   -5.028492         NA         NA          NA         NA        NA
3   -5.102860       13.3     1784.4       -0.22      -0.02    2195.9
4   -5.102860         NA         NA          NA         NA        NA
5   -5.028149       13.3     1784.4       -0.22      -0.02    2195.9
6   -5.028149         NA         NA          NA         NA        NA
7   -5.064662       13.3     1784.4       -0.22      -0.02    2195.9
8   -5.064662         NA         NA          NA         NA        NA
9   -4.416524       13.3     1784.4       -0.22      -0.02    2195.9
10  -4.416524         NA         NA          NA         NA        NA
11  -4.299080       13.3     1784.4       -0.22      -0.02    2195.9
12  -4.299080         NA         NA          NA         NA        NA
13  -5.027077         NA         NA          NA         NA        NA
14  -5.027077       13.3     1784.4       -0.22      -0.02    2195.9
15  -5.109897       13.3     1784.4       -0.22      -0.02    2195.9
16  -5.109897         NA         NA          NA         NA        NA
17  -3.771907       13.3     1784.4       -0.22      -0.02    2195.9
18  -3.771907         NA         NA          NA         NA        NA
19  -4.026356       13.3     1784.4       -0.22      -0.02    2195.9
20  -4.026356         NA         NA          NA         NA        NA
21  -4.206357         NA         NA          NA         NA        NA
22  -4.206357       13.3     1784.4       -0.22      -0.02    2195.9
23  -4.027868       13.3     1784.4       -0.22      -0.02    2195.9
24  -4.027868         NA         NA          NA         NA        NA
25  -4.514444       11.3      725.8       -0.38       0.42    2019.7
26  -4.514444       10.1     1035.6        0.23       0.22    1960.0
27  -4.514444       10.5      993.9       -0.25       0.44    1862.4
28  -4.514444         NA         NA          NA         NA        NA
29  -4.514444       10.7      870.9       -0.35       0.18    1886.0
30  -4.514444       10.5      993.9       -0.25       0.44    1862.4
31  -4.514444       11.2      752.6       -0.36      -0.02    2105.7
32  -4.514444       11.3     1060.6       -0.26       0.14    1721.4
33  -4.514444        9.5     1029.7        0.23       0.13    1692.1
34  -4.082677       11.3      725.8       -0.38       0.42    2019.7
35  -4.082677       11.3     1060.6       -0.26       0.14    1721.4
36  -4.082677       10.7      870.9       -0.35       0.18    1886.0
37  -4.082677       11.2      752.6       -0.36      -0.02    2105.7
38  -4.082677       10.1     1035.6        0.23       0.22    1960.0
39  -4.082677       10.5      993.9       -0.25       0.44    1862.4
40  -4.082677       10.5      993.9       -0.25       0.44    1862.4
41  -4.082677         NA         NA          NA         NA        NA
42  -4.082677        9.5     1029.7        0.23       0.13    1692.1
43  -5.236952       11.3      725.8       -0.38       0.42    2019.7
44  -5.236952       11.2      752.6       -0.36      -0.02    2105.7
45  -5.236952       10.5      993.9       -0.25       0.44    1862.4
46  -5.236952        9.5     1029.7        0.23       0.13    1692.1
47  -5.236952       10.5      993.9       -0.25       0.44    1862.4
48  -5.236952         NA         NA          NA         NA        NA
49  -5.236952       10.7      870.9       -0.35       0.18    1886.0
50  -5.236952       11.3     1060.6       -0.26       0.14    1721.4
51  -5.236952       10.1     1035.6        0.23       0.22    1960.0
52  -5.892666        9.5     1029.7        0.23       0.13    1692.1
53  -5.892666       11.2      752.6       -0.36      -0.02    2105.7
54  -5.892666         NA         NA          NA         NA        NA
55  -5.892666       11.3     1060.6       -0.26       0.14    1721.4
56  -5.892666       10.1     1035.6        0.23       0.22    1960.0
57  -5.892666       10.7      870.9       -0.35       0.18    1886.0
58  -5.892666       10.5      993.9       -0.25       0.44    1862.4
59  -5.892666       11.3      725.8       -0.38       0.42    2019.7
60  -5.892666       10.5      993.9       -0.25       0.44    1862.4
61  -3.634982       10.1     1035.6        0.23       0.22    1960.0
62  -3.634982       10.7      870.9       -0.35       0.18    1886.0
63  -3.634982         NA         NA          NA         NA        NA
64  -3.634982       11.3     1060.6       -0.26       0.14    1721.4
65  -3.634982       10.5      993.9       -0.25       0.44    1862.4
66  -3.634982       11.2      752.6       -0.36      -0.02    2105.7
67  -3.634982        9.5     1029.7        0.23       0.13    1692.1
68  -3.634982       10.5      993.9       -0.25       0.44    1862.4
69  -3.634982       11.3      725.8       -0.38       0.42    2019.7
70  -3.889008       11.3     1060.6       -0.26       0.14    1721.4
71  -3.889008       10.5      993.9       -0.25       0.44    1862.4
72  -3.889008         NA         NA          NA         NA        NA
73  -3.889008        9.5     1029.7        0.23       0.13    1692.1
74  -3.889008       11.3      725.8       -0.38       0.42    2019.7
75  -3.889008       10.1     1035.6        0.23       0.22    1960.0
76  -3.889008       10.5      993.9       -0.25       0.44    1862.4
77  -3.889008       11.2      752.6       -0.36      -0.02    2105.7
78  -3.889008       10.7      870.9       -0.35       0.18    1886.0
79  -3.944009       11.3      725.8       -0.38       0.42    2019.7
80  -3.944009       10.5      993.9       -0.25       0.44    1862.4
81  -3.944009       10.7      870.9       -0.35       0.18    1886.0
82  -3.944009       10.5      993.9       -0.25       0.44    1862.4
83  -3.944009         NA         NA          NA         NA        NA
84  -3.944009       10.1     1035.6        0.23       0.22    1960.0
85  -3.944009        9.5     1029.7        0.23       0.13    1692.1
86  -3.944009       11.3     1060.6       -0.26       0.14    1721.4
87  -3.944009       11.2      752.6       -0.36      -0.02    2105.7
88  -3.936277         NA         NA          NA         NA        NA
89  -3.936277       11.3     1060.6       -0.26       0.14    1721.4
90  -3.936277       10.1     1035.6        0.23       0.22    1960.0
91  -3.936277       10.5      993.9       -0.25       0.44    1862.4
92  -3.936277       10.5      993.9       -0.25       0.44    1862.4
93  -3.936277       11.2      752.6       -0.36      -0.02    2105.7
94  -3.936277       10.7      870.9       -0.35       0.18    1886.0
95  -3.936277       11.3      725.8       -0.38       0.42    2019.7
96  -3.936277        9.5     1029.7        0.23       0.13    1692.1
97  -2.368550       11.3      725.8       -0.38       0.42    2019.7
98  -2.368550       11.2      752.6       -0.36      -0.02    2105.7
99  -2.368550         NA         NA          NA         NA        NA
100 -2.368550       10.1     1035.6        0.23       0.22    1960.0
101 -2.368550       11.3     1060.6       -0.26       0.14    1721.4
102 -2.368550        9.5     1029.7        0.23       0.13    1692.1
103 -2.368550       10.5      993.9       -0.25       0.44    1862.4
104 -2.368550       10.7      870.9       -0.35       0.18    1886.0
105 -2.368550       10.5      993.9       -0.25       0.44    1862.4
106 -3.492850       10.7      870.9       -0.35       0.18    1886.0
107 -3.492850       10.5      993.9       -0.25       0.44    1862.4
108 -3.492850       11.2      752.6       -0.36      -0.02    2105.7
109 -3.492850       11.3      725.8       -0.38       0.42    2019.7
110 -3.492850       11.3     1060.6       -0.26       0.14    1721.4
111 -3.492850         NA         NA          NA         NA        NA
112 -3.492850       10.1     1035.6        0.23       0.22    1960.0
113 -3.492850       10.5      993.9       -0.25       0.44    1862.4
114 -3.492850        9.5     1029.7        0.23       0.13    1692.1
115 -3.110456       11.3     1060.6       -0.26       0.14    1721.4
116 -3.110456       11.3      725.8       -0.38       0.42    2019.7
117 -3.110456       10.5      993.9       -0.25       0.44    1862.4
118 -3.110456       11.2      752.6       -0.36      -0.02    2105.7
119 -3.110456         NA         NA          NA         NA        NA
120 -3.110456       10.5      993.9       -0.25       0.44    1862.4
121 -3.110456       10.1     1035.6        0.23       0.22    1960.0
122 -3.110456        9.5     1029.7        0.23       0.13    1692.1
123 -3.110456       10.7      870.9       -0.35       0.18    1886.0
124 -4.835180       10.2     1063.5       -0.25       0.28    1758.6
125 -4.835180       10.8     1013.6       -0.45      -0.24    1768.3
126 -4.835180       11.2     1047.7       -0.08       0.50    2022.8
127 -4.835180       10.6      980.7       -0.25       0.35    1890.3
128 -4.835180       11.2     1210.1       -0.35       0.13    1742.3
129 -4.835180         NA         NA          NA         NA        NA
130 -4.835180        9.3     1390.5        0.52       0.07    1589.4
131 -4.835180        9.9     1076.4       -0.10       0.19    1748.2
132 -4.835180       10.2     1063.5       -0.25       0.28    1758.6
133 -4.881620       10.2     1063.5       -0.25       0.28    1758.6
134 -4.881620        9.9     1076.4       -0.10       0.19    1748.2
135 -4.881620       11.2     1210.1       -0.35       0.13    1742.3
136 -4.881620         NA         NA          NA         NA        NA
137 -4.881620       10.2     1063.5       -0.25       0.28    1758.6
138 -4.881620       10.6      980.7       -0.25       0.35    1890.3
139 -4.881620       10.8     1013.6       -0.45      -0.24    1768.3
140 -4.881620       11.2     1047.7       -0.08       0.50    2022.8
141 -4.881620        9.3     1390.5        0.52       0.07    1589.4
142 -4.912257       10.2     1063.5       -0.25       0.28    1758.6
143 -4.912257       10.8     1013.6       -0.45      -0.24    1768.3
144 -4.912257        9.3     1390.5        0.52       0.07    1589.4
145 -4.912257       10.2     1063.5       -0.25       0.28    1758.6
146 -4.912257         NA         NA          NA         NA        NA
147 -4.912257       11.2     1047.7       -0.08       0.50    2022.8
148 -4.912257       11.2     1210.1       -0.35       0.13    1742.3
149 -4.912257       10.6      980.7       -0.25       0.35    1890.3
150 -4.912257        9.9     1076.4       -0.10       0.19    1748.2
151 -4.904377       11.2     1047.7       -0.08       0.50    2022.8
152 -4.904377         NA         NA          NA         NA        NA
153 -4.904377       10.8     1013.6       -0.45      -0.24    1768.3
154 -4.904377       10.2     1063.5       -0.25       0.28    1758.6
155 -4.904377       10.6      980.7       -0.25       0.35    1890.3
156 -4.904377        9.9     1076.4       -0.10       0.19    1748.2
157 -4.904377       10.2     1063.5       -0.25       0.28    1758.6
158 -4.904377        9.3     1390.5        0.52       0.07    1589.4
159 -4.904377       11.2     1210.1       -0.35       0.13    1742.3
160 -3.411330         NA         NA          NA         NA        NA
161 -3.411330       10.2     1063.5       -0.25       0.28    1758.6
162 -3.411330       11.2     1210.1       -0.35       0.13    1742.3
163 -3.411330        9.9     1076.4       -0.10       0.19    1748.2
164 -3.411330       10.8     1013.6       -0.45      -0.24    1768.3
165 -3.411330       10.6      980.7       -0.25       0.35    1890.3
166 -3.411330        9.3     1390.5        0.52       0.07    1589.4
167 -3.411330       11.2     1047.7       -0.08       0.50    2022.8
168 -3.411330       10.2     1063.5       -0.25       0.28    1758.6
169 -3.621102        9.3     1390.5        0.52       0.07    1589.4
170 -3.621102        9.9     1076.4       -0.10       0.19    1748.2
171 -3.621102       10.2     1063.5       -0.25       0.28    1758.6
172 -3.621102         NA         NA          NA         NA        NA
173 -3.621102       11.2     1210.1       -0.35       0.13    1742.3
174 -3.621102       10.8     1013.6       -0.45      -0.24    1768.3
175 -3.621102       10.2     1063.5       -0.25       0.28    1758.6
176 -3.621102       11.2     1047.7       -0.08       0.50    2022.8
177 -3.621102       10.6      980.7       -0.25       0.35    1890.3
178 -3.954309       11.2     1210.1       -0.35       0.13    1742.3
179 -3.954309        9.9     1076.4       -0.10       0.19    1748.2
180 -3.954309        9.3     1390.5        0.52       0.07    1589.4
181 -3.954309       11.2     1047.7       -0.08       0.50    2022.8
182 -3.954309         NA         NA          NA         NA        NA
183 -3.954309       10.6      980.7       -0.25       0.35    1890.3
184 -3.954309       10.2     1063.5       -0.25       0.28    1758.6
185 -3.954309       10.2     1063.5       -0.25       0.28    1758.6
186 -3.954309       10.8     1013.6       -0.45      -0.24    1768.3
187 -4.643105       11.2     1210.1       -0.35       0.13    1742.3
188 -4.643105        9.3     1390.5        0.52       0.07    1589.4
189 -4.643105       10.8     1013.6       -0.45      -0.24    1768.3
190 -4.643105       10.2     1063.5       -0.25       0.28    1758.6
191 -4.643105        9.9     1076.4       -0.10       0.19    1748.2
192 -4.643105       10.6      980.7       -0.25       0.35    1890.3
193 -4.643105       10.2     1063.5       -0.25       0.28    1758.6
194 -4.643105       11.2     1047.7       -0.08       0.50    2022.8
195 -4.643105         NA         NA          NA         NA        NA
196 -3.253117        9.3     1390.5        0.52       0.07    1589.4
197 -3.253117       10.6      980.7       -0.25       0.35    1890.3
198 -3.253117       11.2     1210.1       -0.35       0.13    1742.3
199 -3.253117         NA         NA          NA         NA        NA
200 -3.253117       10.2     1063.5       -0.25       0.28    1758.6
201 -3.253117       10.2     1063.5       -0.25       0.28    1758.6
202 -3.253117       11.2     1047.7       -0.08       0.50    2022.8
203 -3.253117       10.8     1013.6       -0.45      -0.24    1768.3
204 -3.253117        9.9     1076.4       -0.10       0.19    1748.2
205 -3.306459        9.9     1076.4       -0.10       0.19    1748.2
206 -3.306459       10.8     1013.6       -0.45      -0.24    1768.3
207 -3.306459         NA         NA          NA         NA        NA
208 -3.306459       11.2     1047.7       -0.08       0.50    2022.8
209 -3.306459        9.3     1390.5        0.52       0.07    1589.4
210 -3.306459       10.2     1063.5       -0.25       0.28    1758.6
211 -3.306459       10.2     1063.5       -0.25       0.28    1758.6
212 -3.306459       10.6      980.7       -0.25       0.35    1890.3
213 -3.306459       11.2     1210.1       -0.35       0.13    1742.3
214 -3.633376        9.9     1076.4       -0.10       0.19    1748.2
215 -3.633376       10.2     1063.5       -0.25       0.28    1758.6
216 -3.633376       10.2     1063.5       -0.25       0.28    1758.6
217 -3.633376         NA         NA          NA         NA        NA
218 -3.633376       10.6      980.7       -0.25       0.35    1890.3
219 -3.633376       11.2     1210.1       -0.35       0.13    1742.3
220 -3.633376       11.2     1047.7       -0.08       0.50    2022.8
221 -3.633376       10.8     1013.6       -0.45      -0.24    1768.3
222 -3.633376        9.3     1390.5        0.52       0.07    1589.4
223 -4.444257       11.2     1210.1       -0.35       0.13    1742.3
224 -4.444257       10.8     1013.6       -0.45      -0.24    1768.3
225 -4.444257       11.2     1047.7       -0.08       0.50    2022.8
226 -4.444257        9.9     1076.4       -0.10       0.19    1748.2
227 -4.444257        9.3     1390.5        0.52       0.07    1589.4
228 -4.444257       10.2     1063.5       -0.25       0.28    1758.6
229 -4.444257       10.6      980.7       -0.25       0.35    1890.3
230 -4.444257         NA         NA          NA         NA        NA
231 -4.444257       10.2     1063.5       -0.25       0.28    1758.6
232 -4.538236       11.2      900.8       -0.46      -0.09    1855.8
233 -4.538236       10.6      972.1       -0.19       0.05    1828.8
234 -4.538236       10.3      919.3       -0.25       0.18    1748.3
235 -4.538236        9.6     1072.9        0.21       0.14    1674.8
236 -4.538236       10.9      856.3       -0.03       0.55    1974.4
237 -4.538236       11.2      900.8       -0.46      -0.09    1855.8
238 -4.538236         NA         NA          NA         NA        NA
239 -4.538236       11.4      836.8       -0.21       0.43    2078.9
240 -4.538236       11.5     1097.9       -0.26       0.11    1745.3
241 -4.538236       10.9      856.3       -0.03       0.55    1974.4
242 -4.485508        9.6     1072.9        0.21       0.14    1674.8
243 -4.485508       11.2      900.8       -0.46      -0.09    1855.8
244 -4.485508       10.9      856.3       -0.03       0.55    1974.4
245 -4.485508         NA         NA          NA         NA        NA
246 -4.485508       10.3      919.3       -0.25       0.18    1748.3
247 -4.485508       11.5     1097.9       -0.26       0.11    1745.3
248 -4.485508       10.9      856.3       -0.03       0.55    1974.4
249 -4.485508       11.4      836.8       -0.21       0.43    2078.9
250 -4.485508       11.2      900.8       -0.46      -0.09    1855.8
251 -4.485508       10.6      972.1       -0.19       0.05    1828.8
252 -4.487261       10.6      972.1       -0.19       0.05    1828.8
253 -4.487261        9.6     1072.9        0.21       0.14    1674.8
254 -4.487261         NA         NA          NA         NA        NA
255 -4.487261       11.2      900.8       -0.46      -0.09    1855.8
256 -4.487261       10.3      919.3       -0.25       0.18    1748.3
257 -4.487261       11.5     1097.9       -0.26       0.11    1745.3
258 -4.487261       11.2      900.8       -0.46      -0.09    1855.8
259 -4.487261       11.4      836.8       -0.21       0.43    2078.9
260 -4.487261       10.9      856.3       -0.03       0.55    1974.4
261 -4.487261       10.9      856.3       -0.03       0.55    1974.4
262 -4.494157       11.2      900.8       -0.46      -0.09    1855.8
263 -4.494157       11.5     1097.9       -0.26       0.11    1745.3
264 -4.494157       10.9      856.3       -0.03       0.55    1974.4
265 -4.494157         NA         NA          NA         NA        NA
266 -4.494157       11.4      836.8       -0.21       0.43    2078.9
267 -4.494157       10.6      972.1       -0.19       0.05    1828.8
268 -4.494157       10.3      919.3       -0.25       0.18    1748.3
269 -4.494157        9.6     1072.9        0.21       0.14    1674.8
270 -4.494157       11.2      900.8       -0.46      -0.09    1855.8
271 -4.494157       10.9      856.3       -0.03       0.55    1974.4
272 -3.704663       10.6      972.1       -0.19       0.05    1828.8
273 -3.704663       10.3      919.3       -0.25       0.18    1748.3
274 -3.704663       11.2      900.8       -0.46      -0.09    1855.8
275 -3.704663       11.4      836.8       -0.21       0.43    2078.9
276 -3.704663       11.5     1097.9       -0.26       0.11    1745.3
277 -3.704663       10.9      856.3       -0.03       0.55    1974.4
278 -3.704663         NA         NA          NA         NA        NA
279 -3.704663       11.2      900.8       -0.46      -0.09    1855.8
280 -3.704663        9.6     1072.9        0.21       0.14    1674.8
281 -3.704663       10.9      856.3       -0.03       0.55    1974.4
282 -3.878354         NA         NA          NA         NA        NA
283 -3.878354       11.2      900.8       -0.46      -0.09    1855.8
284 -3.878354       10.9      856.3       -0.03       0.55    1974.4
285 -3.878354       10.6      972.1       -0.19       0.05    1828.8
286 -3.878354       11.4      836.8       -0.21       0.43    2078.9
287 -3.878354       11.5     1097.9       -0.26       0.11    1745.3
288 -3.878354        9.6     1072.9        0.21       0.14    1674.8
289 -3.878354       11.2      900.8       -0.46      -0.09    1855.8
290 -3.878354       10.9      856.3       -0.03       0.55    1974.4
291 -3.878354       10.3      919.3       -0.25       0.18    1748.3
292 -3.723018       11.2      900.8       -0.46      -0.09    1855.8
293 -3.723018       10.9      856.3       -0.03       0.55    1974.4
294 -3.723018       10.6      972.1       -0.19       0.05    1828.8
295 -3.723018       11.5     1097.9       -0.26       0.11    1745.3
296 -3.723018       11.2      900.8       -0.46      -0.09    1855.8
297 -3.723018        9.6     1072.9        0.21       0.14    1674.8
298 -3.723018       11.4      836.8       -0.21       0.43    2078.9
299 -3.723018         NA         NA          NA         NA        NA
300 -3.723018       10.9      856.3       -0.03       0.55    1974.4
301 -3.723018       10.3      919.3       -0.25       0.18    1748.3
302 -3.694584       10.6      972.1       -0.19       0.05    1828.8
303 -3.694584       10.9      856.3       -0.03       0.55    1974.4
304 -3.694584       10.3      919.3       -0.25       0.18    1748.3
305 -3.694584       10.9      856.3       -0.03       0.55    1974.4
306 -3.694584         NA         NA          NA         NA        NA
307 -3.694584        9.6     1072.9        0.21       0.14    1674.8
308 -3.694584       11.4      836.8       -0.21       0.43    2078.9
309 -3.694584       11.2      900.8       -0.46      -0.09    1855.8
310 -3.694584       11.2      900.8       -0.46      -0.09    1855.8
311 -3.694584       11.5     1097.9       -0.26       0.11    1745.3
312 -3.582130         NA         NA          NA         NA        NA
313 -3.582130       10.9      856.3       -0.03       0.55    1974.4
314 -3.582130       11.4      836.8       -0.21       0.43    2078.9
315 -3.582130       10.3      919.3       -0.25       0.18    1748.3
316 -3.582130       11.2      900.8       -0.46      -0.09    1855.8
317 -3.582130       11.5     1097.9       -0.26       0.11    1745.3
318 -3.582130       10.9      856.3       -0.03       0.55    1974.4
319 -3.582130       10.6      972.1       -0.19       0.05    1828.8
320 -3.582130       11.2      900.8       -0.46      -0.09    1855.8
321 -3.582130        9.6     1072.9        0.21       0.14    1674.8
322 -3.478467         NA         NA          NA         NA        NA
323 -3.478467       11.5     1097.9       -0.26       0.11    1745.3
324 -3.478467       10.9      856.3       -0.03       0.55    1974.4
325 -3.478467       10.3      919.3       -0.25       0.18    1748.3
326 -3.478467        9.6     1072.9        0.21       0.14    1674.8
327 -3.478467       10.6      972.1       -0.19       0.05    1828.8
328 -3.478467       11.2      900.8       -0.46      -0.09    1855.8
329 -3.478467       11.4      836.8       -0.21       0.43    2078.9
330 -3.478467       10.9      856.3       -0.03       0.55    1974.4
331 -3.478467       11.2      900.8       -0.46      -0.09    1855.8
332 -3.294130       10.9      856.3       -0.03       0.55    1974.4
333 -3.294130       11.2      900.8       -0.46      -0.09    1855.8
334 -3.294130       11.4      836.8       -0.21       0.43    2078.9
335 -3.294130        9.6     1072.9        0.21       0.14    1674.8
336 -3.294130       10.6      972.1       -0.19       0.05    1828.8
337 -3.294130         NA         NA          NA         NA        NA
338 -3.294130       10.9      856.3       -0.03       0.55    1974.4
339 -3.294130       11.2      900.8       -0.46      -0.09    1855.8
340 -3.294130       11.5     1097.9       -0.26       0.11    1745.3
341 -3.294130       10.3      919.3       -0.25       0.18    1748.3
342 -2.832729        9.6     1072.9        0.21       0.14    1674.8
343 -2.832729       11.4      836.8       -0.21       0.43    2078.9
344 -2.832729       11.2      900.8       -0.46      -0.09    1855.8
345 -2.832729       11.5     1097.9       -0.26       0.11    1745.3
346 -2.832729       10.9      856.3       -0.03       0.55    1974.4
347 -2.832729       10.3      919.3       -0.25       0.18    1748.3
348 -2.832729       10.9      856.3       -0.03       0.55    1974.4
349 -2.832729       11.2      900.8       -0.46      -0.09    1855.8
350 -2.832729         NA         NA          NA         NA        NA
351 -2.832729       10.6      972.1       -0.19       0.05    1828.8
352 -5.521291       10.9      856.3       -0.03       0.55    1974.4
353 -5.521291       10.6      972.1       -0.19       0.05    1828.8
354 -5.521291       11.2      900.8       -0.46      -0.09    1855.8
355 -5.521291       11.5     1097.9       -0.26       0.11    1745.3
356 -5.521291       11.2      900.8       -0.46      -0.09    1855.8
357 -5.521291         NA         NA          NA         NA        NA
358 -5.521291       10.3      919.3       -0.25       0.18    1748.3
359 -5.521291        9.6     1072.9        0.21       0.14    1674.8
360 -5.521291       11.4      836.8       -0.21       0.43    2078.9
361 -5.521291       10.9      856.3       -0.03       0.55    1974.4
362 -5.242494       11.2      900.8       -0.46      -0.09    1855.8
363 -5.242494        9.6     1072.9        0.21       0.14    1674.8
364 -5.242494       11.5     1097.9       -0.26       0.11    1745.3
365 -5.242494       10.6      972.1       -0.19       0.05    1828.8
366 -5.242494       11.2      900.8       -0.46      -0.09    1855.8
367 -5.242494       11.4      836.8       -0.21       0.43    2078.9
368 -5.242494       10.9      856.3       -0.03       0.55    1974.4
369 -5.242494         NA         NA          NA         NA        NA
370 -5.242494       10.9      856.3       -0.03       0.55    1974.4
371 -5.242494       10.3      919.3       -0.25       0.18    1748.3
372 -5.822992       11.2      900.8       -0.46      -0.09    1855.8
373 -5.822992       11.5     1097.9       -0.26       0.11    1745.3
374 -5.822992        9.6     1072.9        0.21       0.14    1674.8
375 -5.822992       10.9      856.3       -0.03       0.55    1974.4
376 -5.822992         NA         NA          NA         NA        NA
377 -5.822992       10.9      856.3       -0.03       0.55    1974.4
378 -5.822992       10.3      919.3       -0.25       0.18    1748.3
379 -5.822992       11.4      836.8       -0.21       0.43    2078.9
380 -5.822992       11.2      900.8       -0.46      -0.09    1855.8
381 -5.822992       10.6      972.1       -0.19       0.05    1828.8
382 -5.014236       10.6      972.1       -0.19       0.05    1828.8
383 -5.014236       11.2      900.8       -0.46      -0.09    1855.8
384 -5.014236       10.9      856.3       -0.03       0.55    1974.4
385 -5.014236       11.2      900.8       -0.46      -0.09    1855.8
386 -5.014236        9.6     1072.9        0.21       0.14    1674.8
387 -5.014236       11.4      836.8       -0.21       0.43    2078.9
388 -5.014236         NA         NA          NA         NA        NA
389 -5.014236       10.9      856.3       -0.03       0.55    1974.4
390 -5.014236       11.5     1097.9       -0.26       0.11    1745.3
391 -5.014236       10.3      919.3       -0.25       0.18    1748.3
392 -3.593846       11.2      900.8       -0.46      -0.09    1855.8
393 -3.593846       11.5     1097.9       -0.26       0.11    1745.3
394 -3.593846       10.6      972.1       -0.19       0.05    1828.8
395 -3.593846       10.9      856.3       -0.03       0.55    1974.4
396 -3.593846        9.6     1072.9        0.21       0.14    1674.8
397 -3.593846       10.9      856.3       -0.03       0.55    1974.4
398 -3.593846       11.2      900.8       -0.46      -0.09    1855.8
399 -3.593846         NA         NA          NA         NA        NA
400 -3.593846       10.3      919.3       -0.25       0.18    1748.3
401 -3.593846       11.4      836.8       -0.21       0.43    2078.9
402 -3.939277       10.6      972.1       -0.19       0.05    1828.8
403 -3.939277       11.5     1097.9       -0.26       0.11    1745.3
404 -3.939277         NA         NA          NA         NA        NA
405 -3.939277       11.2      900.8       -0.46      -0.09    1855.8
406 -3.939277       10.3      919.3       -0.25       0.18    1748.3
407 -3.939277       11.4      836.8       -0.21       0.43    2078.9
408 -3.939277        9.6     1072.9        0.21       0.14    1674.8
409 -3.939277       11.2      900.8       -0.46      -0.09    1855.8
410 -3.939277       10.9      856.3       -0.03       0.55    1974.4
411 -3.939277       10.9      856.3       -0.03       0.55    1974.4
412 -4.211202       11.2      900.8       -0.46      -0.09    1855.8
413 -4.211202       10.9      856.3       -0.03       0.55    1974.4
414 -4.211202       11.2      900.8       -0.46      -0.09    1855.8
415 -4.211202       10.6      972.1       -0.19       0.05    1828.8
416 -4.211202         NA         NA          NA         NA        NA
417 -4.211202       10.3      919.3       -0.25       0.18    1748.3
418 -4.211202        9.6     1072.9        0.21       0.14    1674.8
419 -4.211202       11.5     1097.9       -0.26       0.11    1745.3
420 -4.211202       11.4      836.8       -0.21       0.43    2078.9
421 -4.211202       10.9      856.3       -0.03       0.55    1974.4
422 -4.205547        9.6     1072.9        0.21       0.14    1674.8
423 -4.205547       11.2      900.8       -0.46      -0.09    1855.8
424 -4.205547         NA         NA          NA         NA        NA
425 -4.205547       10.9      856.3       -0.03       0.55    1974.4
426 -4.205547       10.3      919.3       -0.25       0.18    1748.3
427 -4.205547       11.4      836.8       -0.21       0.43    2078.9
428 -4.205547       10.9      856.3       -0.03       0.55    1974.4
429 -4.205547       11.2      900.8       -0.46      -0.09    1855.8
430 -4.205547       11.5     1097.9       -0.26       0.11    1745.3
431 -4.205547       10.6      972.1       -0.19       0.05    1828.8
432 -3.147068       10.9      856.3       -0.03       0.55    1974.4
433 -3.147068       11.2      900.8       -0.46      -0.09    1855.8
434 -3.147068         NA         NA          NA         NA        NA
435 -3.147068       10.6      972.1       -0.19       0.05    1828.8
436 -3.147068       10.3      919.3       -0.25       0.18    1748.3
437 -3.147068       10.9      856.3       -0.03       0.55    1974.4
438 -3.147068        9.6     1072.9        0.21       0.14    1674.8
439 -3.147068       11.5     1097.9       -0.26       0.11    1745.3
440 -3.147068       11.2      900.8       -0.46      -0.09    1855.8
441 -3.147068       11.4      836.8       -0.21       0.43    2078.9
442 -3.244945        9.6     1072.9        0.21       0.14    1674.8
443 -3.244945       11.2      900.8       -0.46      -0.09    1855.8
444 -3.244945       10.3      919.3       -0.25       0.18    1748.3
445 -3.244945       10.6      972.1       -0.19       0.05    1828.8
446 -3.244945       11.5     1097.9       -0.26       0.11    1745.3
447 -3.244945       10.9      856.3       -0.03       0.55    1974.4
448 -3.244945       10.9      856.3       -0.03       0.55    1974.4
449 -3.244945       11.2      900.8       -0.46      -0.09    1855.8
450 -3.244945       11.4      836.8       -0.21       0.43    2078.9
451 -3.244945         NA         NA          NA         NA        NA
452 -3.148416         NA         NA          NA         NA        NA
453 -3.148416       10.6      972.1       -0.19       0.05    1828.8
454 -3.148416       10.9      856.3       -0.03       0.55    1974.4
455 -3.148416        9.6     1072.9        0.21       0.14    1674.8
456 -3.148416       11.2      900.8       -0.46      -0.09    1855.8
457 -3.148416       11.2      900.8       -0.46      -0.09    1855.8
458 -3.148416       10.9      856.3       -0.03       0.55    1974.4
459 -3.148416       11.4      836.8       -0.21       0.43    2078.9
460 -3.148416       11.5     1097.9       -0.26       0.11    1745.3
461 -3.148416       10.3      919.3       -0.25       0.18    1748.3
462 -3.404054       10.9      856.3       -0.03       0.55    1974.4
463 -3.404054         NA         NA          NA         NA        NA
464 -3.404054       10.9      856.3       -0.03       0.55    1974.4
465 -3.404054       10.3      919.3       -0.25       0.18    1748.3
466 -3.404054       10.6      972.1       -0.19       0.05    1828.8
467 -3.404054       11.4      836.8       -0.21       0.43    2078.9
468 -3.404054       11.2      900.8       -0.46      -0.09    1855.8
469 -3.404054       11.5     1097.9       -0.26       0.11    1745.3
470 -3.404054        9.6     1072.9        0.21       0.14    1674.8
471 -3.404054       11.2      900.8       -0.46      -0.09    1855.8
    juvdev_temp
1          1.07
2            NA
3          1.07
4            NA
5          1.07
6            NA
7          1.07
8            NA
9          1.07
10           NA
11         1.07
12           NA
13           NA
14         1.07
15         1.07
16           NA
17         1.07
18           NA
19         1.07
20           NA
21           NA
22         1.07
23         1.07
24           NA
25         1.00
26         1.37
27         1.60
28           NA
29         1.10
30         1.60
31         0.40
32         1.37
33        -0.34
34         1.00
35         1.37
36         1.10
37         0.40
38         1.37
39         1.60
40         1.60
41           NA
42        -0.34
43         1.00
44         0.40
45         1.60
46        -0.34
47         1.60
48           NA
49         1.10
50         1.37
51         1.37
52        -0.34
53         0.40
54           NA
55         1.37
56         1.37
57         1.10
58         1.60
59         1.00
60         1.60
61         1.37
62         1.10
63           NA
64         1.37
65         1.60
66         0.40
67        -0.34
68         1.60
69         1.00
70         1.37
71         1.60
72           NA
73        -0.34
74         1.00
75         1.37
76         1.60
77         0.40
78         1.10
79         1.00
80         1.60
81         1.10
82         1.60
83           NA
84         1.37
85        -0.34
86         1.37
87         0.40
88           NA
89         1.37
90         1.37
91         1.60
92         1.60
93         0.40
94         1.10
95         1.00
96        -0.34
97         1.00
98         0.40
99           NA
100        1.37
101        1.37
102       -0.34
103        1.60
104        1.10
105        1.60
106        1.10
107        1.60
108        0.40
109        1.00
110        1.37
111          NA
112        1.37
113        1.60
114       -0.34
115        1.37
116        1.00
117        1.60
118        0.40
119          NA
120        1.60
121        1.37
122       -0.34
123        1.10
124        1.27
125        0.43
126        1.10
127        1.24
128        1.67
129          NA
130       -0.14
131        1.70
132        1.27
133        1.27
134        1.70
135        1.67
136          NA
137        1.27
138        1.24
139        0.43
140        1.10
141       -0.14
142        1.27
143        0.43
144       -0.14
145        1.27
146          NA
147        1.10
148        1.67
149        1.24
150        1.70
151        1.10
152          NA
153        0.43
154        1.27
155        1.24
156        1.70
157        1.27
158       -0.14
159        1.67
160          NA
161        1.27
162        1.67
163        1.70
164        0.43
165        1.24
166       -0.14
167        1.10
168        1.27
169       -0.14
170        1.70
171        1.27
172          NA
173        1.67
174        0.43
175        1.27
176        1.10
177        1.24
178        1.67
179        1.70
180       -0.14
181        1.10
182          NA
183        1.24
184        1.27
185        1.27
186        0.43
187        1.67
188       -0.14
189        0.43
190        1.27
191        1.70
192        1.24
193        1.27
194        1.10
195          NA
196       -0.14
197        1.24
198        1.67
199          NA
200        1.27
201        1.27
202        1.10
203        0.43
204        1.70
205        1.70
206        0.43
207          NA
208        1.10
209       -0.14
210        1.27
211        1.27
212        1.24
213        1.67
214        1.70
215        1.27
216        1.27
217          NA
218        1.24
219        1.67
220        1.10
221        0.43
222       -0.14
223        1.67
224        0.43
225        1.10
226        1.70
227       -0.14
228        1.27
229        1.24
230          NA
231        1.27
232        0.30
233        0.43
234        2.00
235       -0.28
236        3.07
237        0.30
238          NA
239        1.03
240        1.50
241        3.07
242       -0.28
243        0.30
244        3.07
245          NA
246        2.00
247        1.50
248        3.07
249        1.03
250        0.30
251        0.43
252        0.43
253       -0.28
254          NA
255        0.30
256        2.00
257        1.50
258        0.30
259        1.03
260        3.07
261        3.07
262        0.30
263        1.50
264        3.07
265          NA
266        1.03
267        0.43
268        2.00
269       -0.28
270        0.30
271        3.07
272        0.43
273        2.00
274        0.30
275        1.03
276        1.50
277        3.07
278          NA
279        0.30
280       -0.28
281        3.07
282          NA
283        0.30
284        3.07
285        0.43
286        1.03
287        1.50
288       -0.28
289        0.30
290        3.07
291        2.00
292        0.30
293        3.07
294        0.43
295        1.50
296        0.30
297       -0.28
298        1.03
299          NA
300        3.07
301        2.00
302        0.43
303        3.07
304        2.00
305        3.07
306          NA
307       -0.28
308        1.03
309        0.30
310        0.30
311        1.50
312          NA
313        3.07
314        1.03
315        2.00
316        0.30
317        1.50
318        3.07
319        0.43
320        0.30
321       -0.28
322          NA
323        1.50
324        3.07
325        2.00
326       -0.28
327        0.43
328        0.30
329        1.03
330        3.07
331        0.30
332        3.07
333        0.30
334        1.03
335       -0.28
336        0.43
337          NA
338        3.07
339        0.30
340        1.50
341        2.00
342       -0.28
343        1.03
344        0.30
345        1.50
346        3.07
347        2.00
348        3.07
349        0.30
350          NA
351        0.43
352        3.07
353        0.43
354        0.30
355        1.50
356        0.30
357          NA
358        2.00
359       -0.28
360        1.03
361        3.07
362        0.30
363       -0.28
364        1.50
365        0.43
366        0.30
367        1.03
368        3.07
369          NA
370        3.07
371        2.00
372        0.30
373        1.50
374       -0.28
375        3.07
376          NA
377        3.07
378        2.00
379        1.03
380        0.30
381        0.43
382        0.43
383        0.30
384        3.07
385        0.30
386       -0.28
387        1.03
388          NA
389        3.07
390        1.50
391        2.00
392        0.30
393        1.50
394        0.43
395        3.07
396       -0.28
397        3.07
398        0.30
399          NA
400        2.00
401        1.03
402        0.43
403        1.50
404          NA
405        0.30
406        2.00
407        1.03
408       -0.28
409        0.30
410        3.07
411        3.07
412        0.30
413        3.07
414        0.30
415        0.43
416          NA
417        2.00
418       -0.28
419        1.50
420        1.03
421        3.07
422       -0.28
423        0.30
424          NA
425        3.07
426        2.00
427        1.03
428        3.07
429        0.30
430        1.50
431        0.43
432        3.07
433        0.30
434          NA
435        0.43
436        2.00
437        3.07
438       -0.28
439        1.50
440        0.30
441        1.03
442       -0.28
443        0.30
444        2.00
445        0.43
446        1.50
447        3.07
448        3.07
449        0.30
450        1.03
451          NA
452          NA
453        0.43
454        3.07
455       -0.28
456        0.30
457        0.30
458        3.07
459        1.03
460        1.50
461        2.00
462        3.07
463          NA
464        3.07
465        2.00
466        0.43
467        1.03
468        0.30
469        1.50
470       -0.28
471        0.30</code></pre>
</div>
</div>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>we used machine learning methods to assess how much information different sets of variables (c.f. <code>P_var_sets</code>) have each on the dependent variable (Puptake, Y-rel, P-balance), how redundant this information is. The machine learning methods to quantify the predictive power of different variable sets are: i) ordinary least squares (OLS) as a baseline; ii) XGBoost (gradient boosting with tree-based models and hyperparameter tuning for learning rate and tree depth) (arxiv:1603.02754); iii) Random Forests (with default parameters) (doi:10.1023/A:1010933404324). Computations were performed using the mlr3 framework (doi:10.21105/joss.01903). Performance was measured as percentage of explained variance on hold-out data via 5-fold cross-validation, calculated as (1 - MSE/Variance(y)), where MSE represents mean squared error.</p>
<p>We tried adjusting for weather variables but it seems that the ML-methods rather reconstruct the site-specific patternsâ€¦.</p>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Andrapodon\.github\.io\/Master-Thesis-P-kinetics\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>