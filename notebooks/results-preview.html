<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.42">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Marc Pérez">
    <meta name="dcterms.date" content="2025-05-22">

    <title>Model Validation and coefficient calculation</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cbf367297292b8e2858f4d7b7fd861d6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">  <style>
.quarto-notebook .cell-container .cell-decorator {
  display: none;
}
</style>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Preliminary Results</h6>

            <a href="../notebooks/results.qmd" class="btn btn-primary quarto-download-embed" download="results.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Model Validation and coefficient calculation</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>Marc Pérez </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">May 22, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    <div class="quarto-other-links"><div class="quarto-title-meta-heading">Other Links</div><div class="quarto-title-meta-contents"><span><a href="../presentation/index.html"><i class="bi bi-link-45deg"></i>Presentation</a></span></div></div></div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#results" id="toc-results" class="nav-link active" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#establishment-of-the-p-desorption-kinetic-model" id="toc-establishment-of-the-p-desorption-kinetic-model" class="nav-link" data-scroll-target="#establishment-of-the-p-desorption-kinetic-model">Establishment of the P-Desorption Kinetic Model</a>
  <ul class="collapse">
  <li><a href="#initial-approach-linearized-model" id="toc-initial-approach-linearized-model" class="nav-link" data-scroll-target="#initial-approach-linearized-model">Initial Approach: Linearized Model</a></li>
  <li><a href="#final-approach-non-linear-model" id="toc-final-approach-non-linear-model" class="nav-link" data-scroll-target="#final-approach-non-linear-model">Final Approach: Non-Linear Model</a></li>
  </ul></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions:</a>
  <ul class="collapse">
  <li><a href="#how-well-can-current-grud-measurements-of-c_p-predict-the-relative-yield-p-uptake-and-p-balance" id="toc-how-well-can-current-grud-measurements-of-c_p-predict-the-relative-yield-p-uptake-and-p-balance" class="nav-link" data-scroll-target="#how-well-can-current-grud-measurements-of-c_p-predict-the-relative-yield-p-uptake-and-p-balance">How well can current GRUD measurements of <span class="math inline">\(C_P\)</span> predict the relative Yield, P-Uptake and P-Balance?</a></li>
  <li><a href="#how-do-grud-measurements-of-c_p-relate-to-the-soil-properties-c_textorg-content-clay-content-silt-content-and-ph" id="toc-how-do-grud-measurements-of-c_p-relate-to-the-soil-properties-c_textorg-content-clay-content-silt-content-and-ph" class="nav-link" data-scroll-target="#how-do-grud-measurements-of-c_p-relate-to-the-soil-properties-c_textorg-content-clay-content-silt-content-and-ph">How do GRUD-measurements of <span class="math inline">\(C_P\)</span> relate to the soil properties <span class="math inline">\(C_\text{org}\)</span>-content, clay-content, silt-content and pH?</a></li>
  <li><a href="#can-the-inclusion-of-the-net-release-kinetic-of-orthophosphate-improve-the-model-power-of-predicting-relative-yield-p-uptake-and-p-balance" id="toc-can-the-inclusion-of-the-net-release-kinetic-of-orthophosphate-improve-the-model-power-of-predicting-relative-yield-p-uptake-and-p-balance" class="nav-link" data-scroll-target="#can-the-inclusion-of-the-net-release-kinetic-of-orthophosphate-improve-the-model-power-of-predicting-relative-yield-p-uptake-and-p-balance">Can the Inclusion of the net-release-kinetic of Orthophosphate improve the model power of predicting relative Yield, P-Uptake and P-Balance?</a></li>
  <li><a href="#are-the-kinetic-coefficients-k-and-psk-can-be-interpreted-as-the-relative-speed-of-desorption-ps-is-the-equilibrium-concentration-of-po_43--of-the-observed-desorption-in-the-dried-fine-earth-water-suspension-120-by-weight-related-to-soil-properties" id="toc-are-the-kinetic-coefficients-k-and-psk-can-be-interpreted-as-the-relative-speed-of-desorption-ps-is-the-equilibrium-concentration-of-po_43--of-the-observed-desorption-in-the-dried-fine-earth-water-suspension-120-by-weight-related-to-soil-properties" class="nav-link" data-scroll-target="#are-the-kinetic-coefficients-k-and-psk-can-be-interpreted-as-the-relative-speed-of-desorption-ps-is-the-equilibrium-concentration-of-po_43--of-the-observed-desorption-in-the-dried-fine-earth-water-suspension-120-by-weight-related-to-soil-properties">Are the kinetic coefficients <span class="math inline">\(k\)</span> and <span class="math inline">\(PS\)</span>(<span class="math inline">\(k\)</span> can be interpreted as the relative speed of desorption, <span class="math inline">\(PS\)</span> is the equilibrium concentration of <span class="math inline">\(PO_4^{3-}\)</span> of the observed desorption in the dried fine earth-water suspension 1:20 by weight) related to soil properties?</a></li>
  <li><a href="#is-the-method-presented-by-flossmann-and-richter-1982-with-the-double-extraction-replicable-with-the-soils-from-the-stycs-trial" id="toc-is-the-method-presented-by-flossmann-and-richter-1982-with-the-double-extraction-replicable-with-the-soils-from-the-stycs-trial" class="nav-link" data-scroll-target="#is-the-method-presented-by-flossmann-and-richter-1982-with-the-double-extraction-replicable-with-the-soils-from-the-stycs-trial">Is the method presented by Flossmann and Richter (1982) with the double extraction replicable with the soils from the STYCS-trial?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container code-fold"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'ggpp':
  method                  from   
  heightDetails.titleGrob ggplot2
  widthDetails.titleGrob  ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpp'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    annotate</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmList</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:kableExtra':

    group_rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'MuMIn':
  method        from 
  nobs.multinom broom
  nobs.fitdistr broom</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># table functions</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc) <span class="co"># sample data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sjmisc'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    replace_na</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># fitting models</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"~/Documents/Master Thesis/Master-Thesis-P-kinetics/data/results_coefficient_analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<!-- ## Struktur -->
<!-- ## Warum ist die Arbeit wichtig -->
<!-- P ist endlich, Umweltprobleme \## P ist sehr komplex -->
<!-- Siehe oben \## Wie wird bisher P-Ernährung angegangen -->
<!-- GRUD -->
<!-- ## Warum Bodentest -->
<!-- ## Warum kinetischer Bodentest -->
<section id="results" class="level1">
<h1>Results</h1>
<p>The results are presented in three main parts. First, the development and validation of the phosphorus (P) desorption kinetic model are detailed, justifying the final modeling approach. Second, the descriptive trends of both agronomic outcomes and soil P parameters in response to long-term fertilization and site differences are explored visually. Finally, the predictive power of the kinetic and standard P parameters is formally evaluated using linear mixed-effects models.</p>
<section id="establishment-of-the-p-desorption-kinetic-model" class="level2">
<h2 class="anchored" data-anchor-id="establishment-of-the-p-desorption-kinetic-model">Establishment of the P-Desorption Kinetic Model</h2>
<p>The primary goal was to derive two key parameters for each soil sample: the desorbable P pool (<span class="math inline">\(P_{desorb}\)</span>) and the rate constant (<span class="math inline">\(k\)</span>). The analysis proceeded in two stages: an initial test of a linearized model, followed by the implementation of a more robust non-linear model.</p>
<section id="initial-approach-linearized-model" class="level3">
<h3 class="anchored" data-anchor-id="initial-approach-linearized-model">Initial Approach: Linearized Model</h3>
<p>Following the conceptual framework of Flossmann and Richter (1982), the first-order kinetic equation was linearized to the form <span class="math inline">\(ln(1 - P/P_{desorb}) = -kt\)</span>. For this approach, the asymptote (<span class="math inline">\(P_{desorb}\)</span>) was not fitted but was calculated beforehand as the difference between Olsen-P and water-soluble P. A linear model was then fitted to the transformed data for each sample.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="cell-fig-linearized-model" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a placeholder for your code from pretest.qmd</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(d[d<span class="sc">$</span>Treatment<span class="sc">!=</span><span class="st">"P100"</span><span class="sc">&amp;</span>(d<span class="sc">$</span>Repetition<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>d<span class="sc">$</span>Repetition<span class="sc">==</span><span class="dv">2</span>),], <span class="fu">aes</span>(<span class="at">y=</span>Y1, <span class="at">x=</span>t.min., <span class="at">col =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_grid</span>(Site <span class="sc">~</span> Treatment) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$Time (min)$"</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"$ln(1-</span><span class="sc">\\</span><span class="st">frac{P}{P_S})$"</span>)) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 13 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 13 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearized-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearized-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="results_files/figure-html/fig-linearized-model-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Test of the linearized first-order kinetic model. Data is faceted by Site and P fertilization Treatment. The solid line represents a linear model fit."><img src="results_files/figure-html/fig-linearized-model-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearized-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Test of the linearized first-order kinetic model. Data is faceted by Site and P fertilization Treatment. The solid line represents a linear model fit.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p><em>(Placeholder for the linearized model plot)</em></p>
<p>The results of this linearized approach were inconsistent (Figure X.1). While some samples showed a reasonable linear trend, many exhibited significant deviations, particularly a curvilinear pattern. Furthermore, the model required the intercept to be fixed at zero, but the statistical summary of the fitted models (<code>lmList</code>) showed that the estimated intercepts were often significantly different from zero (p &lt; 0.05). For example, the sample <code>Cadenazzo_P166_1</code> had a highly significant intercept of -0.27 (p &lt; 0.001). This systematic deviation from the model’s core assumption indicated that this linearized approach, which relied on an externally estimated asymptote, was not robust for this dataset.</p>
</section>
<section id="final-approach-non-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="final-approach-non-linear-model">Final Approach: Non-Linear Model</h3>
<p>Given the limitations of the linearized method, a direct non-linear modeling approach was adopted to estimate both <span class="math inline">\(P_{desorb}\)</span> and <span class="math inline">\(k\)</span> simultaneously from the untransformed data. The model <span class="math inline">\(P(t) = P_{desorb} \times (1 - e^{-k \times t'})\)</span> was fitted to each sample’s desorption curve.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="cell-fig-nonlinear-model" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">nlsList</span>(Pv.mg.L. <span class="sc">~</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> (t.dt))) <span class="sc">|</span> uid, d[, <span class="fu">c</span>(<span class="st">"Pv.mg.L."</span>, <span class="st">"uid"</span>, <span class="st">"t.dt"</span>)],  <span class="at">start=</span><span class="fu">list</span>(<span class="at">PS=</span><span class="fl">0.1</span>,<span class="at">k=</span><span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 error caught in nls(model, data = data, control = controlvals, start
= start): singular gradient</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(Res)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># d$nls_pred &lt;- predict(Res)</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from the nlsList results</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>nls_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(Res)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>nls_coefs<span class="sc">$</span>uid <span class="ot">&lt;-</span> <span class="fu">rownames</span>(nls_coefs)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge coefficients back to the main dataset</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(d, nls_coefs, <span class="at">by =</span> <span class="st">"uid"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Most straightforward approach - create curves manually</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>time_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>t.dt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(d<span class="sc">$</span>t.dt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> d_plot <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uid, Site, Treatment, Repetition, PS, k) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">t.dt =</span> time_seq) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_Pv =</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> (t.dt))))</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a placeholder for your code from pretest.qmd</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a> p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data =</span> d_plot, <span class="fu">aes</span>(<span class="at">y =</span> Pv.mg.L., <span class="at">x =</span> t.dt, <span class="at">col =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data, <span class="fu">aes</span>(<span class="at">x =</span> t.dt, <span class="at">y =</span> pred_Pv, <span class="at">col =</span> Repetition), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_grid</span>(Treatment <span class="sc">~</span> Site,<span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(<span class="st">"$Time (min)$"</span>),</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$P_{V}(</span><span class="sc">\\</span><span class="st">frac{mg}{L})$"</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">suppressWarnings</span>(<span class="fu">print</span>(p1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-nonlinear-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nonlinear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="results_files/figure-html/fig-nonlinear-model-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Non-linear first-order kinetic model fits for P desorption over time. Points represent measured data and solid lines represent the fitted model for each replicate."><img src="results_files/figure-html/fig-nonlinear-model-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonlinear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Non-linear first-order kinetic model fits for P desorption over time. Points represent measured data and solid lines represent the fitted model for each replicate.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p><em>(Placeholder for the non-linear model plot)</em></p>
<p>This approach proved to be far more successful (Figure X.2). The non-linear model was able to accurately capture the curvilinear shape of the desorption data for nearly all samples. The successful convergence of the models for each unique sample (<code>uid</code>) provided robust, sample-specific estimates for both the desorbable P pool (<span class="math inline">\(P_{desorb}\)</span>) and the rate constant (<span class="math inline">\(k\)</span>). For example, for the sample <code>Cadenazzo_P166_1</code>, the model estimated a <span class="math inline">\(P_{desorb}\)</span> of 0.27 mg/L and a <span class="math inline">\(k\)</span> of 0.086 min⁻¹, both with high statistical significance (p &lt; 0.01).</p>
<p>To account for the hierarchical data structure and obtain the most reliable estimates, the final parameters were extracted from a non-linear mixed-effects model (<code>nlme</code>), which models the overall fixed effects for <span class="math inline">\(k\)</span> and <span class="math inline">\(P_{desorb}\)</span> while allowing for random variation among individual samples. These final <code>nlme</code>-derived coefficients were used for all subsequent analyses.</p>
</section>
</section>
<section id="research-questions" class="level2">
<h2 class="anchored" data-anchor-id="research-questions">Research Questions:</h2>
<section id="how-well-can-current-grud-measurements-of-c_p-predict-the-relative-yield-p-uptake-and-p-balance" class="level3">
<h3 class="anchored" data-anchor-id="how-well-can-current-grud-measurements-of-c_p-predict-the-relative-yield-p-uptake-and-p-balance">How well can current GRUD measurements of <span class="math inline">\(C_P\)</span> predict the relative Yield, P-Uptake and P-Balance?</h3>
<ul>
<li>Hypothesis I: The measurements of the equlibrium concentrations of Phosphorus in a solvent do not display significant effects on relative Yield and consequently P-Uptake, since it is strongly dependent on yield. <span class="math inline">\(C_P\)</span> relates strongly to the amount of Phosphorus applied, the P-balance might well be siginificantly correlated to <span class="math inline">\(C_P\)</span> but not explain a lot of variance.</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_CO2<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>Ymain_norm, <span class="at">x=</span>soil_0_20_P_CO2, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{CO_{2}}(mg/kg Soil)$"</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">"relative Yield (%)"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 77 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="results_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_AAE10<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>Ymain_norm, <span class="at">x=</span>soil_0_20_P_AAE10, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{AAE10}(mg/kg Soil)$"</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">"relative Yield (%)"</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.
Removed 77 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="results_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_CO2<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>D<span class="sc">$</span>annual_P_uptake<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>annual_P_uptake, <span class="at">x=</span>soil_0_20_P_CO2, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{CO_{2}}(mg/kg Soil)$"</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"Annual P-Uptake $kg~P/ha$"</span>)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 124 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="results_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_AAE10<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>D<span class="sc">$</span>annual_P_uptake<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>annual_P_uptake, <span class="at">x=</span>soil_0_20_P_AAE10, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{AAE10}(mg/kg Soil)$"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"Annual P-Uptake $kg~P/ha$"</span>)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.
Removed 124 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="results_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_CO2<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>D<span class="sc">$</span>annual_P_balance<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>annual_P_balance, <span class="at">x=</span>soil_0_20_P_CO2, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{CO_{2}}(mg/kg Soil)$"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"Annual P-Balance $kg~P/ha$"</span>)) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in transformation$transform(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scale_y_log10(): log-10 transformation introduced infinite values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 216 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="results_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D[D<span class="sc">$</span>soil_0_20_P_AAE10<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>D<span class="sc">$</span>annual_P_balance<span class="sc">!=</span><span class="dv">0</span>,],<span class="fu">aes</span>(<span class="at">y=</span>annual_P_balance, <span class="at">x=</span>soil_0_20_P_AAE10, <span class="at">col=</span>Site, <span class="at">size =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$P_{AAE10}(mg/kg Soil)$"</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"Annual P-Balance $kg~P/ha$"</span>)) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using size for a discrete variable is not advised.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in transformation$transform(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in scale_y_log10(): log-10 transformation introduced infinite values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 216 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-1-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="results_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<p>Now we want to check the strength of the models in terms of <span class="math inline">\(R^2\)</span> and the significance of the effects in terms of p-values:</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_model(fit.grud.Yrel,fit.grud.Puptake,fit.grud.Pbalance)</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit.grud.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: lmerTest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict Ymain_rel with soil_0_20_P_CO2 and soil_0_20_P_AAE10 (formula:
Ymain_rel ~ log(soil_0_20_P_CO2) + log(soil_0_20_P_AAE10)). The model included
year as random effects (formula: list(~1 | year, ~1 | Site, ~1 | Site:block, ~1
| Site:Treatment)). The model's total explanatory power is substantial
(conditional R2 = 0.58) and the part related to the fixed effects alone
(marginal R2) is of 0.07. The model's intercept, corresponding to
soil_0_20_P_CO2 = 0 and soil_0_20_P_AAE10 = 0, is at 108.49 (95% CI [73.65,
143.34], t(204) = 6.14, p &lt; .001). Within this model:

  - The effect of soil 0 20 P CO2 [log] is statistically significant and positive
(beta = 9.69, 95% CI [1.35, 18.03], t(204) = 2.29, p = 0.023; Std. beta = 0.24,
95% CI [-0.42, 0.91])
  - The effect of soil 0 20 P AAE10 [log] is statistically non-significant and
negative (beta = -0.93, 95% CI [-9.14, 7.28], t(204) = -0.22, p = 0.823; Std.
beta = 0.47, 95% CI [-0.30, 1.24])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit.grud.Pexport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict annual_P_uptake with soil_0_20_P_CO2 and soil_0_20_P_AAE10 (formula:
annual_P_uptake ~ log(soil_0_20_P_CO2) + log(soil_0_20_P_AAE10)). The model
included year as random effects (formula: list(~1 | year, ~1 | Site, ~1 |
Site:block, ~1 | Site:Treatment)). The model's explanatory power related to the
fixed effects alone (marginal R2) is 0.15. The model's intercept, corresponding
to soil_0_20_P_CO2 = 0 and soil_0_20_P_AAE10 = 0, is at 24.73 (95% CI [7.95,
41.50], t(251) = 2.90, p = 0.004). Within this model:

  - The effect of soil 0 20 P CO2 [log] is statistically significant and positive
(beta = 4.56, 95% CI [1.04, 8.09], t(251) = 2.55, p = 0.011; Std. beta = 0.29,
95% CI [-0.20, 0.79])
  - The effect of soil 0 20 P AAE10 [log] is statistically non-significant and
positive (beta = 0.72, 95% CI [-3.01, 4.46], t(251) = 0.38, p = 0.703; Std.
beta = 0.45, 95% CI [-0.17, 1.07])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit.grud.Pbalance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Formula contains log- or sqrt-terms.
  See help("standardize") for how such terms are standardized.
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict annual_P_balance with soil_0_20_P_CO2 and soil_0_20_P_AAE10
(formula: annual_P_balance ~ log(soil_0_20_P_CO2) + log(soil_0_20_P_AAE10)).
The model included year as random effects (formula: list(~1 | year, ~1 | Site,
~1 | Site:block, ~1 | Site:Treatment)). The model's explanatory power related
to the fixed effects alone (marginal R2) is 3.54e-03. The model's intercept,
corresponding to soil_0_20_P_CO2 = 0 and soil_0_20_P_AAE10 = 0, is at 6.58 (95%
CI [-23.64, 36.79], t(266) = 0.43, p = 0.669). Within this model:

  - The effect of soil 0 20 P CO2 [log] is statistically non-significant and
negative (beta = -0.43, 95% CI [-8.71, 7.85], t(266) = -0.10, p = 0.919; Std.
beta = -1.18e-03, 95% CI [-0.50, 0.49])
  - The effect of soil 0 20 P AAE10 [log] is statistically non-significant and
negative (beta = -0.55, 95% CI [-7.41, 6.32], t(266) = -0.16, p = 0.876; Std.
beta = -0.06, 95% CI [-0.58, 0.46])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div></div>
<p>here I also show the non linear mixed models, following the Mitscherlich saturation curve:</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure grouping variables are factors</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>year  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(D<span class="sc">$</span>year)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>Site  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(D<span class="sc">$</span>Site)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(D<span class="sc">$</span>block)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>crop <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(D<span class="sc">$</span>crop)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.CO2.Yrel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  Ymain_rel <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> soil_0_20_P_CO2 <span class="sc">+</span> E)),                </span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> k <span class="sc">+</span> E <span class="sc">~</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> Treatment <span class="sc">!=</span> <span class="st">"P166"</span>,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">1100</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fl">0.05</span>, <span class="at">k1 =</span> <span class="dv">0</span>, <span class="at">k2 =</span> <span class="dv">0</span>, <span class="at">k3 =</span> <span class="dv">0</span>, <span class="at">k4 =</span> <span class="dv">0</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">500</span>),</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_rel ~ A * (1 - exp(-k * soil_0_20_P_CO2 + E)) 
  Data: D 
  Subset: Treatment != "P166" 
       AIC      BIC    logLik
  527.2096 568.2283 -244.6048

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:    0.01961179

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:   0.009131671

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept) Residual
StdDev:      6.208515 9.605261

Fixed effects:  A + k + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec 
                        Value Std.Error DF   t-value p-value
A.(Intercept)       205.19121  93.50859 18  2.194357  0.0416
A.soil_0_20_clay      0.47979   0.59388 18  0.807903  0.4297
A.soil_0_20_pH_H2O    3.14485   5.07842 18  0.619258  0.5435
A.ansum_sun          -0.03359   0.02723 18 -1.233522  0.2332
A.ansum_prec         -0.09319   0.02923 18 -3.188058  0.0051
k.(Intercept)      -148.68484 224.85418 18 -0.661250  0.5168
k.soil_0_20_clay     -0.73860   0.96610 18 -0.764517  0.4545
k.soil_0_20_pH_H2O  -11.70857  11.55623 18 -1.013183  0.3244
k.ansum_sun           0.05090   0.06324 18  0.804749  0.4315
k.ansum_prec          0.19483   0.12848 18  1.516449  0.1468
E.(Intercept)       -88.43864  71.82211 18 -1.231357  0.2340
E.soil_0_20_clay      0.11543   0.20823 18  0.554316  0.5862
E.soil_0_20_pH_H2O    1.01035   2.48731 18  0.406201  0.6894
E.ansum_sun           0.02003   0.01769 18  1.132091  0.2725
E.ansum_prec          0.04587   0.03050 18  1.503763  0.1500
 Correlation: 
                   A.(In) A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p k.(In) k.s_0_20_
A.soil_0_20_clay   -0.622                                                     
A.soil_0_20_pH_H2O -0.770  0.754                                              
A.ansum_sun        -0.925  0.427     0.582                                    
A.ansum_prec       -0.298 -0.324    -0.230     0.283                          
k.(Intercept)       0.100 -0.126    -0.084    -0.046  -0.047                  
k.soil_0_20_clay   -0.050  0.013     0.150     0.010  -0.028  -0.396          
k.soil_0_20_pH_H2O -0.239  0.339     0.371     0.180  -0.196  -0.290  0.755   
k.ansum_sun        -0.040  0.047     0.010    -0.002   0.075  -0.963  0.249   
k.ansum_prec        0.041 -0.066    -0.179    -0.047   0.182  -0.648 -0.346   
E.(Intercept)       0.121 -0.104    -0.019    -0.080  -0.141   0.933 -0.175   
E.soil_0_20_clay   -0.104  0.077     0.076     0.049   0.100  -0.754  0.690   
E.soil_0_20_pH_H2O -0.270  0.346     0.288     0.196  -0.052  -0.709  0.557   
E.ansum_sun        -0.098  0.065    -0.001     0.070   0.138  -0.931  0.143   
E.ansum_prec        0.010 -0.063    -0.175    -0.018   0.228  -0.678 -0.283   
                   k._0_20_H k.nsm_s k.nsm_p E.(In) E.s_0_20_ E._0_20_H E.nsm_s
A.soil_0_20_clay                                                               
A.soil_0_20_pH_H2O                                                             
A.ansum_sun                                                                    
A.ansum_prec                                                                   
k.(Intercept)                                                                  
k.soil_0_20_clay                                                               
k.soil_0_20_pH_H2O                                                             
k.ansum_sun         0.071                                                      
k.ansum_prec       -0.491     0.745                                            
E.(Intercept)      -0.082    -0.913  -0.801                                    
E.soil_0_20_clay    0.427     0.634   0.326  -0.739                            
E.soil_0_20_pH_H2O  0.728     0.520   0.159  -0.679  0.787                     
E.ansum_sun         0.007     0.960   0.809  -0.973  0.655     0.567           
E.ansum_prec       -0.422     0.749   0.987  -0.845  0.394     0.238     0.834 

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-2.588726770 -0.366345358  0.007224172  0.414582087  3.309922831 

Number of Observations: 64
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF   F-value p-value
A.(Intercept)          1    18 2825.9668  &lt;.0001
A.soil_0_20_clay       1    18    1.3471  0.2610
A.soil_0_20_pH_H2O     1    18    7.7358  0.0123
A.ansum_sun            1    18   10.2069  0.0050
A.ansum_prec           1    18   23.1223  0.0001
k.(Intercept)          1    18   40.8657  &lt;.0001
k.soil_0_20_clay       1    18    0.3246  0.5759
k.soil_0_20_pH_H2O     1    18    1.3052  0.2682
k.ansum_sun            1    18    8.3623  0.0097
k.ansum_prec           1    18    0.2708  0.6092
E.(Intercept)          1    18    0.7594  0.3950
E.soil_0_20_clay       1    18    0.0017  0.9673
E.soil_0_20_pH_H2O     1    18    0.0777  0.7837
E.ansum_sun            1    18    0.0492  0.8269
E.ansum_prec           1    18    2.2613  0.1500</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |  RMSE | Sigma
-------------------------------------------
557.316 | 574.588 | 598.334 | 8.515 | 9.605</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>r.square.CO2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.CO2.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.CO2.Yrel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  Ymain_rel <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> kPS <span class="sc">+</span> E)),                </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> k <span class="sc">+</span> E <span class="sc">~</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> Treatment <span class="sc">!=</span> <span class="st">"P166"</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">600</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">3</span>, <span class="at">k1 =</span> <span class="dv">0</span>, <span class="at">k2 =</span> <span class="dv">0</span>, <span class="at">k3 =</span> <span class="dv">0</span>, <span class="at">k4 =</span> <span class="dv">0</span>,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">1500</span>),</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Ymain_rel ~ A * (1 - exp(-k * kPS + E)), fixed = A + :
Iteration 2, LME step: nlminb() did not converge (code = 1). PORT message:
singular convergence (7)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_rel ~ A * (1 - exp(-k * kPS + E)) 
  Data: D 
  Subset: Treatment != "P166" 
       AIC      BIC    logLik
  527.6624 568.6812 -244.8312

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:   0.001509839

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:      3.512008

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept) Residual
StdDev:  1.712714e-76 10.75765

Fixed effects:  A + k + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec 
                       Value Std.Error DF    t-value p-value
A.(Intercept)      242.18244   99.9327 18  2.4234557  0.0261
A.soil_0_20_clay    -2.37735    1.3420 18 -1.7714418  0.0934
A.soil_0_20_pH_H2O  -0.86288    4.8523 18 -0.1778294  0.8608
A.ansum_sun          0.00453    0.0405 18  0.1117703  0.9122
A.ansum_prec        -0.06433    0.0385 18 -1.6702902  0.1122
k.(Intercept)      -35.69127  733.0589 18 -0.0486881  0.9617
k.soil_0_20_clay     9.68568   20.3692 18  0.4755054  0.6401
k.soil_0_20_pH_H2O  42.48863   74.4105 18  0.5710035  0.5751
k.ansum_sun         -0.18169    0.2507 18 -0.7248095  0.4779
k.ansum_prec        -0.19839    0.1940 18 -1.0224586  0.3201
E.(Intercept)       -8.42292    9.2740 18 -0.9082312  0.3758
E.soil_0_20_clay    -0.08828    0.1099 18 -0.8030627  0.4324
E.soil_0_20_pH_H2O   0.43207    0.5734 18  0.7534716  0.4609
E.ansum_sun          0.00311    0.0023 18  1.3377403  0.1976
E.ansum_prec         0.00063    0.0023 18  0.2784023  0.7839
 Correlation: 
                   A.(In) A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p k.(In) k.s_0_20_
A.soil_0_20_clay   -0.202                                                     
A.soil_0_20_pH_H2O -0.481  0.269                                              
A.ansum_sun        -0.727 -0.460     0.150                                    
A.ansum_prec       -0.557 -0.239    -0.252     0.542                          
k.(Intercept)      -0.048 -0.259     0.045     0.238   0.041                  
k.soil_0_20_clay    0.108  0.566     0.053    -0.519  -0.195  -0.741          
k.soil_0_20_pH_H2O  0.074  0.552    -0.003    -0.461  -0.148  -0.865  0.957   
k.ansum_sun        -0.096 -0.633    -0.092     0.542   0.237   0.253 -0.828   
k.ansum_prec       -0.104 -0.621    -0.088     0.536   0.237   0.082 -0.664   
E.(Intercept)       0.199 -0.466    -0.076     0.146  -0.053   0.826 -0.570   
E.soil_0_20_clay    0.080  0.246     0.143    -0.293  -0.149  -0.633  0.796   
E.soil_0_20_pH_H2O -0.049  0.600     0.158    -0.387  -0.153  -0.825  0.824   
E.ansum_sun        -0.308  0.230    -0.028     0.163   0.197  -0.356 -0.085   
E.ansum_prec       -0.249 -0.105    -0.124     0.286   0.372  -0.330 -0.155   
                   k._0_20_H k.nsm_s k.nsm_p E.(In) E.s_0_20_ E._0_20_H E.nsm_s
A.soil_0_20_clay                                                               
A.soil_0_20_pH_H2O                                                             
A.ansum_sun                                                                    
A.ansum_prec                                                                   
k.(Intercept)                                                                  
k.soil_0_20_clay                                                               
k.soil_0_20_pH_H2O                                                             
k.ansum_sun        -0.685                                                      
k.ansum_prec       -0.542     0.867                                            
E.(Intercept)      -0.709     0.164   0.028                                    
E.soil_0_20_clay    0.720    -0.591  -0.404  -0.459                            
E.soil_0_20_pH_H2O  0.899    -0.526  -0.414  -0.867  0.707                     
E.ansum_sun         0.118     0.385   0.339  -0.684 -0.303     0.306           
E.ansum_prec       -0.012     0.450   0.672  -0.553 -0.160     0.116     0.703 

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.90069009 -0.61991716 -0.01031473  0.51093634  4.38888646 

Number of Observations: 64
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF   F-value p-value
A.(Intercept)          1    18 3026.9437  &lt;.0001
A.soil_0_20_clay       1    18  293.8330  &lt;.0001
A.soil_0_20_pH_H2O     1    18    8.5656  0.0090
A.ansum_sun            1    18   18.4450  0.0004
A.ansum_prec           1    18    2.6270  0.1224
k.(Intercept)          1    18    2.0230  0.1720
k.soil_0_20_clay       1    18    0.0429  0.8382
k.soil_0_20_pH_H2O     1    18    0.8471  0.3695
k.ansum_sun            1    18    1.4533  0.2436
k.ansum_prec           1    18    1.0222  0.3254
E.(Intercept)          1    18    8.9965  0.0077
E.soil_0_20_clay       1    18    1.6959  0.2092
E.soil_0_20_pH_H2O     1    18    0.0518  0.8225
E.ansum_sun            1    18    2.5774  0.1258
E.ansum_prec           1    18    0.0775  0.7839</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |   RMSE |  Sigma
---------------------------------------------
548.486 | 565.758 | 589.504 | 10.496 | 10.758</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>r.square.CO2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.CO2.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.CO2.Ynorm <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  Ymain_norm <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> kPS <span class="sc">+</span> E)),                </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> k <span class="sc">+</span> E <span class="sc">~</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> Treatment <span class="sc">!=</span> <span class="st">"P166"</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">6</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">3</span>, <span class="at">k1 =</span> <span class="dv">0</span>, <span class="at">k2 =</span> <span class="dv">0</span>, <span class="at">k3 =</span> <span class="dv">0</span>, <span class="at">k4 =</span> <span class="dv">0</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">1500</span>),</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_rel ~ A * (1 - exp(-k * kPS + E)) 
  Data: D 
  Subset: Treatment != "P166" 
       AIC      BIC    logLik
  527.6624 568.6812 -244.8312

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:   0.001509839

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:      3.512008

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept) Residual
StdDev:  1.712714e-76 10.75765

Fixed effects:  A + k + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec 
                       Value Std.Error DF    t-value p-value
A.(Intercept)      242.18244   99.9327 18  2.4234557  0.0261
A.soil_0_20_clay    -2.37735    1.3420 18 -1.7714418  0.0934
A.soil_0_20_pH_H2O  -0.86288    4.8523 18 -0.1778294  0.8608
A.ansum_sun          0.00453    0.0405 18  0.1117703  0.9122
A.ansum_prec        -0.06433    0.0385 18 -1.6702902  0.1122
k.(Intercept)      -35.69127  733.0589 18 -0.0486881  0.9617
k.soil_0_20_clay     9.68568   20.3692 18  0.4755054  0.6401
k.soil_0_20_pH_H2O  42.48863   74.4105 18  0.5710035  0.5751
k.ansum_sun         -0.18169    0.2507 18 -0.7248095  0.4779
k.ansum_prec        -0.19839    0.1940 18 -1.0224586  0.3201
E.(Intercept)       -8.42292    9.2740 18 -0.9082312  0.3758
E.soil_0_20_clay    -0.08828    0.1099 18 -0.8030627  0.4324
E.soil_0_20_pH_H2O   0.43207    0.5734 18  0.7534716  0.4609
E.ansum_sun          0.00311    0.0023 18  1.3377403  0.1976
E.ansum_prec         0.00063    0.0023 18  0.2784023  0.7839
 Correlation: 
                   A.(In) A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p k.(In) k.s_0_20_
A.soil_0_20_clay   -0.202                                                     
A.soil_0_20_pH_H2O -0.481  0.269                                              
A.ansum_sun        -0.727 -0.460     0.150                                    
A.ansum_prec       -0.557 -0.239    -0.252     0.542                          
k.(Intercept)      -0.048 -0.259     0.045     0.238   0.041                  
k.soil_0_20_clay    0.108  0.566     0.053    -0.519  -0.195  -0.741          
k.soil_0_20_pH_H2O  0.074  0.552    -0.003    -0.461  -0.148  -0.865  0.957   
k.ansum_sun        -0.096 -0.633    -0.092     0.542   0.237   0.253 -0.828   
k.ansum_prec       -0.104 -0.621    -0.088     0.536   0.237   0.082 -0.664   
E.(Intercept)       0.199 -0.466    -0.076     0.146  -0.053   0.826 -0.570   
E.soil_0_20_clay    0.080  0.246     0.143    -0.293  -0.149  -0.633  0.796   
E.soil_0_20_pH_H2O -0.049  0.600     0.158    -0.387  -0.153  -0.825  0.824   
E.ansum_sun        -0.308  0.230    -0.028     0.163   0.197  -0.356 -0.085   
E.ansum_prec       -0.249 -0.105    -0.124     0.286   0.372  -0.330 -0.155   
                   k._0_20_H k.nsm_s k.nsm_p E.(In) E.s_0_20_ E._0_20_H E.nsm_s
A.soil_0_20_clay                                                               
A.soil_0_20_pH_H2O                                                             
A.ansum_sun                                                                    
A.ansum_prec                                                                   
k.(Intercept)                                                                  
k.soil_0_20_clay                                                               
k.soil_0_20_pH_H2O                                                             
k.ansum_sun        -0.685                                                      
k.ansum_prec       -0.542     0.867                                            
E.(Intercept)      -0.709     0.164   0.028                                    
E.soil_0_20_clay    0.720    -0.591  -0.404  -0.459                            
E.soil_0_20_pH_H2O  0.899    -0.526  -0.414  -0.867  0.707                     
E.ansum_sun         0.118     0.385   0.339  -0.684 -0.303     0.306           
E.ansum_prec       -0.012     0.450   0.672  -0.553 -0.160     0.116     0.703 

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.90069009 -0.61991716 -0.01031473  0.51093634  4.38888646 

Number of Observations: 64
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF   F-value p-value
A.(Intercept)          1    18 3026.9437  &lt;.0001
A.soil_0_20_clay       1    18  293.8330  &lt;.0001
A.soil_0_20_pH_H2O     1    18    8.5656  0.0090
A.ansum_sun            1    18   18.4450  0.0004
A.ansum_prec           1    18    2.6270  0.1224
k.(Intercept)          1    18    2.0230  0.1720
k.soil_0_20_clay       1    18    0.0429  0.8382
k.soil_0_20_pH_H2O     1    18    0.8471  0.3695
k.ansum_sun            1    18    1.4533  0.2436
k.ansum_prec           1    18    1.0222  0.3254
E.(Intercept)          1    18    8.9965  0.0077
E.soil_0_20_clay       1    18    1.6959  0.2092
E.soil_0_20_pH_H2O     1    18    0.0518  0.8225
E.ansum_sun            1    18    2.5774  0.1258
E.ansum_prec           1    18    0.0775  0.7839</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |   RMSE |  Sigma
---------------------------------------------
548.486 | 565.758 | 589.504 | 10.496 | 10.758</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>r.square.CO2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.CO2.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.CO2.Yrel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  Ymain_norm <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> soil_0_20_P_CO2 <span class="sc">+</span> E)),                </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> k <span class="sc">+</span> E <span class="sc">~</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> Treatment <span class="sc">!=</span> <span class="st">"P166"</span>,</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">1100</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fl">0.05</span>, <span class="at">k1 =</span> <span class="dv">0</span>, <span class="at">k2 =</span> <span class="dv">0</span>, <span class="at">k3 =</span> <span class="dv">0</span>, <span class="at">k4 =</span> <span class="dv">0</span>,</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">500</span>),</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Ymain_norm ~ A * (1 - exp(-k * soil_0_20_P_CO2 + :
Iteration 1, LME step: nlminb() did not converge (code = 1). PORT message:
false convergence (8)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Ymain_norm ~ A * (1 - exp(-k * soil_0_20_P_CO2 + :
Non-finite log-likelihood replaced by maximally negative value</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_norm ~ A * (1 - exp(-k * soil_0_20_P_CO2 + E)) 
  Data: D 
  Subset: Treatment != "P166" 
        AIC       BIC   logLik
  -65.46004 -24.44126 51.73002

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:  3.401442e-07

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:  1.250369e-05

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept)  Residual
StdDev:     0.0412576 0.1009889

Fixed effects:  A + k + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec 
                       Value Std.Error DF    t-value p-value
A.(Intercept)        0.85935   0.92707 18  0.9269461  0.3662
A.soil_0_20_clay     0.00520   0.00603 18  0.8617388  0.4002
A.soil_0_20_pH_H2O   0.04542   0.05071 18  0.8955985  0.3823
A.ansum_sun          0.00019   0.00027 18  0.7267131  0.4767
A.ansum_prec        -0.00076   0.00028 18 -2.7486077  0.0132
k.(Intercept)      -44.77553 170.38514 18 -0.2627901  0.7957
k.soil_0_20_clay    -0.91043   0.88586 18 -1.0277351  0.3177
k.soil_0_20_pH_H2O -13.63803  11.56905 18 -1.1788377  0.2538
k.ansum_sun          0.02657   0.04635 18  0.5733714  0.5735
k.ansum_prec         0.14919   0.09961 18  1.4977573  0.1515
E.(Intercept)      -48.51924  51.23631 18 -0.9469698  0.3562
E.soil_0_20_clay     0.00818   0.17746 18  0.0460744  0.9638
E.soil_0_20_pH_H2O  -0.27523   2.31329 18 -0.1189757  0.9066
E.ansum_sun          0.01173   0.01243 18  0.9439714  0.3577
E.ansum_prec         0.03234   0.02239 18  1.4445403  0.1658
 Correlation: 
                   A.(In) A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p k.(In) k.s_0_20_
A.soil_0_20_clay   -0.672                                                     
A.soil_0_20_pH_H2O -0.793  0.777                                              
A.ansum_sun        -0.930  0.496     0.624                                    
A.ansum_prec       -0.233 -0.335    -0.263     0.216                          
k.(Intercept)       0.131 -0.174    -0.149    -0.065  -0.009                  
k.soil_0_20_clay   -0.160  0.138     0.257     0.120  -0.073  -0.472          
k.soil_0_20_pH_H2O -0.344  0.410     0.443     0.299  -0.206  -0.398  0.842   
k.ansum_sun        -0.011  0.036     0.017    -0.042   0.053  -0.931  0.217   
k.ansum_prec        0.147 -0.152    -0.257    -0.165   0.205  -0.470 -0.471   
E.(Intercept)       0.186 -0.171    -0.100    -0.123  -0.144   0.918 -0.266   
E.soil_0_20_clay   -0.212  0.210     0.214     0.136   0.051  -0.717  0.787   
E.soil_0_20_pH_H2O -0.388  0.441     0.416     0.311  -0.086  -0.659  0.710   
E.ansum_sun        -0.128  0.091     0.041     0.083   0.150  -0.899  0.160   
E.ansum_prec        0.067 -0.112    -0.222    -0.090   0.271  -0.545 -0.363   
                   k._0_20_H k.nsm_s k.nsm_p E.(In) E.s_0_20_ E._0_20_H E.nsm_s
A.soil_0_20_clay                                                               
A.soil_0_20_pH_H2O                                                             
A.ansum_sun                                                                    
A.ansum_prec                                                                   
k.(Intercept)                                                                  
k.soil_0_20_clay                                                               
k.soil_0_20_pH_H2O                                                             
k.ansum_sun         0.078                                                      
k.ansum_prec       -0.582     0.667                                            
E.(Intercept)      -0.225    -0.867  -0.628                                    
E.soil_0_20_clay    0.623     0.493   0.039  -0.694                            
E.soil_0_20_pH_H2O  0.854     0.369  -0.157  -0.634  0.825                     
E.ansum_sun         0.081     0.939   0.692  -0.958  0.541     0.463           
E.ansum_prec       -0.458     0.686   0.972  -0.735  0.169    -0.009     0.764 

Standardized Within-Group Residuals:
          Min            Q1           Med            Q3           Max 
-2.9466374325 -0.3121491790  0.0006899933  0.4620155338  3.5904220314 

Number of Observations: 64
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF  F-value p-value
A.(Intercept)          1    18 3935.945  &lt;.0001
A.soil_0_20_clay       1    18    3.609  0.0736
A.soil_0_20_pH_H2O     1    18    1.432  0.2470
A.ansum_sun            1    18   38.638  &lt;.0001
A.ansum_prec           1    18   26.333  0.0001
k.(Intercept)          1    18   42.277  &lt;.0001
k.soil_0_20_clay       1    18    0.014  0.9061
k.soil_0_20_pH_H2O     1    18    0.465  0.5040
k.ansum_sun            1    18   13.685  0.0016
k.ansum_prec           1    18    0.433  0.5187
E.(Intercept)          1    18    1.410  0.2505
E.soil_0_20_clay       1    18    0.033  0.8585
E.soil_0_20_pH_H2O     1    18    0.012  0.9142
E.ansum_sun            1    18    0.061  0.8073
E.ansum_prec           1    18    2.087  0.1658</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.CO2.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC    |   AICc |    BIC |  RMSE | Sigma
----------------------------------------
14.391 | 31.663 | 55.410 | 0.095 | 0.101</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>r.square.CO2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.CO2.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>With the covariate and random effect used as by Juliane Hirte we obtain <span class="math inline">\(R^2=\)</span> 0.9999989, I don’t know how to interpret that, I fear that the model is overfitting data.</p>
</section>
<section id="how-do-grud-measurements-of-c_p-relate-to-the-soil-properties-c_textorg-content-clay-content-silt-content-and-ph" class="level3">
<h3 class="anchored" data-anchor-id="how-do-grud-measurements-of-c_p-relate-to-the-soil-properties-c_textorg-content-clay-content-silt-content-and-ph">How do GRUD-measurements of <span class="math inline">\(C_P\)</span> relate to the soil properties <span class="math inline">\(C_\text{org}\)</span>-content, clay-content, silt-content and pH?</h3>
<ul>
<li>Hypothesis II: Given the known capacity of clay and silt compounds to adsorb orthophosphate a positive correlation between <span class="math inline">\(C_P\)</span> (for both <span class="math inline">\(CO_2\)</span> and AAE10) and silt- and clay-content. <span class="math inline">\(C_\text{org}\)</span> has been reported to positively influence the capacity of Phosphorus as well, it is plausible it also shows a positive correlation with <span class="math inline">\(C_P\)</span>. AAE10 also deploys <span class="math inline">\(Na_4EDTA\)</span> which is easily captured by <span class="math inline">\(Mg^{2+}\)</span> and <span class="math inline">\(Ca^{2+}\)</span>, therefore it is officially by GRUD advised against being used in soils with <span class="math inline">\(\text{pH}&gt;6.8\)</span>, therefore <span class="math inline">\(C_P\)</span>-AAE10 will presumably be negatively correlated to pH.</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                  Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
soil_0_20_clay   0.01031 0.01031     1 39.033  0.3482 0.55854  
soil_0_20_pH_H2O 0.03990 0.03990     1 36.270  1.3477 0.25326  
soil_0_20_Corg   0.03609 0.03609     1 30.050  1.2192 0.27829  
soil_0_20_silt   0.01225 0.01225     1 36.371  0.4139 0.52405  
Fed              2.24907 2.24907     1  1.237 75.9765 0.04625 *
Ald              0.37933 0.37933     1  1.859 12.8143 0.07780 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fit.soil.CO2 <span class="sc">|&gt;</span> <span class="fu">r.squaredGLMM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           R2m       R2c
[1,] 0.3615715 0.9946094</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.AAE10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                  Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
soil_0_20_clay   0.02689 0.02689     1 33.372  1.1447   0.29233    
soil_0_20_pH_H2O 0.00022 0.00022     1 36.721  0.0095   0.92271    
soil_0_20_Corg   0.55693 0.55693     1 38.895 23.7089 1.902e-05 ***
soil_0_20_silt   0.09825 0.09825     1 34.019  4.1824   0.04864 *  
Fed              0.42176 0.42176     1  1.848 17.9545   0.05892 .  
Ald              0.70761 0.70761     1  2.551 30.1233   0.01795 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>fit.soil.AAE10 <span class="sc">|&gt;</span> <span class="fu">r.squaredGLMM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           R2m       R2c
[1,] 0.4938704 0.9965101</code></pre>
</div>
</div></div>
</section>
<section id="can-the-inclusion-of-the-net-release-kinetic-of-orthophosphate-improve-the-model-power-of-predicting-relative-yield-p-uptake-and-p-balance" class="level3">
<h3 class="anchored" data-anchor-id="can-the-inclusion-of-the-net-release-kinetic-of-orthophosphate-improve-the-model-power-of-predicting-relative-yield-p-uptake-and-p-balance">Can the Inclusion of the net-release-kinetic of Orthophosphate improve the model power of predicting relative Yield, P-Uptake and P-Balance?</h3>
<ul>
<li>Hypothesis III: Given the comparably low solubility of <span class="math inline">\(PO_4^{3-}\)</span> in the water-soil interface, most P is transported to the rhizosphere via diffusion. As a consequence the intensity of <span class="math inline">\(PO_4^{3-}\)</span> might not adequately account for the P-uptake in the harvested plant. Since the diffusion process is in its velocity a kinetic and in its finally reached intensity a thermodynamic process, the inclusion of kinetic parameters might well improve the performance.</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.PS.Yrel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  Ymain_rel <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> PS <span class="sc">+</span> E)),                </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> r <span class="sc">+</span> E <span class="sc">~</span> k <span class="sc">+</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">220</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>, <span class="at">A5 =</span> <span class="dv">0</span>,</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="dv">1</span>, <span class="at">r1 =</span> <span class="dv">0</span>, <span class="at">r2 =</span> <span class="dv">0</span>, <span class="at">r3 =</span> <span class="dv">0</span>, <span class="at">r4 =</span> <span class="dv">0</span>, <span class="at">r5 =</span> <span class="dv">0</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span>, <span class="at">E5 =</span> <span class="dv">0</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">500</span>),</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.PS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_rel ~ A * (1 - exp(-r * PS + E)) 
  Data: D 
      AIC      BIC   logLik
  756.704 812.6565 -356.352

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:   0.001434366

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:      4.135705

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept) Residual
StdDev:  2.098085e-05 10.26954

Fixed effects:  A + r + E ~ k + soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun +      ansum_prec 
                       Value Std.Error DF    t-value p-value
A.(Intercept)       159.3520   91.1962 45  1.7473529  0.0874
A.k                 -25.4193   30.3021 45 -0.8388642  0.4060
A.soil_0_20_clay      0.3554    0.4095 45  0.8678259  0.3901
A.soil_0_20_pH_H2O    4.9194    4.3133 45  1.1405232  0.2601
A.ansum_sun          -0.0257    0.0269 45 -0.9524325  0.3460
A.ansum_prec         -0.0623    0.0288 45 -2.1634395  0.0359
r.(Intercept)      2284.8408 1418.9108 45  1.6102779  0.1143
r.k                 334.2789  237.5217 45  1.4073615  0.1662
r.soil_0_20_clay     -3.5798    2.4890 45 -1.4382872  0.1573
r.soil_0_20_pH_H2O -100.7852   62.7013 45 -1.6073858  0.1150
r.ansum_sun          -0.5390    0.3332 45 -1.6176110  0.1127
r.ansum_prec         -0.5023    0.3122 45 -1.6088164  0.1147
E.(Intercept)        63.8366   53.9968 45  1.1822310  0.2433
E.k                  22.9236   12.6296 45  1.8150670  0.0762
E.soil_0_20_clay      0.0488    0.0483 45  1.0101435  0.3178
E.soil_0_20_pH_H2O   -1.1850    1.4792 45 -0.8010865  0.4273
E.ansum_sun          -0.0174    0.0144 45 -1.2077238  0.2335
E.ansum_prec         -0.0327    0.0228 45 -1.4328213  0.1588
 Correlation: 
                   A.(In) A.k    A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p r.(In)
A.k                 0.088                                                  
A.soil_0_20_clay   -0.504  0.082                                           
A.soil_0_20_pH_H2O -0.747 -0.263  0.589                                    
A.ansum_sun        -0.931 -0.071  0.340     0.565                          
A.ansum_prec       -0.623 -0.130 -0.077     0.165     0.539                
r.(Intercept)       0.326 -0.153 -0.221    -0.392    -0.249  -0.108        
r.k                 0.164 -0.283 -0.081    -0.174    -0.128  -0.052   0.807
r.soil_0_20_clay   -0.221  0.216  0.118     0.266     0.165   0.076  -0.935
r.soil_0_20_pH_H2O -0.325  0.173  0.223     0.380     0.251   0.108  -0.996
r.ansum_sun        -0.333  0.140  0.226     0.404     0.254   0.111  -0.999
r.ansum_prec       -0.310  0.161  0.206     0.378     0.236   0.099  -0.997
E.(Intercept)       0.336 -0.151 -0.213    -0.385    -0.260  -0.129   0.976
E.k                 0.235 -0.071 -0.120    -0.322    -0.171  -0.081   0.832
E.soil_0_20_clay    0.089 -0.084  0.010    -0.122    -0.076  -0.035   0.551
E.soil_0_20_pH_H2O -0.327  0.025  0.193     0.390     0.248   0.145  -0.779
E.ansum_sun        -0.334  0.165  0.212     0.376     0.264   0.124  -0.979
E.ansum_prec       -0.299  0.180  0.189     0.351     0.227   0.108  -0.985
                   r.k    r.s_0_20_ r._0_20_H r.nsm_s r.nsm_p E.(In) E.k   
A.k                                                                        
A.soil_0_20_clay                                                           
A.soil_0_20_pH_H2O                                                         
A.ansum_sun                                                                
A.ansum_prec                                                               
r.(Intercept)                                                              
r.k                                                                        
r.soil_0_20_clay   -0.943                                                  
r.soil_0_20_pH_H2O -0.836  0.942                                           
r.ansum_sun        -0.778  0.919     0.990                                 
r.ansum_prec       -0.828  0.950     0.990     0.994                       
E.(Intercept)       0.799 -0.916    -0.979    -0.972  -0.969               
E.k                 0.888 -0.891    -0.845    -0.815  -0.845   0.809       
E.soil_0_20_clay    0.334 -0.413    -0.524    -0.566  -0.560   0.491  0.335
E.soil_0_20_pH_H2O -0.603  0.703     0.798     0.774   0.751  -0.867 -0.706
E.ansum_sun        -0.795  0.913     0.979     0.977   0.973  -0.995 -0.787
E.ansum_prec       -0.855  0.955     0.982     0.979   0.992  -0.972 -0.850
                   E.s_0_20_ E._0_20_H E.nsm_s
A.k                                           
A.soil_0_20_clay                              
A.soil_0_20_pH_H2O                            
A.ansum_sun                                   
A.ansum_prec                                  
r.(Intercept)                                 
r.k                                           
r.soil_0_20_clay                              
r.soil_0_20_pH_H2O                            
r.ansum_sun                                   
r.ansum_prec                                  
E.(Intercept)                                 
E.k                                           
E.soil_0_20_clay                              
E.soil_0_20_pH_H2O -0.210                     
E.ansum_sun        -0.538     0.824           
E.ansum_prec       -0.572     0.746     0.977 

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-3.62053951 -0.40518895  0.02478129  0.53746770  4.15921453 

Number of Observations: 94
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.PS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF   F-value p-value
A.(Intercept)          1    45 2488.4068  &lt;.0001
A.k                    1    45    2.3144  0.1352
A.soil_0_20_clay       1    45    2.2731  0.1386
A.soil_0_20_pH_H2O     1    45   29.8949  &lt;.0001
A.ansum_sun            1    45    6.5752  0.0137
A.ansum_prec           1    45    2.6606  0.1098
r.(Intercept)          1    45   21.0005  &lt;.0001
r.k                    1    45    1.9181  0.1729
r.soil_0_20_clay       1    45    0.1437  0.7064
r.soil_0_20_pH_H2O     1    45    6.0053  0.0182
r.ansum_sun            1    45    0.1454  0.7048
r.ansum_prec           1    45    9.4644  0.0036
E.(Intercept)          1    45   26.4308  &lt;.0001
E.k                    1    45    0.9943  0.3240
E.soil_0_20_clay       1    45    0.0699  0.7926
E.soil_0_20_pH_H2O     1    45    0.0668  0.7973
E.ansum_sun            1    45    0.8021  0.3752
E.ansum_prec           1    45    2.0530  0.1588</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.PS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |  RMSE |  Sigma
--------------------------------------------
765.695 | 779.948 | 821.647 | 9.989 | 10.270</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>r.square.PS <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.PS.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>fit.mitscherlich.kPS.Yrel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  Ymain_rel <span class="sc">~</span> A <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> PS <span class="sc">+</span> E)),                </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> A <span class="sc">+</span> E <span class="sc">~</span> soil_0_20_clay <span class="sc">+</span> soil_0_20_pH_H2O <span class="sc">+</span> ansum_sun <span class="sc">+</span> ansum_prec,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> A <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> year<span class="sc">/</span>Site<span class="sc">/</span>block,</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> D,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">c</span>(</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">220</span>, <span class="at">A1 =</span> <span class="dv">0</span>, <span class="at">A2 =</span> <span class="dv">0</span>, <span class="at">A3 =</span> <span class="dv">0</span>, <span class="at">A4 =</span> <span class="dv">0</span>,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">E =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">E1 =</span> <span class="dv">0</span>, <span class="at">E2 =</span> <span class="dv">0</span>, <span class="at">E3 =</span> <span class="dv">0</span>, <span class="at">E4 =</span> <span class="dv">0</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">500</span>),</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mitscherlich.kPS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: Ymain_rel ~ A * (1 - exp(-k * PS + E)) 
  Data: D 
       AIC      BIC    logLik
  757.7736 793.3798 -364.8868

Random effects:
 Formula: A ~ 1 | year
        A.(Intercept)
StdDev:    0.00112278

 Formula: A ~ 1 | Site %in% year
        A.(Intercept)
StdDev:   0.008239412

 Formula: A ~ 1 | block %in% Site %in% year
        A.(Intercept) Residual
StdDev:   2.69498e-05 11.73805

Fixed effects:  A + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec 
                       Value Std.Error DF   t-value p-value
A.(Intercept)      2690.1350  985.2790 53  2.730328  0.0086
A.soil_0_20_clay      5.8621    3.0618 53  1.914606  0.0609
A.soil_0_20_pH_H2O  -75.2347   37.4744 53 -2.007628  0.0498
A.ansum_sun          -0.7671    0.2684 53 -2.858049  0.0061
A.ansum_prec         -0.6208    0.2478 53 -2.505009  0.0154
E.(Intercept)         0.6989    0.5030 53  1.389531  0.1705
E.soil_0_20_clay      0.0069    0.0040 53  1.715683  0.0921
E.soil_0_20_pH_H2O   -0.0352    0.0289 53 -1.219687  0.2280
E.ansum_sun          -0.0004    0.0002 53 -2.210431  0.0314
E.ansum_prec         -0.0002    0.0002 53 -1.427522  0.1593
 Correlation: 
                   A.(In) A.s_0_20_ A._0_20_H A.nsm_s A.nsm_p E.(In) E.s_0_20_
A.soil_0_20_clay   -0.024                                                     
A.soil_0_20_pH_H2O -0.857  0.189                                              
A.ansum_sun        -0.963 -0.098     0.725                                    
A.ansum_prec       -0.873 -0.184     0.620     0.829                          
E.(Intercept)       0.197 -0.757    -0.214    -0.136  -0.092                  
E.soil_0_20_clay   -0.791  0.449     0.717     0.719   0.574  -0.393          
E.soil_0_20_pH_H2O  0.014  0.643     0.399    -0.184  -0.246  -0.593  0.197   
E.ansum_sun         0.266  0.555    -0.317    -0.204  -0.330  -0.800 -0.088   
E.ansum_prec       -0.040  0.243    -0.140    -0.016   0.345  -0.562 -0.030   
                   E._0_20_H E.nsm_s
A.soil_0_20_clay                    
A.soil_0_20_pH_H2O                  
A.ansum_sun                         
A.ansum_prec                        
E.(Intercept)                       
E.soil_0_20_clay                    
E.soil_0_20_pH_H2O                  
E.ansum_sun         0.329           
E.ansum_prec       -0.022     0.451 

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.72142747 -0.51960209 -0.04192907  0.54601061  4.70468829 

Number of Observations: 94
Number of Groups: 
                     year            Site %in% year block %in% Site %in% year 
                        2                         8                        32 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.mitscherlich.kPS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   numDF denDF   F-value p-value
A.(Intercept)          1    53 14865.096  &lt;.0001
A.soil_0_20_clay       1    53   474.026  &lt;.0001
A.soil_0_20_pH_H2O     1    53     0.724  0.3986
A.ansum_sun            1    53   286.635  &lt;.0001
A.ansum_prec           1    53   305.097  &lt;.0001
E.(Intercept)          1    53     1.553  0.2182
E.soil_0_20_clay       1    53     3.035  0.0873
E.soil_0_20_pH_H2O     1    53     0.401  0.5295
E.ansum_sun            1    53     3.082  0.0850
E.ansum_prec           1    53     2.038  0.1593</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit.mitscherlich.kPS.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |   RMSE |  Sigma
---------------------------------------------
804.491 | 809.807 | 840.097 | 11.738 | 11.738</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>r.square.kPS <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(fit.mitscherlich.kPS.Yrel)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((D<span class="sc">$</span>Ymain_rel<span class="sc">-</span><span class="fu">mean</span>(D<span class="sc">$</span>Ymain_rel,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>With the covariate and random effect used as by Juliane Hirte we obtain <span class="math inline">\(R^2=\)</span> 0.9823775, I don’t know how to interpret that, I fear that the model is overfitting data, the same might be true for the model that used <span class="math inline">\(k\times PS\)</span> as a predictor with <span class="math inline">\(R^2=\)</span> 0.975664.</p>
<p>I also tried more conservative models, where I log-transformed the concentrations and PS, also I was more cautious with random effects. This resulted in coefficients that were not as straight-forward as the mitscherlich coefficients to interpret.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># relative Yield</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.kin.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
           Sum Sq Mean Sq NumDF  DenDF F value   Pr(&gt;F)   
k         10361.3 10361.3     1 243.49  7.0248 0.008566 **
log(PS)    9132.5  9132.5     1 243.72  6.1918 0.013504 * 
k:log(PS) 12026.0 12026.0     1 243.87  8.1535 0.004668 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.kin.Yrel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: Ymain_rel ~ k * log(PS) + (1 | year) + (1 | Site) + (1 | Site:block)
   Data: D

REML criterion at convergence: 2566.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5325 -0.3160 -0.0669  0.3200  3.8807 

Random effects:
 Groups     Name        Variance Std.Dev.
 Site:block (Intercept)    0.0    0.00   
 year       (Intercept)  840.6   28.99   
 Site       (Intercept)  254.1   15.94   
 Residual               1474.9   38.41   
Number of obs: 254, groups:  Site:block, 20; year, 6; Site, 5

Fixed effects:
            Estimate Std. Error     df t value Pr(&gt;|t|)   
(Intercept)    56.38      28.72  90.88   1.963  0.05268 . 
k             377.50     142.43 243.49   2.650  0.00857 **
log(PS)       -27.49      11.05 243.72  -2.488  0.01350 * 
k:log(PS)     171.51      60.06 243.87   2.855  0.00467 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
          (Intr) k      lg(PS)
k         -0.830              
log(PS)    0.816 -0.871       
k:log(PS) -0.790  0.934 -0.955
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>fit.kin.Yrel <span class="sc">|&gt;</span> <span class="fu">r.squaredGLMM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            R2m       R2c
[1,] 0.02182182 0.4385486</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P-Uptake</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.kin.Pexport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
          Sum Sq Mean Sq NumDF  DenDF F value Pr(&gt;F)
k         35.305  35.305     1 247.74  0.5252 0.4693
log(PS)   39.586  39.586     1 248.15  0.5889 0.4436
k:log(PS) 53.624  53.624     1 248.29  0.7978 0.3726</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.kin.Pexport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: annual_P_uptake ~ k * log(PS) + (1 | year) + (1 | Site) + (1 |  
    Site:block)
   Data: D

REML criterion at convergence: 1835.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1240 -0.4693 -0.0175  0.3715  4.7721 

Random effects:
 Groups     Name        Variance Std.Dev.
 Site:block (Intercept)  0.00    0.000   
 year       (Intercept) 73.71    8.585   
 Site       (Intercept) 37.56    6.129   
 Residual               67.22    8.199   
Number of obs: 259, groups:  Site:block, 16; year, 6; Site, 4

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   29.599      7.412  44.304   3.993 0.000242 ***
k             22.622     31.215 247.742   0.725 0.469307    
log(PS)        1.954      2.547 248.145   0.767 0.443570    
k:log(PS)     11.928     13.354 248.286   0.893 0.372632    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
          (Intr) k      lg(PS)
k         -0.746              
log(PS)    0.728 -0.898       
k:log(PS) -0.709  0.945 -0.965
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>fit.kin.Pexport <span class="sc">|&gt;</span> <span class="fu">r.squaredGLMM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            R2m       R2c
[1,] 0.06433359 0.6476313</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.kin.Pbalance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
           Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
k          411.53  411.53     1 228.31  2.6679    0.1038    
log(PS)   2451.67 2451.67     1 236.98 15.8941 8.925e-05 ***
k:log(PS)  335.79  335.79     1 232.66  2.1769    0.1414    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.kin.Pbalance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: annual_P_balance ~ k * log(PS) + (1 | year) + (1 | Site) + (1 |  
    Site:block)
   Data: D

REML criterion at convergence: 2172.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.2416 -0.5978  0.0314  0.5493  2.8712 

Random effects:
 Groups     Name        Variance Std.Dev.
 Site:block (Intercept)  20.33    4.508  
 year       (Intercept)  59.32    7.702  
 Site       (Intercept)  23.97    4.896  
 Residual               154.25   12.420  
Number of obs: 274, groups:  Site:block, 16; year, 6; Site, 4

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   43.833     10.402 146.531   4.214 4.37e-05 ***
k             84.993     52.035 228.313   1.633    0.104    
log(PS)       16.947      4.251 236.979   3.987 8.92e-05 ***
k:log(PS)     33.029     22.386 232.660   1.475    0.141    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
          (Intr) k      lg(PS)
k         -0.887              
log(PS)    0.858 -0.901       
k:log(PS) -0.843  0.944 -0.971</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>fit.kin.Pbalance <span class="sc">|&gt;</span> <span class="fu">r.squaredGLMM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           R2m       R2c
[1,] 0.5718185 0.7438699</code></pre>
</div>
</div></div>
</section>
<section id="are-the-kinetic-coefficients-k-and-psk-can-be-interpreted-as-the-relative-speed-of-desorption-ps-is-the-equilibrium-concentration-of-po_43--of-the-observed-desorption-in-the-dried-fine-earth-water-suspension-120-by-weight-related-to-soil-properties" class="level3">
<h3 class="anchored" data-anchor-id="are-the-kinetic-coefficients-k-and-psk-can-be-interpreted-as-the-relative-speed-of-desorption-ps-is-the-equilibrium-concentration-of-po_43--of-the-observed-desorption-in-the-dried-fine-earth-water-suspension-120-by-weight-related-to-soil-properties">Are the kinetic coefficients <span class="math inline">\(k\)</span> and <span class="math inline">\(PS\)</span>(<span class="math inline">\(k\)</span> can be interpreted as the relative speed of desorption, <span class="math inline">\(PS\)</span> is the equilibrium concentration of <span class="math inline">\(PO_4^{3-}\)</span> of the observed desorption in the dried fine earth-water suspension 1:20 by weight) related to soil properties?</h3>
<ul>
<li>Hypothesis IV: Clay particles as well as organic compounds with negative surface charges provide surfaces for P-sorption, especially their structure, but in general their respective concentration in a soil can be expected to significantly influence the kinetic and thermodynamic of the P-desorption reaction. The <span class="math inline">\(pH\)</span> dictates the form of orthophosphate, with <span class="math inline">\(pH&lt;6.5\)</span>, the predominant form will be <span class="math inline">\(H_2PO_4^-\)</span>, this should reduce electrical interactions and increase the movement- and therefore diffusion-speed.</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.PS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                 Sum Sq Mean Sq NumDF  DenDF  F value    Pr(&gt;F)    
soil_0_20_clay   0.0017  0.0017     1 39.832   0.0467   0.82993    
soil_0_20_pH_H2O 0.0007  0.0007     1 38.367   0.0202   0.88762    
soil_0_20_Corg   0.1525  0.1525     1 32.811   4.2087   0.04827 *  
soil_0_20_silt   0.0000  0.0000     1 40.483   0.0002   0.98792    
Fed              4.9643  4.9643     1 36.018 137.0324 7.807e-14 ***
Ald              1.8349  1.8349     1 37.406  50.6502 1.865e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.soil.PS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = log(PS) ~ soil_0_20_clay + soil_0_20_pH_H2O + 
    soil_0_20_Corg + soil_0_20_silt + Fed + Ald + (1 | year) + 
    (1 | Site) + (1 | Site:block) + (1 | Site:Treatment), data = D)

Linear Hypotheses:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) == 0      21.4438130  2.6915204   7.967   &lt;0.001 ***
soil_0_20_clay == 0   -0.0064543  0.0298519  -0.216    1.000    
soil_0_20_pH_H2O == 0 -0.0179677  0.1262969  -0.142    1.000    
soil_0_20_Corg == 0    0.6116152  0.2981307   2.052    0.201    
soil_0_20_silt == 0   -0.0003927  0.0257799  -0.015    1.000    
Fed == 0              -1.0676543  0.0912051 -11.706   &lt;0.001 ***
Ald == 0              -8.7060240  1.2232898  -7.117   &lt;0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(glht(fit.PS))</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazit: PS wird von treatment stark beeinfluss, k eher nicht (dafür von site)</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                    Sum Sq   Mean Sq NumDF  DenDF F value   Pr(&gt;F)   
soil_0_20_clay   0.0126524 0.0126524     1 32.124 11.0892 0.002190 **
soil_0_20_pH_H2O 0.0010892 0.0010892     1 38.528  0.9546 0.334637   
soil_0_20_Corg   0.0091554 0.0091554     1 31.652  8.0242 0.007963 **
soil_0_20_silt   0.0012806 0.0012806     1 13.842  1.1224 0.307539   
Fed              0.0001832 0.0001832     1  2.350  0.1606 0.722155   
Ald              0.0002817 0.0002817     1  2.262  0.2469 0.663422   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.soil.k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RET$pfunction("adjusted", ...): Completion with error &gt; abseps</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = k ~ soil_0_20_clay + soil_0_20_pH_H2O + soil_0_20_Corg + 
    soil_0_20_silt + Fed + Ald + (1 | year) + (1 | Site) + (1 | 
    Site:block) + (1 | Site:Treatment), data = D)

Linear Hypotheses:
                       Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) == 0       0.454128   0.358773   1.266  0.70498   
soil_0_20_clay == 0   -0.016164   0.004854  -3.330  0.00511 **
soil_0_20_pH_H2O == 0 -0.020791   0.021279  -0.977  0.87850   
soil_0_20_Corg == 0    0.136661   0.048244   2.833  0.02853 * 
soil_0_20_silt == 0    0.004076   0.003848   1.059  0.83543   
Fed == 0               0.005157   0.012867   0.401  0.99838   
Ald == 0              -0.072344   0.145598  -0.497  0.99476   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.kPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                 Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
soil_0_20_clay   0.2899  0.2899     1 40.076  3.4177 0.07189 .
soil_0_20_pH_H2O 0.0186  0.0186     1 38.805  0.2198 0.64181  
soil_0_20_Corg   0.6111  0.6111     1 33.275  7.2042 0.01125 *
soil_0_20_silt   0.0039  0.0039     1 30.169  0.0457 0.83217  
Fed              4.9569  4.9569     1  1.276 58.4378 0.05081 .
Ald              1.7919  1.7919     1  2.143 21.1247 0.03873 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.soil.kPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = I(log(k * PS)) ~ soil_0_20_clay + soil_0_20_pH_H2O + 
    soil_0_20_Corg + soil_0_20_silt + Fed + Ald + (1 | year) + 
    (1 | Site) + (1 | Site:block) + (1 | Site:Treatment), data = D)

Linear Hypotheses:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) == 0      21.18866    3.96710   5.341   &lt;0.001 ***
soil_0_20_clay == 0   -0.08522    0.04610  -1.849   0.3021    
soil_0_20_pH_H2O == 0 -0.09210    0.19644  -0.469   0.9965    
soil_0_20_Corg == 0    1.25026    0.46581   2.684   0.0428 *  
soil_0_20_silt == 0    0.00845    0.03953   0.214   1.0000    
Fed == 0              -1.08433    0.14184  -7.644   &lt;0.001 ***
Ald == 0              -8.63139    1.87796  -4.596   &lt;0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div></div>
</section>
<section id="is-the-method-presented-by-flossmann-and-richter-1982-with-the-double-extraction-replicable-with-the-soils-from-the-stycs-trial" class="level3">
<h3 class="anchored" data-anchor-id="is-the-method-presented-by-flossmann-and-richter-1982-with-the-double-extraction-replicable-with-the-soils-from-the-stycs-trial">Is the method presented by Flossmann and Richter (1982) with the double extraction replicable with the soils from the STYCS-trial?</h3>
<ul>
<li>Hypothesis V: The authors expect the desorption kinetics to follow a 1. order kinetic, with the relation: <span class="math display">\[ \frac{dP}{dt}=PS(1-e^{-kt})\]</span> where <span class="math inline">\(PS\)</span> is estimated as <span class="math inline">\(PS=[P_\text{Olsen/CAL}]-[P_{H_2O}]\)</span>, denoted as the semi-labile P-pool. The Olsen- and CAL-method deploy extractants that increase the solubility by more than order of magnitude. This presents the problem, that the estimation of <span class="math inline">\(PS\)</span> is likely to high. It was chosen by the authors in order to make the equation linearizable, so if the linearization is not well behaved, a non-linear regression might deliver a better estimation of both parameters.</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lmList</span>(Y1 <span class="sc">~</span> t.min. <span class="sc">|</span> uid, d[d<span class="sc">$</span>Repetition<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>d<span class="sc">$</span>Repetition<span class="sc">==</span><span class="dv">2</span>,],<span class="at">na.action =</span> na.pass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 12 times caught the same error in lm.fit(x, y, offset = offset,
singular.ok = singular.ok, ...): NA/NaN/Inf in 'y'</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(el): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
  Model: Y1 ~ t.min. | uid 
   Data: d[d$Repetition == 1 | d$Repetition == 2, ] 

Coefficients:
   (Intercept) 
                      Estimate Std. Error    t value     Pr(&gt;|t|)
Cadenazzo_P0_1     -0.12891945 0.01537006  -8.387702 4.332766e-12
Cadenazzo_P0_2     -0.12037045 0.01537006  -7.831491 4.433395e-11
Cadenazzo_P100_1            NA         NA         NA           NA
Cadenazzo_P100_2            NA         NA         NA           NA
Cadenazzo_P166_1   -0.26932199 0.01537006 -17.522512 6.499702e-27
Cadenazzo_P166_2   -0.19243796 0.01537006 -12.520316 2.550625e-19
Ellighausen_P0_1   -0.10464296 0.01537006  -6.808236 3.136905e-09
Ellighausen_P0_2   -0.11438112 0.01537006  -7.441815 2.257472e-10
Ellighausen_P100_1          NA         NA         NA           NA
Ellighausen_P100_2          NA         NA         NA           NA
Ellighausen_P166_1          NA         NA         NA           NA
Oensingen_P0_1     -0.03432646 0.01537006  -2.233333 2.882091e-02
Oensingen_P0_2     -0.05745952 0.01537006  -3.738407 3.819350e-04
Oensingen_P100_1            NA         NA         NA           NA
Oensingen_P100_2            NA         NA         NA           NA
Oensingen_P166_1   -0.13275856 0.01537006  -8.637481 1.527196e-12
Oensingen_P166_2   -0.17051390 0.01537006 -11.093902 6.616653e-17
Reckenholz_P0_1    -0.10545869 0.01537006  -6.861308 2.519112e-09
Reckenholz_P0_2    -0.08557888 0.01537006  -5.567897 4.753375e-07
Reckenholz_P100_1           NA         NA         NA           NA
Reckenholz_P100_2           NA         NA         NA           NA
Reckenholz_P166_1  -0.17172348 0.01537006 -11.172600 4.839473e-17
Reckenholz_P166_2  -0.23296391 0.01537006 -15.156998 1.712692e-23
Ruemlang_P0_1      -0.01851905 0.01537006  -1.204878 2.324269e-01
Ruemlang_P0_2      -0.08675331 0.01537006  -5.644307 3.515958e-07
Ruemlang_P100_1             NA         NA         NA           NA
Ruemlang_P100_2             NA         NA         NA           NA
Ruemlang_P166_1    -0.26153690 0.01537006 -17.016002 3.315417e-26
Ruemlang_P166_2             NA         NA         NA           NA
   t.min. 
                        Estimate   Std. Error       t value     Pr(&gt;|t|)
Cadenazzo_P0_1     -1.318800e-03 0.0004483906 -2.941186e+00 4.466020e-03
Cadenazzo_P0_2     -1.272378e-03 0.0004483906 -2.837654e+00 5.984783e-03
Cadenazzo_P100_1              NA           NA            NA           NA
Cadenazzo_P100_2              NA           NA            NA           NA
Cadenazzo_P166_1   -5.270369e-03 0.0004483906 -1.175397e+01 4.905164e-18
Cadenazzo_P166_2   -3.394812e-03 0.0004483906 -7.571105e+00 1.316077e-10
Ellighausen_P0_1    4.952586e-05 0.0004483906  1.104525e-01 9.123759e-01
Ellighausen_P0_2   -1.260933e-04 0.0004483906 -2.812130e-01 7.794010e-01
Ellighausen_P100_1            NA           NA            NA           NA
Ellighausen_P100_2            NA           NA            NA           NA
Ellighausen_P166_1            NA           NA            NA           NA
Oensingen_P0_1      1.049070e-04 0.0004483906  2.339634e-01 8.157164e-01
Oensingen_P0_2     -1.837559e-04 0.0004483906 -4.098121e-01 6.832320e-01
Oensingen_P100_1              NA           NA            NA           NA
Oensingen_P100_2              NA           NA            NA           NA
Oensingen_P166_1   -2.320568e-04 0.0004483906 -5.175327e-01 6.064639e-01
Oensingen_P166_2   -5.531502e-04 0.0004483906 -1.233635e+00 2.215861e-01
Reckenholz_P0_1     2.780943e-04 0.0004483906  6.202053e-01 5.371956e-01
Reckenholz_P0_2    -7.752286e-04 0.0004483906 -1.728914e+00 8.836252e-02
Reckenholz_P100_1             NA           NA            NA           NA
Reckenholz_P100_2             NA           NA            NA           NA
Reckenholz_P166_1  -1.609218e-03 0.0004483906 -3.588876e+00 6.216266e-04
Reckenholz_P166_2  -4.831330e-03 0.0004483906 -1.077482e+01 2.367928e-16
Ruemlang_P0_1       8.878899e-20 0.0004483906  1.980171e-16 1.000000e+00
Ruemlang_P0_2      -1.438957e-03 0.0004483906 -3.209160e+00 2.032261e-03
Ruemlang_P100_1               NA           NA            NA           NA
Ruemlang_P100_2               NA           NA            NA           NA
Ruemlang_P166_1    -1.090605e-03 0.0004483906 -2.432266e+00 1.764226e-02
Ruemlang_P166_2               NA           NA            NA           NA

Residual standard error: 0.02119011 on 68 degrees of freedom</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">y=</span>Y1, <span class="at">x=</span>t.min., <span class="at">col =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Site <span class="sc">~</span> Treatment) <span class="sc">+</span> </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">TeX</span>(<span class="st">"$Time (min)$"</span>),</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">TeX</span>(<span class="st">"$ln(1-</span><span class="sc">\\</span><span class="st">frac{P}{P_S})$"</span>)) <span class="sc">+</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 292 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 292 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="results_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="results_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<p>The relation can be improved:</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">nlsList</span>(Pv.mg.L. <span class="sc">~</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> (t.dt))) <span class="sc">|</span> uid, d[, <span class="fu">c</span>(<span class="st">"Pv.mg.L."</span>, <span class="st">"uid"</span>, <span class="st">"t.dt"</span>)],  <span class="at">start=</span><span class="fu">list</span>(<span class="at">PS=</span><span class="fl">0.1</span>,<span class="at">k=</span><span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 error caught in nls(model, data = data, control = controlvals, start
= start): singular gradient</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(Res)</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co"># d$nls_pred &lt;- predict(Res)</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from the nlsList results</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>nls_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(Res)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>nls_coefs<span class="sc">$</span>uid <span class="ot">&lt;-</span> <span class="fu">rownames</span>(nls_coefs)</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge coefficients back to the main dataset</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(d, nls_coefs, <span class="at">by =</span> <span class="st">"uid"</span>)</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Most straightforward approach - create curves manually</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>time_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>t.dt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(d<span class="sc">$</span>t.dt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> d_plot <span class="sc">%&gt;%</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uid, Site, Treatment, Repetition, PS, k) <span class="sc">%&gt;%</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">t.dt =</span> time_seq) <span class="sc">%&gt;%</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_Pv =</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> (t.dt))))</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d_plot, <span class="fu">aes</span>(<span class="at">y =</span> Pv.mg.L., <span class="at">x =</span> t.dt, <span class="at">col =</span> Repetition)) <span class="sc">+</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data, <span class="fu">aes</span>(<span class="at">x =</span> t.dt, <span class="at">y =</span> pred_Pv, <span class="at">col =</span> Repetition), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Treatment <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(<span class="st">"$Time (min)$"</span>),</span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$P_{V}(</span><span class="sc">\\</span><span class="st">frac{mg}{L})$"</span>)); <span class="fu">suppressWarnings</span>(<span class="fu">print</span>(p1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="results_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="results_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<p>Now we see how those parameters depend on the tratment:</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>ui <span class="ot">&lt;-</span> <span class="fu">interaction</span>(d<span class="sc">$</span>Site, d<span class="sc">$</span>Treatment)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>nlme.coef.avg <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>nlme.coef <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lvl <span class="cf">in</span> <span class="fu">levels</span>(d<span class="sc">$</span>ui)){</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  d.tmp <span class="ot">&lt;-</span> <span class="fu">subset</span>(d, ui <span class="sc">==</span> lvl)</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># first get nlsList coefs for comparison only (unused)</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  temp_nls <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">nlsList</span>(Pv.mg.L. <span class="sc">~</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> t.dt)) <span class="sc">|</span> uid, </span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>                    d.tmp[, <span class="fu">c</span>(<span class="st">"Pv.mg.L."</span>, <span class="st">"uid"</span>, <span class="st">"t.dt"</span>)], </span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">PS =</span> <span class="fl">0.1</span>, <span class="at">k =</span> <span class="fl">0.2</span>)))</span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>  nlsList_coefs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">apply</span>(temp_nls, <span class="dv">2</span>, \(x) <span class="fu">c</span>(<span class="at">mean=</span><span class="fu">mean</span>(x), <span class="at">sd=</span><span class="fu">sd</span>(x))))</span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(nlsList_coefs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PS.mean"</span>, <span class="st">"PS.sd"</span>, <span class="st">"k.mean"</span>, <span class="st">"k.sd"</span>)</span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now do the real thing</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>  model4 <span class="ot">&lt;-</span> <span class="fu">nlme</span>(Pv.mg.L. <span class="sc">~</span> PS <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> t.dt)),</span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">fixed =</span> PS <span class="sc">+</span> k <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> PS <span class="sc">+</span> k  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> uid,</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> d.tmp[, <span class="fu">c</span>(<span class="st">"Pv.mg.L."</span>, <span class="st">"uid"</span>, <span class="st">"t.dt"</span>)],</span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="at">PS =</span> <span class="fl">0.05</span>, <span class="at">k =</span> <span class="fl">0.12</span>),</span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">nlmeControl</span>(<span class="at">maxIter =</span> <span class="dv">200</span>))</span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(model4)</span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>  fixef <span class="ot">&lt;-</span> model4<span class="sc">$</span>coefficients<span class="sc">$</span>fixed</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>  ranefs <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model4)</span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(ranefs) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ranef_"</span>,<span class="fu">colnames</span>(ranefs))</span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>  nlme.coef[[lvl]]  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(model4), ranefs, <span class="at">Rep=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">ranef</span>(model4)), <span class="at">ui=</span>lvl, <span class="at">Site=</span>d.tmp[<span class="dv">1</span>, <span class="st">"Site"</span>], <span class="at">Treatment=</span>d.tmp[<span class="dv">1</span>, <span class="st">"Treatment"</span>], <span class="at">uid =</span> <span class="fu">rownames</span>(<span class="fu">coef</span>(model4)))</span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>  nlme.coef.avg[[lvl]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">PS=</span>fixef[<span class="st">"PS"</span>], <span class="at">k=</span>fixef[<span class="st">"k"</span>], <span class="at">ui=</span>lvl, <span class="at">Site=</span>d.tmp[<span class="dv">1</span>, <span class="st">"Site"</span>], <span class="at">Treatment=</span>d.tmp[<span class="dv">1</span>, <span class="st">"Treatment"</span>], <span class="at">uid =</span> d.tmp<span class="sc">$</span>uid)</span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 error caught in nls(model, data = data, control = controlvals, start
= start): singular gradient</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase
'msMaxIter'!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded
Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlme.formula(Pv.mg.L. ~ PS * (1 - exp(-k * t.dt)), fixed = PS + :
Singular precision matrix in level -1, block 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data.frame(PS = fixef["PS"], k = fixef["k"], ui = lvl, Site =
d.tmp[1, : row names were found from a short variable and have been discarded</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>nlme.coef.avg <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nlme.coef.avg)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="co"># folgendes datenset wollen wir benutzen um ihn mit dem Boden zu kombinieren</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>nlme.coef <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, nlme.coef)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> <span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>PS  , <span class="at">x=</span>Treatment, <span class="at">col=</span>Site, <span class="at">pch=</span>Treatment)) <span class="sc">+</span> points <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="results_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>k   , <span class="at">x=</span>Treatment, <span class="at">col=</span>Site, <span class="at">pch=</span>Treatment)) <span class="sc">+</span> points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="results_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>k<span class="sc">*</span>PS, <span class="at">x=</span>Treatment, <span class="at">col=</span>Site, <span class="at">pch=</span>Treatment)) <span class="sc">+</span> points <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="results_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>PS  , <span class="at">x=</span>Site, <span class="at">col=</span>Treatment)) <span class="sc">+</span> points <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="results_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>k   , <span class="at">x=</span>Site, <span class="at">col=</span>Treatment)) <span class="sc">+</span> points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="results_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nlme.coef, <span class="fu">aes</span>(<span class="at">y=</span>k<span class="sc">*</span>PS, <span class="at">x=</span>Site, <span class="at">col=</span>Treatment)) <span class="sc">+</span> points <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="results_files/figure-html/unnamed-chunk-10-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="results_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k PS macht von der interpretation her Sinn</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># aber PS ist log-normal verteilt</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>fit.PS   <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(PS)      <span class="sc">~</span> Treatment <span class="sc">+</span> Site, nlme.coef)</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>fit.k    <span class="ot">&lt;-</span> <span class="fu">lm</span>(k            <span class="sc">~</span> Treatment <span class="sc">+</span> Site, nlme.coef)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>fit.kPS  <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(<span class="fu">log</span>(k<span class="sc">*</span>PS)) <span class="sc">~</span> Treatment <span class="sc">+</span> Site, nlme.coef)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit.PS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: log(PS)
           Sum Sq Df  F value    Pr(&gt;F)    
Treatment 27.6260  2 154.7655 &lt; 2.2e-16 ***
Site       3.0383  4   8.5104 2.324e-05 ***
Residuals  4.6411 52                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.PS, <span class="fu">mcp</span>(<span class="at">Treatment =</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = log(PS) ~ Treatment + Site, data = nlme.coef)

Linear Hypotheses:
                 Estimate Std. Error t value Pr(&gt;|t|)    
P100 - P0 == 0    0.91948    0.09447   9.733  &lt; 1e-10 ***
P166 - P0 == 0    1.68127    0.09580  17.550  &lt; 1e-10 ***
P166 - P100 == 0  0.76179    0.09580   7.952 1.04e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazit: PS wird von treatment stark beeinfluss, k eher nicht (dafür von site)</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit.k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: k
            Sum Sq Df F value    Pr(&gt;F)    
Treatment 0.007374  2  1.6124    0.2092    
Site      0.108427  4 11.8547 6.442e-07 ***
Residuals 0.118902 52                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.k, <span class="fu">mcp</span>(<span class="at">Treatment =</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = k ~ Treatment + Site, data = nlme.coef)

Linear Hypotheses:
                  Estimate Std. Error t value Pr(&gt;|t|)
P100 - P0 == 0    0.003111   0.015121   0.206    0.977
P166 - P0 == 0   -0.022243   0.015334  -1.451    0.323
P166 - P100 == 0 -0.025354   0.015334  -1.653    0.233
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit.kPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: I(log(k * PS))
           Sum Sq Df F value    Pr(&gt;F)    
Treatment 22.4177  2 68.5970 2.609e-15 ***
Site       3.9298  4  6.0124 0.0004703 ***
Residuals  8.4969 52                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.kPS, <span class="fu">mcp</span>(<span class="at">Treatment =</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = I(log(k * PS)) ~ Treatment + Site, data = nlme.coef)

Linear Hypotheses:
                 Estimate Std. Error t value Pr(&gt;|t|)    
P100 - P0 == 0     0.9127     0.1278   7.140  &lt; 1e-04 ***
P166 - P0 == 0     1.5035     0.1296  11.599  &lt; 1e-04 ***
P166 - P100 == 0   0.5908     0.1296   4.558 0.000105 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.PS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                 Sum Sq Mean Sq NumDF  DenDF  F value    Pr(&gt;F)    
soil_0_20_clay   0.0017  0.0017     1 39.832   0.0467   0.82993    
soil_0_20_pH_H2O 0.0007  0.0007     1 38.367   0.0202   0.88762    
soil_0_20_Corg   0.1525  0.1525     1 32.811   4.2087   0.04827 *  
soil_0_20_silt   0.0000  0.0000     1 40.483   0.0002   0.98792    
Fed              4.9643  4.9643     1 36.018 137.0324 7.807e-14 ***
Ald              1.8349  1.8349     1 37.406  50.6502 1.865e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(glht(fit.PS))</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazit: PS wird von treatment stark beeinfluss, k eher nicht (dafür von site)</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                    Sum Sq   Mean Sq NumDF  DenDF F value   Pr(&gt;F)   
soil_0_20_clay   0.0126524 0.0126524     1 32.124 11.0892 0.002190 **
soil_0_20_pH_H2O 0.0010892 0.0010892     1 38.528  0.9546 0.334637   
soil_0_20_Corg   0.0091554 0.0091554     1 31.652  8.0242 0.007963 **
soil_0_20_silt   0.0012806 0.0012806     1 13.842  1.1224 0.307539   
Fed              0.0001832 0.0001832     1  2.350  0.1606 0.722155   
Ald              0.0002817 0.0002817     1  2.262  0.2469 0.663422   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.soil.k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RET$pfunction("adjusted", ...): Completion with error &gt; abseps</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = k ~ soil_0_20_clay + soil_0_20_pH_H2O + soil_0_20_Corg + 
    soil_0_20_silt + Fed + Ald + (1 | year) + (1 | Site) + (1 | 
    Site:block) + (1 | Site:Treatment), data = D)

Linear Hypotheses:
                       Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) == 0       0.454128   0.358773   1.266  0.70534   
soil_0_20_clay == 0   -0.016164   0.004854  -3.330  0.00523 **
soil_0_20_pH_H2O == 0 -0.020791   0.021279  -0.977  0.87863   
soil_0_20_Corg == 0    0.136661   0.048244   2.833  0.02785 * 
soil_0_20_silt == 0    0.004076   0.003848   1.059  0.83536   
Fed == 0               0.005157   0.012867   0.401  0.99838   
Ald == 0              -0.072344   0.145598  -0.497  0.99476   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.soil.kPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                 Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
soil_0_20_clay   0.2899  0.2899     1 40.076  3.4177 0.07189 .
soil_0_20_pH_H2O 0.0186  0.0186     1 38.805  0.2198 0.64181  
soil_0_20_Corg   0.6111  0.6111     1 33.275  7.2042 0.01125 *
soil_0_20_silt   0.0039  0.0039     1 30.169  0.0457 0.83217  
Fed              4.9569  4.9569     1  1.276 58.4378 0.05081 .
Ald              1.7919  1.7919     1  2.143 21.1247 0.03873 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(fit.soil.kPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = I(log(k * PS)) ~ soil_0_20_clay + soil_0_20_pH_H2O + 
    soil_0_20_Corg + soil_0_20_silt + Fed + Ald + (1 | year) + 
    (1 | Site) + (1 | Site:block) + (1 | Site:Treatment), data = D)

Linear Hypotheses:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) == 0      21.18866    3.96710   5.341   &lt;0.001 ***
soil_0_20_clay == 0   -0.08522    0.04610  -1.849   0.3016    
soil_0_20_pH_H2O == 0 -0.09210    0.19644  -0.469   0.9965    
soil_0_20_Corg == 0    1.25026    0.46581   2.684   0.0432 *  
soil_0_20_silt == 0    0.00845    0.03953   0.214   1.0000    
Fed == 0              -1.08433    0.14184  -7.644   &lt;0.001 ***
Ald == 0              -8.63139    1.87796  -4.596   &lt;0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"cache/benchmark-tables.rds"</span>)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract individual tables</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>Tables_yield <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_yield</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_yield_weather</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>Tables_earth_treatment <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_earth_treatment</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>Tables_earth_notreatment <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_earth_notreatment</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>Tables_yield_lm <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_yield_lm</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather_lm <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_yield_weather_lm</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>Tables_earth_lm <span class="ot">&lt;-</span> benchmark_results<span class="sc">$</span>Tables_earth_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Tables_yield_lm, </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">caption =</span> <span class="st">"Linear model performance for predicting yield and P-balance variables using different P-dynamics variable sets (without weather data). Rows represent different predictor variable sets: 'k' uses only the release rate constant; 'PS' uses only log-transformed semi-labile P; 'kPS' uses both k and log-transformed PS plus their interaction; 'AAE10' uses only log-transformed AAE10-extractable P; 'CO2' uses only log-transformed CO2-extractable P; 'AAE10_CO2' uses both log-transformed AAE10 and CO2 extractable P plus their log-log interaction; 'AAE10_CO2_kPS' combines AAE10, CO2, k, and PS variables with interactions; 'CO2_kPS' combines CO2, k, and PS variables with interactions. Columns show explained variance for different target variables."</span>,</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Linear model performance for predicting yield and P-balance variables using different P-dynamics variable sets (without weather data). Rows represent different predictor variable sets: 'k' uses only the release rate constant; 'PS' uses only log-transformed semi-labile P; 'kPS' uses both k and log-transformed PS plus their interaction; 'AAE10' uses only log-transformed AAE10-extractable P; 'CO2' uses only log-transformed CO2-extractable P; 'AAE10_CO2' uses both log-transformed AAE10 and CO2 extractable P plus their log-log interaction; 'AAE10_CO2_kPS' combines AAE10, CO2, k, and PS variables with interactions; 'CO2_kPS' combines CO2, k, and PS variables with interactions. Columns show explained variance for different target variables.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ymain_norm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ymain_rel</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">annual_P_uptake</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">annual_P_balance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">-0.009</td>
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.553</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.540</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">0.277</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.232</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.233</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.562</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.232</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.561</td>
</tr>
</tbody>
</table>


</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Tables_yield_weather_lm, </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Linear model performance for predicting yield and P-balance variables including weather data. Rows represent different predictor variable sets: 'onlyweather' uses only weather variables (annual average temperature, annual sum precipitation, juvenile deviation precipitation/sun/temperature, annual sum sun, plus NA weather indicator); 'k' combines weather variables with release rate constant; 'PS' combines weather variables with log-transformed semi-labile P; 'kPS' combines weather variables with k, log-transformed PS, and their interaction; 'AAE10' combines weather variables with log-transformed AAE10-extractable P; 'CO2' combines weather variables with log-transformed CO2-extractable P; 'AAE10_CO2' combines weather variables with both extractable P measures and their interaction; 'AAE10_CO2_kPS' combines weather variables with all P-dynamics parameters; 'CO2_kPS' combines weather variables with CO2, k, and PS parameters."</span>,</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Linear model performance for predicting yield and P-balance variables including weather data. Rows represent different predictor variable sets: 'onlyweather' uses only weather variables (annual average temperature, annual sum precipitation, juvenile deviation precipitation/sun/temperature, annual sum sun, plus NA weather indicator); 'k' combines weather variables with release rate constant; 'PS' combines weather variables with log-transformed semi-labile P; 'kPS' combines weather variables with k, log-transformed PS, and their interaction; 'AAE10' combines weather variables with log-transformed AAE10-extractable P; 'CO2' combines weather variables with log-transformed CO2-extractable P; 'AAE10_CO2' combines weather variables with both extractable P measures and their interaction; 'AAE10_CO2_kPS' combines weather variables with all P-dynamics parameters; 'CO2_kPS' combines weather variables with CO2, k, and PS parameters.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ymain_norm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ymain_rel</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">annual_P_uptake</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">annual_P_balance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">onlyweather</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.353</td>
<td style="text-align: right;">0.077</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS</td>
<td style="text-align: right;">0.204</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.627</td>
</tr>
<tr class="even">
<td style="text-align: left;">kPS</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.415</td>
<td style="text-align: right;">0.632</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">0.432</td>
</tr>
<tr class="even">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.594</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAE10_CO2</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">0.591</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAE10_CO2_kPS</td>
<td style="text-align: right;">0.220</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.652</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2_kPS</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.644</td>
</tr>
</tbody>
</table>


</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Tables_earth_lm, </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Linear model performance comparison for predicting P-dynamics parameters from soil properties. Rows represent different target P-dynamics variables: 'PS_log' is log-transformed semi-labile phosphorus; 'k' is the phosphorus release rate constant; 'kPS_log' is log-transformed product of release rate and semi-labile P; 'P_AAE10_log' is log-transformed AAE10-extractable phosphorus; 'P_CO2_log' is log-transformed CO2-extractable phosphorus. The 'with_treatment' column uses soil variables (clay content, pH, organic carbon, silt content) plus treatment (P0 P100 P166), while 'without_treatment' uses only the soil variables."</span>,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Linear model performance comparison for predicting P-dynamics parameters from soil properties. Rows represent different target P-dynamics variables: 'PS_log' is log-transformed semi-labile phosphorus; 'k' is the phosphorus release rate constant; 'kPS_log' is log-transformed product of release rate and semi-labile P; 'P_AAE10_log' is log-transformed AAE10-extractable phosphorus; 'P_CO2_log' is log-transformed CO2-extractable phosphorus. The 'with_treatment' column uses soil variables (clay content, pH, organic carbon, silt content) plus treatment (P0 P100 P166), while 'without_treatment' uses only the soil variables.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PS_log</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">k</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kPS_log</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P_AAE10_log</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P_CO2_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">soil + treatment</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">0.328</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.792</td>
</tr>
<tr class="even">
<td style="text-align: left;">only soil</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.267</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.365</td>
<td style="text-align: right;">0.025</td>
</tr>
</tbody>
</table>


</div>
</div></div>

</section>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>