# Introduction

## Complexity of Phosphorous

Phosphorous displays a wide range of behaviours in soils, in places where organic, mineral and aqueous phases interface. In phases that contain oxygen Phosphorous is almost exclusively present as several derivates of Orthophosphate $PO_4^{3-}$ It can be found as organic molecules as anhydric- and ester-groups, being needed by all known species as a constituent of DNA and energy transfer-processes. It can be present as anorganic Phosphate either as mono-orthophosphate $PO_4^{3-}$ or poly-orthophosphate $HO-(PO_2)_n-OH$, where it can strongly interact with water, forming, depending on pH $HPO_4^{2-}$ or $H_2PO_4^{-}$. The dissolved species of phosphate are subject to adsorption to clay- and oxide-surfaces of the solid soil-phase, they also form fallout-products such as Apatite, Vivianite etc. With the present metal-cations in the solution. While the solubility constant of most phosphate-salts are comparably low (Wert eingeben), meaning that the fallout and formation of minerals happens at low chemical activities of phosphate, phosphate often is leached from soil-surface-layers, heavily reducing the efficacy of P-fertilization and presenting a disturbance to P-limited ecosystems. Those phenomena, many of them being physicochemically controlled, are influenced by parameters such as pH, ionic-strength, clay-content, specific-surface of the solid phase, amorphous $Fe(OH)_3$-content amorphous $Al(OH)_3$-content, in short the phenomena depend heavily on the composition, distribution and geometry of the soil. Those properties are considered to be stable respectively long-term properties of a soil, when looked at it with the interest of modelling the transport processes of Phosphate in soils. Factors such as water-content, temperature, vegetation and precipitation are factors that temporally can vary fast and to a certain degree unpredictably. Organic forms of phosphates, prominently DNA or oligonucleotides and phytate are also subject to physicochemical reactions, mainly decomposition, but are foremost controlled in their presence by enzymatic processes, where i.e. plants form phytates in seeds to provide the embryo a compact and specific reserve of phosphate, but many bacteria possess via Phytases the ability to hydrolyse phytate and use it for their own means. To assess and cover those phenomena, models, dynamically describing the motion of Phosphorous in soils, differentiate several pools of Phosphorous, most prominently the organic-P, dissolved-P, adsorbed-P, mineral-P, where the difference in temporal behaviour, such as the mean-reside-time can lead to a differentiation between labile-P, semi-labile-P and so on.

# Plants as Phosphate sinks

When a soil is used agronomically, P-sinks such as leaching and plant P-uptake

```{r Loading previous results}
#|include: false

library(multcomp)
library(car)
library(tidyr)
library(lme4)
library(ggplot2)
library(ggtext)
library(ggpmisc)
library(nlme)
library(latex2exp)
library(kableExtra)
library(broom)
library(dplyr)
library(MuMIn)
library(sjPlot) # table functions
library(sjmisc) # sample data
library(lme4) # fitting models
library(report)
library(performance)

load("~/Documents/Master Thesis/Master-Thesis-P-kinetics/data/results_coefficient_analysis")
```

<!-- ## Struktur -->

<!-- ## Warum ist die Arbeit wichtig -->

<!-- P ist endlich, Umweltprobleme \## P ist sehr komplex -->

<!-- Siehe oben \## Wie wird bisher P-ErnÃ¤hrung angegangen -->

<!-- GRUD -->

<!-- ## Warum Bodentest -->

<!-- ## Warum kinetischer Bodentest -->

## Research Questions:

### How well can current GRUD measurements of $C_P$ predict the relative Yield, P-Uptake and P-Balance?

-   Hypothesis I: The measurements of the equlibrium concentrations of Phosphorus in a solvent do not display significant effects on relative Yield and consequently P-Uptake, since it is strongly dependent on yield. $C_P$ relates strongly to the amount of Phosphorus applied, the P-balance might well be siginificantly correlated to $C_P$ but not explain a lot of variance.


```{r}
#|code-fold: true
#|tidy: true  

ggplot(D[D$soil_0_20_P_CO2!=0,],aes(y=Ymain_rel, x=soil_0_20_P_CO2, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{CO_{2}}(mg/kg Soil)$"),
         y="relative Yield (%)") +
  facet_wrap( ~ Site, nrow = 2)

ggplot(D[D$soil_0_20_P_AAE10!=0,],aes(y=Ymain_rel, x=soil_0_20_P_AAE10, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{AAE10}(mg/kg Soil)$"),
         y="relative Yield (%)") +
  facet_wrap( ~ Site, nrow = 2)

ggplot(D[D$soil_0_20_P_CO2!=0&D$annual_P_uptake!=0,],aes(y=annual_P_uptake, x=soil_0_20_P_CO2, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{CO_{2}}(mg/kg Soil)$"),
         y=TeX("Annual P-Uptake $kg~P/ha$")) +
  facet_wrap( ~ Site, nrow = 2)

ggplot(D[D$soil_0_20_P_AAE10!=0&D$annual_P_uptake!=0,],aes(y=annual_P_uptake, x=soil_0_20_P_AAE10, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{AAE10}(mg/kg Soil)$"),
         y=TeX("Annual P-Uptake $kg~P/ha$")) +
  facet_wrap( ~ Site, nrow = 2)

ggplot(D[D$soil_0_20_P_CO2!=0&D$annual_P_balance!=0,],aes(y=annual_P_balance, x=soil_0_20_P_CO2, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{CO_{2}}(mg/kg Soil)$"),
         y=TeX("Annual P-Balance $kg~P/ha$")) +
  facet_wrap( ~ Site, nrow = 2)

ggplot(D[D$soil_0_20_P_AAE10!=0&D$annual_P_balance!=0,],aes(y=annual_P_balance, x=soil_0_20_P_AAE10, col=Site, size = Treatment)) +
  geom_point(shape = 7) + 
  scale_x_log10() + scale_y_log10() +
  labs(x=TeX("$P_{AAE10}(mg/kg Soil)$"),
         y=TeX("Annual P-Balance $kg~P/ha$")) +
  facet_wrap( ~ Site, nrow = 2)



```
Now we want to check the strength of the models in terms of $R^2$ and the significance of the effects in terms of p-values:

```{r}
#|code-fold: true
#|tidy: true

#tab_model(fit.grud.Yrel,fit.grud.Puptake,fit.grud.Pbalance)
report(fit.grud.Yrel)
report(fit.grud.Puptake)
report(fit.grud.Pbalance)
```
@Frank, here I also show the non linear mixed models, following the Mitscherlich saturation curve:

```{r}
library(nlme)

# Make sure grouping variables are factors
D$year  <- as.factor(D$year)
D$Site  <- as.factor(D$Site)
D$block <- as.factor(D$block)
D$crop <- as.factor(D$crop)
# Fit the model
fit.mitscherlich.CO2.Yrel <- nlme(
  Ymain_rel ~ A * (1 - exp(-k * soil_0_20_P_CO2 + E)),                
  fixed = A + k + E ~ soil_0_20_clay + soil_0_20_pH_H2O + ansum_sun + ansum_prec,
  random = A ~ 1 | year/Site/block,
  data = D,
  start = c(
    A = 220, A1 = 0, A2 = 0, A3 = 0, A4 = 0,
    k = 0.05, k1 = 0, k2 = 0, k3 = 0, k4 = 0,
    E = -3, E1 = 0, E2 = 0, E3 = 0, E4 = 0
  ),
  control = nlmeControl(maxIter = 500),
  na.action = na.omit
)

summary(fit.mitscherlich.CO2.Yrel)
anova(fit.mitscherlich.CO2.Yrel)

model_performance(fit.mitscherlich.CO2.Yrel)

r.square <- 1-sum(residuals(fit.mitscherlich.CO2.Yrel)^2)/sum((D$Ymain_rel-mean(D$Ymain_rel,na.rm=TRUE))^2,na.rm = TRUE)
```

With the covariate and random effect used as by Juliane Hirte we obtain  $R^2=$`{r} r.square`, I don't know how to interpret that, I fear that the model is overfitting data.


### How do GRUD-measurements of $C_P$ relate to the soil properties $C_\text{org}$-content, clay-content, silt-content and pH?


