<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.42">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Lukas Graz">
    <meta name="dcterms.date" content="2025-02-13">

    <title>Modeling of relative Yield, P-Uptake and P-Balance</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cbf367297292b8e2858f4d7b7fd861d6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <style>
.quarto-notebook .cell-container .cell-decorator {
  display: none;
}
</style>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> mlr3</h6>

            <a href="../notebooks/mlr3.qmd" class="btn btn-primary quarto-download-embed" download="mlr3.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Modeling of relative Yield, P-Uptake and P-Balance</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>Lukas Graz </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">February 13, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    <div class="quarto-other-links"><div class="quarto-title-meta-heading">Other Links</div><div class="quarto-title-meta-contents"><span><a href="../presentation/index.html"><i class="bi bi-link-45deg"></i>Presentation</a></span></div></div></div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" id="toc-predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" class="nav-link" data-scroll-target="#predicting-yield-variables-withwithout-weather-data-with-earth-dynamics">Predicting Yield variables (with/without Weather data) with Earth-dynamics</a>
  <ul class="collapse">
  <li><a href="#with-weather-data" id="toc-with-weather-data" class="nav-link" data-scroll-target="#with-weather-data">With Weather data</a></li>
  <li><a href="#without-weather-data" id="toc-without-weather-data" class="nav-link" data-scroll-target="#without-weather-data">Without Weather data</a></li>
  </ul></li>
  <li><a href="#predicting-earth-dynamics-via-soil-variables-withwithout-treatment" id="toc-predicting-earth-dynamics-via-soil-variables-withwithout-treatment" class="nav-link" data-scroll-target="#predicting-earth-dynamics-via-soil-variables-withwithout-treatment">Predicting Earth-dynamics via soil variables (with/without Treatment)</a>
  <ul class="collapse">
  <li><a href="#legacy-code" id="toc-legacy-code" class="nav-link" data-scroll-target="#legacy-code">Legacy Code</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>RES <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/RES.rds"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> RES<span class="sc">$</span>D</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- RES$data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Benchmark helper function</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3verse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"regr.mse"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">interactive</span>())</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>get_benchi_table <span class="ot">&lt;-</span> <span class="cf">function</span>(tasks, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">resamplings =</span> <span class="cn">NULL</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co"> activate xgboost and ranger for == uncomment things below</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  learners <span class="ot">&lt;-</span> <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">"regr.featureless"</span>, <span class="st">"regr.lm"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># , "regr.xgboost", "regr.ranger"</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># learners$regr.xgboost$param_set$set_values(</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   eta = 0.04, </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   nrounds = 300, </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   max_depth = 2</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  benchi <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">benchmark</span>(<span class="fu">benchmark_grid</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      tasks, </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      learners, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(resamplings)) <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> nfolds) <span class="cf">else</span> resamplings</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"benchmark.rds"</span>, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">"cache/"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">hash =</span> <span class="fu">list</span>(tasks, nfolds)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(benchi<span class="sc">$</span><span class="fu">aggregate</span>(mse), </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> task_id,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> learner_id,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> regr.mse</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(res) <span class="ot">&lt;-</span> res<span class="sc">$</span>task_id</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> res[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"regr."</span>, <span class="st">""</span>, <span class="fu">colnames</span>(res))</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">any</span>(<span class="fu">colnames</span>(res) <span class="sc">==</span> <span class="st">"featureless"</span>))</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> res <span class="sc">/</span> res<span class="sc">$</span>featureless</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  res[, <span class="sc">-</span><span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Testing prediction quality using</p>
<ul>
<li>Linear models</li>
<li>Random forests (default parameters)</li>
<li>XGBoost (with parameter tuning)</li>
</ul>
<p><strong>Weather Variables:</strong></p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Weather_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"anavg_temp"</span>, <span class="st">"ansum_prec"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"juvdev_prec"</span>, <span class="st">"juvdev_sun"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ansum_sun"</span>, <span class="st">"juvdev_temp"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set NA's to 0 but include a column to indicate that</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>NA_weather <span class="ot">&lt;-</span> <span class="fu">is.na</span>(D<span class="sc">$</span>juvdev_sun)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>D[NA_weather, Weather_vars] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>NA_weather <span class="ot">&lt;-</span> NA_weather</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Weather_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(Weather_vars, <span class="st">"NA_weather"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(Weather_vars <span class="sc">%in%</span> <span class="fu">names</span>(D)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Weather_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "anavg_temp"  "ansum_prec"  "juvdev_prec" "juvdev_sun"  "ansum_sun"  
[6] "juvdev_temp" "NA_weather" </code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>P_var_sets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyweather =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="st">"k"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PS =</span> <span class="st">"PS_log"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kPS =</span> <span class="fu">c</span>(<span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10 =</span> <span class="st">"P_AAE10_log"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2 =</span> <span class="st">"P_CO2_log"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2 =</span> <span class="fu">c</span>(<span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>, <span class="st">"P_AAE10_CO2_loglog"</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>Earth_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soil_0_20_clay"</span>, <span class="st">"soil_0_20_pH_H2O"</span>, <span class="st">"soil_0_20_Corg"</span>, <span class="st">"soil_0_20_silt"</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Y_vars_yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ymain_norm"</span>, <span class="st">"Ymain_rel"</span>, <span class="st">"annual_P_uptake"</span>, <span class="st">"annual_P_balance"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Y_vars_earth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>, <span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>impute NA’s for Earth variables. impute value with the mean of Site X block</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># xtabs(~is.na(D$soil_0_20_silt) + Site + block, D)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> Earth_vars) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  D[[var]] <span class="ot">&lt;-</span> <span class="fu">ave</span>(D[[var]], D<span class="sc">$</span>Site, D<span class="sc">$</span>block, <span class="at">FUN =</span> \(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), x))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>remove Cadenazzoo since too many crucial data missing</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> D[D<span class="sc">$</span>site <span class="sc">!=</span> <span class="st">"CAD"</span>, ]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(D<span class="sc">$</span>Site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Now check NA’s</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(D[, <span class="fu">unique</span>(<span class="fu">c</span>(Y_vars_yield, Y_vars_earth, Weather_vars, <span class="fu">unlist</span>(P_var_sets), Earth_vars))], </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  \(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)<span class="sc">|</span><span class="fu">is.nan</span>(x))) <span class="sc">|&gt;</span> <span class="fu">cbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
Ymain_norm           23
Ymain_rel           117
annual_P_uptake      70
annual_P_balance     55
PS_log                0
k                     0
kPS_log               0
P_AAE10_log           0
P_CO2_log             0
anavg_temp            0
ansum_prec            0
juvdev_prec           0
juvdev_sun            0
ansum_sun             0
juvdev_temp           0
NA_weather            0
P_AAE10_CO2_loglog    0
soil_0_20_clay        0
soil_0_20_pH_H2O      0
soil_0_20_Corg        0
soil_0_20_silt        0</code></pre>
</div>
</div></div>
</section>
<section id="predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" class="level2">
<h2 class="anchored" data-anchor-id="predicting-yield-variables-withwithout-weather-data-with-earth-dynamics">Predicting Yield variables (with/without Weather data) with Earth-dynamics</h2>
<section id="with-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="with-weather-data">With Weather data</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>P_var_sets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$onlyweather
NULL

$k
[1] "k"

$PS
[1] "PS_log"

$kPS
[1] "PS_log"  "k"       "kPS_log"

$AAE10
[1] "P_AAE10_log"

$CO2
[1] "P_CO2_log"

$AAE10_CO2
[1] "P_AAE10_log"        "P_CO2_log"          "P_AAE10_CO2_loglog"

$AAE10_CO2_kPS
[1] "P_AAE10_log" "P_CO2_log"   "PS_log"      "k"           "kPS_log"    

$CO2_kPS
[1] "P_CO2_log" "PS_log"    "k"         "kPS_log"  </code></pre>
</div>
</div></div>
<p>Algorithm learns to predict location from weather since we do not do stratified cross-validation (leaving out locations).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_yield){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar ,Weather_vars, <span class="fu">unlist</span>(P_var_sets)))])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  mytsks <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (nam <span class="cf">in</span> <span class="fu">names</span>(P_var_sets)) {</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Weather_vars, P_var_sets[[nam]])],</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> nam)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    mytsks[[nam]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  Tables_yield_weather[[yvar]] <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Ymain_norm
                  lm
onlyweather   -0.018
k              0.023
PS             0.204
kPS            0.203
AAE10          0.147
CO2            0.231
AAE10_CO2      0.235
AAE10_CO2_kPS  0.220
CO2_kPS        0.246

$Ymain_rel
                 lm
onlyweather   0.132
k             0.105
PS            0.184
kPS           0.189
AAE10         0.222
CO2           0.210
AAE10_CO2     0.245
AAE10_CO2_kPS 0.238
CO2_kPS       0.157

$annual_P_uptake
                 lm
onlyweather   0.391
k             0.353
PS            0.446
kPS           0.415
AAE10         0.496
CO2           0.463
AAE10_CO2     0.491
AAE10_CO2_kPS 0.463
CO2_kPS       0.449

$annual_P_balance
                 lm
onlyweather   0.113
k             0.077
PS            0.627
kPS           0.632
AAE10         0.432
CO2           0.594
AAE10_CO2     0.591
AAE10_CO2_kPS 0.652
CO2_kPS       0.644</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(Tables_yield_weather, \(x) x<span class="sc">$</span>lm)); </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_yield_weather[[<span class="dv">1</span>]])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>(Tables_yield_weather_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Ymain_norm Ymain_rel annual_P_uptake annual_P_balance
onlyweather       -0.018     0.132           0.391            0.113
k                  0.023     0.105           0.353            0.077
PS                 0.204     0.184           0.446            0.627
kPS                0.203     0.189           0.415            0.632
AAE10              0.147     0.222           0.496            0.432
CO2                0.231     0.210           0.463            0.594
AAE10_CO2          0.235     0.245           0.491            0.591
AAE10_CO2_kPS      0.220     0.238           0.463            0.652
CO2_kPS            0.246     0.157           0.449            0.644</code></pre>
</div>
</div></div>
</section>
<section id="without-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="without-weather-data">Without Weather data</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>P_var_sets_noweather <span class="ot">&lt;-</span> P_var_sets[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Tables_yield <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_yield){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar, <span class="fu">unlist</span>(P_var_sets_noweather)))])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  mytsks <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (nam <span class="cf">in</span> <span class="fu">names</span>(P_var_sets_noweather)) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      D[ind,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(yvar, P_var_sets_noweather[[nam]]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> nam)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    mytsks[[nam]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  Tables_yield[[yvar]] <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>Tables_yield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Ymain_norm
                 lm
k             0.021
PS            0.223
kPS           0.215
AAE10         0.109
CO2           0.228
AAE10_CO2     0.232
AAE10_CO2_kPS 0.233
CO2_kPS       0.232

$Ymain_rel
                  lm
k             -0.009
PS             0.051
kPS            0.036
AAE10          0.152
CO2            0.105
AAE10_CO2      0.129
AAE10_CO2_kPS  0.139
CO2_kPS        0.094

$annual_P_uptake
                  lm
k             -0.005
PS             0.034
kPS            0.030
AAE10          0.095
CO2            0.075
AAE10_CO2      0.097
AAE10_CO2_kPS  0.049
CO2_kPS        0.046

$annual_P_balance
                 lm
k             0.018
PS            0.553
kPS           0.540
AAE10         0.277
CO2           0.500
AAE10_CO2     0.491
AAE10_CO2_kPS 0.562
CO2_kPS       0.561</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(Tables_yield, \(x) x<span class="sc">$</span>lm));</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_yield[[<span class="dv">1</span>]])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>(Tables_yield_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Ymain_norm Ymain_rel annual_P_uptake annual_P_balance
k                  0.021    -0.009          -0.005            0.018
PS                 0.223     0.051           0.034            0.553
kPS                0.215     0.036           0.030            0.540
AAE10              0.109     0.152           0.095            0.277
CO2                0.228     0.105           0.075            0.500
AAE10_CO2          0.232     0.129           0.097            0.491
AAE10_CO2_kPS      0.233     0.139           0.049            0.562
CO2_kPS            0.232     0.094           0.046            0.561</code></pre>
</div>
</div></div>
<p>xgboost &amp; ranger are no good in this setting since only very few variables available</p>
</section>
</section>
<section id="predicting-earth-dynamics-via-soil-variables-withwithout-treatment" class="level2">
<h2 class="anchored" data-anchor-id="predicting-earth-dynamics-via-soil-variables-withwithout-treatment">Predicting Earth-dynamics via soil variables (with/without Treatment)</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Earth_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "soil_0_20_clay"   "soil_0_20_pH_H2O" "soil_0_20_Corg"   "soil_0_20_silt"  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Y_vars_earth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PS_log"      "k"           "kPS_log"     "P_AAE10_log" "P_CO2_log"  </code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>is.trt0 <span class="ot">&lt;-</span> D<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"P0"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>is.trt1 <span class="ot">&lt;-</span> D<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"P100"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>mytsks_treatment <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>mytsks_notreatment <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_earth){</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar, <span class="fu">unlist</span>(P_var_sets_noweather)))])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Earth_vars, <span class="st">"is.trt1"</span>, <span class="st">"is.trt0"</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> yvar)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    mytsks_treatment[[yvar]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Earth_vars</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> yvar)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    mytsks_notreatment[[yvar]] <span class="ot">&lt;-</span> mytsk    </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>Tables_earth_treatment <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks_treatment)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>Tables_earth_notreatment <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks_notreatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Tables_earth_treatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               lm
PS_log      0.885
k           0.328
kPS_log     0.752
P_AAE10_log 0.824
P_CO2_log   0.792</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Tables_earth_notreatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               lm
PS_log      0.042
k           0.267
kPS_log     0.023
P_AAE10_log 0.365
P_CO2_log   0.025</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soil + treatment"</span> <span class="ot">=</span> Tables_earth_treatment[[<span class="st">"lm"</span>]],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"only soil"</span> <span class="ot">=</span> Tables_earth_notreatment[[<span class="st">"lm"</span>]]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_earth_treatment)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>(Tables_earth_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 PS_log     k kPS_log P_AAE10_log P_CO2_log
soil + treatment  0.885 0.328   0.752       0.824     0.792
only soil         0.042 0.267   0.023       0.365     0.025</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="fu">list</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield =</span> Tables_yield,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_weather =</span> Tables_yield_weather,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_treatment =</span> Tables_earth_treatment,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_notreatment =</span> Tables_earth_notreatment,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_lm =</span> Tables_yield_lm,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_weather_lm =</span> Tables_yield_weather_lm,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_lm =</span> Tables_earth_lm</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>), <span class="st">"cache/benchmark-tables.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<hr>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>annual_P_balance, D<span class="sc">$</span>PS) <span class="co"># 0.54389</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>fert_P_tot, D<span class="sc">$</span>PS) <span class="co"># 0.48236</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6449276</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>annual_P_uptake, D<span class="sc">$</span>PS) <span class="co"># 0.070678</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div></div>
<p>We did manage to have high predictive power for weather. This could also be due to our regression models recovering location&amp;year from it and hence still overfitting on the test set.</p>
<p>Without Weather data we only managed for annual balance to get some predictive power (30%). Since we the balance is uptake - fert_P, this means that we mostly predicted fert_P. Interestingly PS is best to predict this quantity</p>
<section id="legacy-code" class="level3">
<h3 class="anchored" data-anchor-id="legacy-code">Legacy Code</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<details class="code-fold">
<summary>XGBoost - Parameter Tuning</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter estimates for XGBoost</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(D[<span class="fu">complete.cases</span>(D<span class="sc">$</span>annual_P_balance),], </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"annual_P_balance"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS<span class="co">#, Weather_vars</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">target =</span> <span class="st">"annual_P_balance"</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"regr.xgboost"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="dv">500</span>  <span class="co"># More iterations due to lower learning rate</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create search space</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ps</span>(</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">p_int</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">p_dbl</span>(<span class="fl">0.001</span>, <span class="fl">0.3</span>, <span class="at">tags =</span> <span class="st">"logscale"</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup tuning</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>instance <span class="ot">&lt;-</span> <span class="fu">ti</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">task =</span> t,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> l,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>),</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">"regr.mse"</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">terminator =</span> <span class="fu">trm</span>(<span class="st">"none"</span>),</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">search_space =</span> ps</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid search</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>tuner <span class="ot">&lt;-</span> mlr3tuning<span class="sc">::</span><span class="fu">tnr</span>(<span class="st">"grid_search"</span>)</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>tuner<span class="sc">$</span><span class="fu">optimize</span>(instance)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>instance<span class="sc">$</span>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Ymain_rel max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.067444 &lt;list[5]&gt; &lt;list[2]&gt; 177.18</num></list></list></num></int></p>
<p>P uptake max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 137.41</num></list></list></num></int></p>
<p>annual_P_balance max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 145.21</num></list></list></num></int></p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef$kPS_log &lt;- nlme.coef$k * nlme.coef$PS</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef.mrg &lt;- merge(nlme.coef,allP[allP$year&gt;=2017,],by = "uid")</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # add log-transformed versions</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># D$kPS_log &lt;- log(D$kPS_log)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># D$PS_log &lt;- log(D$PS)</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># D$soil_0_20_P_AAE10_log &lt;- log(D$soil_0_20_P_AAE10)</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># D$soil_0_20_P_CO2_log &lt;- log(D$soil_0_20_P_CO2)</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># D$k</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(D, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Ymain_rel"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS, Weather_vars))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Ymain_rel P_AAE10_log   P_CO2_log     PS_log          k   kPS_log
55      72.33   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
56      92.91   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
57      65.60   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
58         NA   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
59         NA   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
60         NA   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
61      84.81   1.8870696 -1.46967597 -2.9145147 0.20191085 -4.514444
62         NA   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
63     106.32   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
64      69.17   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
65         NA   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
66      84.97   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
67      82.00   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
68         NA   1.8245493 -1.34707365 -2.6264148 0.23310593 -4.082677
69      89.08   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
70      81.01   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
71         NA   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
72      66.00   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
73         NA   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
74      74.25   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
75         NA   0.8329091 -1.83258146 -3.3408312 0.15014993 -5.236952
76      79.31   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
77         NA   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
78      74.44   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
79      92.33   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
80      80.85   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
81         NA   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
82         NA   1.8870696 -1.34707365 -3.8896385 0.13492618 -5.892666
83     109.20   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
84         NA   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
85         NA   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
86         NA   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
87      91.61   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
88      63.16   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
89      91.33   3.1045867 -0.38566248 -1.4927360 0.11739091 -3.634982
90         NA   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
91         NA   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
92         NA   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
93      68.61   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
94      73.44   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
95      78.32   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
96     101.92   2.8449094 -0.63487827 -2.1350669 0.17309044 -3.889008
97      80.26   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
98     107.85   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
99         NA   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
100        NA   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
101     72.56   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
102     95.57   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
103        NA   2.4069451 -1.17118298 -2.2181329 0.17801699 -3.944009
104        NA   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
105     52.11   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
106     69.74   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
107     93.51   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
108        NA   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
109        NA   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
110     72.61   2.6741486 -0.94160854 -2.2067423 0.17736688 -3.936277
111     90.42   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
112        NA   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
113        NA   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
114     94.15   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
115     90.11   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
116     62.97   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
117        NA   4.2017031  0.76546784 -0.9083699 0.23219455 -2.368550
118     85.44   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
119     97.94   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
120        NA   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
121    104.41   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
122     81.58   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
123        NA   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
124        NA   3.0540012 -0.51082562 -1.6359640 0.15615814 -3.492850
125     83.33   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
126        NA   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
127        NA   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
128     76.88   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
129     47.89   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
130        NA   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
131     87.03   3.4873751 -0.10536052 -1.3788326 0.17699689 -3.110456
132    125.95   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
133     83.27   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
134        NA   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
135        NA   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
136     66.48   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
137        NA   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
138    132.89   2.8507065 -0.99425227 -3.3238864 0.22062441 -4.835180
139        NA   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
140     75.56   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
141        NA   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
142    117.88   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
143     65.52   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
144        NA   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
145     91.54   3.0492730 -1.07880966 -3.2178905 0.18943117 -4.881620
146        NA   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
147     65.33   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
148     77.26   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
149        NA   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
150        NA   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
151    133.86   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
152     93.11   3.1570004 -1.10866262 -3.6548744 0.28439752 -4.912257
153        NA   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
154     89.10   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
155     54.11   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
156     86.78   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
157        NA   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
158        NA   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
159    126.90   2.7972813 -1.27296568 -3.3755708 0.21679430 -4.904377
160        NA   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
161     87.36   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
162        NA   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
163    109.78   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
164    145.89   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
165        NA   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
166     90.60   3.5055574 -0.69314718 -2.3555262 0.34791259 -3.411330
167        NA   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
168     92.78   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
169     79.12   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
170     94.92   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
171    139.72   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
172        NA   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
173        NA   3.4750672 -0.57981850 -2.4402754 0.30702495 -3.621102
174     77.97   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
175        NA   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
176     92.11   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
177    138.29   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
178        NA   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
179        NA   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
180     87.56   3.6988298 -0.63487827 -2.5704141 0.25060055 -3.954309
181     96.55   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
182     90.00   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
183        NA   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
184    137.97   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
185        NA   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
186     96.80   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
187        NA   3.1267605 -0.79850770 -2.8188200 0.16133292 -4.643105
188    134.81   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
189     58.00   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
190        NA   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
191        NA   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
192     84.67   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
193     88.53   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
194        NA   3.8712010 -0.43078292 -2.0165660 0.29038401 -3.253117
195        NA   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
196        NA   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
197        NA   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
198    117.78   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
199    132.12   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
200     97.18   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
201     92.53   3.9039908 -0.38566248 -1.8173600 0.22557569 -3.306459
202        NA   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
203        NA   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
204        NA   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
205     98.28   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
206     91.44   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
207    137.66   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
208     90.98   3.9512437 -0.16251893 -1.6506135 0.13768829 -3.633376
209        NA   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
210        NA   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
211        NA   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
212     92.34   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
213    132.91   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
214     94.74   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
215    108.89   3.8372995 -0.51082562 -1.7109028 0.06500092 -4.444257
216        NA   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
217        NA   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
218     98.64   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
220     94.74   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
221     98.67   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
222     90.23   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
223    108.37   2.5649494 -1.46967597 -3.0602039 0.22808615 -4.538236
224     82.03   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
225    115.94   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
226     89.10   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
227        NA   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
228        NA   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
229     81.61   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
231     83.91   2.6390573 -1.46967597 -2.9064446 0.20616803 -4.485508
232     92.86   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
233     83.28   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
234    113.04   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
235     93.87   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
236        NA   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
237        NA   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
238    104.22   3.2695689 -1.34707365 -2.6081966 0.15273297 -4.487261
240    110.14   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
241     96.24   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
242    104.70   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
243        NA   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
244     97.49   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
246     91.95   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
247        NA   2.2823824 -1.51412773 -2.5903371 0.14899842 -4.494157
248        NA   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
249        NA   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
250     92.15   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
251    107.57   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
252     98.85   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
253    100.00   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
254     86.47   3.4843123 -0.56211892 -2.0944336 0.19984180 -3.704663
256     96.38   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
257    140.42   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
258        NA   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
259    100.00   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
260        NA   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
261     92.53   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
262     94.92   3.3286267 -0.40047757 -1.6439616 0.10705720 -3.878354
264        NA   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
265     97.18   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
267     96.34   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
268     95.02   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
269        NA   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
270    126.25   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
271    113.27   3.4339872 -0.67334455 -2.1715576 0.21193823 -3.723018
272        NA   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
273    104.28   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
274        NA   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
276     94.25   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
277    102.07   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
278    119.16   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
279     99.28   3.1484534 -0.67334455 -2.0030331 0.18423357 -3.694584
280    108.69   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
281    130.60   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
282        NA   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
283     93.30   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
284     96.66   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
286    100.75   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
287        NA   3.6428355 -0.16251893 -1.5511331 0.13120470 -3.582130
288        NA   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
289        NA   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
290     97.51   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
291    111.65   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
292    128.34   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
293     85.16   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
294     99.69   3.5174978 -0.09431068 -1.2221855 0.10473925 -3.478467
296    130.43   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
297     93.42   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
298    106.17   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
299        NA   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
301     94.44   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
302        NA   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
303     88.06   3.5204608 -0.38566248 -1.2647377 0.13141530 -3.294130
304        NA   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
305    106.02   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
306    100.42   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
307     96.86   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
308    133.49   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
309     94.25   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
311        NA   4.0621657 -0.05129329 -1.2757306 0.21076772 -2.832729
312        NA   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
313        NA   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
315     86.01   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
316    104.08   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
317     69.73   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
318     80.08   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
319     91.63   2.6810215 -1.77195684 -3.8181685 0.18211399 -5.521291
320     66.34   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
321        NA   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
322        NA   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
323     67.05   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
324     61.28   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
326     94.25   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
327     81.18   3.0155349 -1.77195684 -3.7414147 0.22288952 -5.242494
328     98.91   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
329        NA   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
330     75.10   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
332        NA   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
333    110.97   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
334    129.31   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
335     94.92   3.5234150 -1.34707365 -3.8931747 0.14517478 -5.822992
336     88.90   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
338        NA   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
339     64.66   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
340        NA   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
341     65.52   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
342     71.26   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
343     75.85   2.8390785 -1.83258146 -3.6735278 0.26166020 -5.014236
344    100.10   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
345     86.78   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
346    135.27   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
347        NA   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
348        NA   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
349    114.85   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
350    106.63   4.2253728 -0.23572233 -2.0697768 0.21782370 -3.593846
352     99.69   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
353     97.89   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
354    145.25   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
355        NA   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
356    105.43   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
357    109.77   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
359        NA   3.9376908 -0.57981850 -2.3967665 0.21384349 -3.939277
360        NA   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
361    108.05   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
363     88.12   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
364    129.95   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
365     97.83   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
366    108.65   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
367        NA   3.5582011 -0.99425227 -2.6575735 0.21147919 -4.211202
368    109.17   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
369        NA   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
370     81.61   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
372    117.23   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
373    110.24   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
374    102.63   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
375        NA   3.7013020 -0.63487827 -2.6521244 0.21152273 -4.205547
376     89.46   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
377    113.99   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
378     98.22   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
379        NA   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
380    106.02   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
382    131.88   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
383        NA   4.3385971  0.07696104 -1.4624073 0.18550740 -3.147068
384     99.62   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
385    103.50   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
387        NA   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
388    143.00   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
389    111.18   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
390    113.35   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
391        NA   4.5174313  0.67803354 -1.2422076 0.13496530 -3.244945
392        NA   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
393     92.89   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
394     89.85   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
395    114.85   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
396    134.86   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
397        NA   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
398    132.21   4.2668963  0.11332869 -1.5757798 0.20749743 -3.148416
400        NA   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
401    128.47   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
402    107.89   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
403    110.14   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
404        NA   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
405     81.03   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
407    125.60   4.0656021  0.53649337 -2.1617951 0.28873132 -3.404054
    anavg_temp ansum_prec juvdev_prec juvdev_sun ansum_sun juvdev_temp
55        10.1     1035.6        0.23       0.22    1960.0        1.37
56        11.2      752.6       -0.36      -0.02    2105.7        0.40
57        11.3      725.8       -0.38       0.42    2019.7        1.00
58         9.5     1029.7        0.23       0.13    1692.1       -0.34
59        10.7      870.9       -0.35       0.18    1886.0        1.10
60        10.5      993.9       -0.25       0.44    1862.4        1.60
61        10.5      993.9       -0.25       0.44    1862.4        1.60
62        10.5      993.9       -0.25       0.44    1862.4        1.60
63        11.2      752.6       -0.36      -0.02    2105.7        0.40
64        11.3      725.8       -0.38       0.42    2019.7        1.00
65        10.7      870.9       -0.35       0.18    1886.0        1.10
66        10.5      993.9       -0.25       0.44    1862.4        1.60
67        10.1     1035.6        0.23       0.22    1960.0        1.37
68         9.5     1029.7        0.23       0.13    1692.1       -0.34
69        11.2      752.6       -0.36      -0.02    2105.7        0.40
70        10.5      993.9       -0.25       0.44    1862.4        1.60
71        10.5      993.9       -0.25       0.44    1862.4        1.60
72        10.1     1035.6        0.23       0.22    1960.0        1.37
73         9.5     1029.7        0.23       0.13    1692.1       -0.34
74        11.3      725.8       -0.38       0.42    2019.7        1.00
75        10.7      870.9       -0.35       0.18    1886.0        1.10
76        11.2      752.6       -0.36      -0.02    2105.7        0.40
77         9.5     1029.7        0.23       0.13    1692.1       -0.34
78        11.3      725.8       -0.38       0.42    2019.7        1.00
79        10.1     1035.6        0.23       0.22    1960.0        1.37
80        10.5      993.9       -0.25       0.44    1862.4        1.60
81        10.7      870.9       -0.35       0.18    1886.0        1.10
82        10.5      993.9       -0.25       0.44    1862.4        1.60
83        11.2      752.6       -0.36      -0.02    2105.7        0.40
84        10.5      993.9       -0.25       0.44    1862.4        1.60
85        10.7      870.9       -0.35       0.18    1886.0        1.10
86         9.5     1029.7        0.23       0.13    1692.1       -0.34
87        10.5      993.9       -0.25       0.44    1862.4        1.60
88        11.3      725.8       -0.38       0.42    2019.7        1.00
89        10.1     1035.6        0.23       0.22    1960.0        1.37
90        10.7      870.9       -0.35       0.18    1886.0        1.10
91        10.5      993.9       -0.25       0.44    1862.4        1.60
92         9.5     1029.7        0.23       0.13    1692.1       -0.34
93        11.3      725.8       -0.38       0.42    2019.7        1.00
94        10.1     1035.6        0.23       0.22    1960.0        1.37
95        10.5      993.9       -0.25       0.44    1862.4        1.60
96        11.2      752.6       -0.36      -0.02    2105.7        0.40
97        11.3      725.8       -0.38       0.42    2019.7        1.00
98        11.2      752.6       -0.36      -0.02    2105.7        0.40
99        10.5      993.9       -0.25       0.44    1862.4        1.60
100        9.5     1029.7        0.23       0.13    1692.1       -0.34
101       10.1     1035.6        0.23       0.22    1960.0        1.37
102       10.5      993.9       -0.25       0.44    1862.4        1.60
103       10.7      870.9       -0.35       0.18    1886.0        1.10
104        9.5     1029.7        0.23       0.13    1692.1       -0.34
105       10.1     1035.6        0.23       0.22    1960.0        1.37
106       11.3      725.8       -0.38       0.42    2019.7        1.00
107       10.5      993.9       -0.25       0.44    1862.4        1.60
108       10.5      993.9       -0.25       0.44    1862.4        1.60
109       10.7      870.9       -0.35       0.18    1886.0        1.10
110       11.2      752.6       -0.36      -0.02    2105.7        0.40
111       11.2      752.6       -0.36      -0.02    2105.7        0.40
112       10.7      870.9       -0.35       0.18    1886.0        1.10
113       10.5      993.9       -0.25       0.44    1862.4        1.60
114       10.5      993.9       -0.25       0.44    1862.4        1.60
115       10.1     1035.6        0.23       0.22    1960.0        1.37
116       11.3      725.8       -0.38       0.42    2019.7        1.00
117        9.5     1029.7        0.23       0.13    1692.1       -0.34
118       10.1     1035.6        0.23       0.22    1960.0        1.37
119       10.5      993.9       -0.25       0.44    1862.4        1.60
120        9.5     1029.7        0.23       0.13    1692.1       -0.34
121       11.2      752.6       -0.36      -0.02    2105.7        0.40
122       11.3      725.8       -0.38       0.42    2019.7        1.00
123       10.7      870.9       -0.35       0.18    1886.0        1.10
124       10.5      993.9       -0.25       0.44    1862.4        1.60
125       11.2      752.6       -0.36      -0.02    2105.7        0.40
126       10.5      993.9       -0.25       0.44    1862.4        1.60
127        9.5     1029.7        0.23       0.13    1692.1       -0.34
128       11.3      725.8       -0.38       0.42    2019.7        1.00
129       10.1     1035.6        0.23       0.22    1960.0        1.37
130       10.7      870.9       -0.35       0.18    1886.0        1.10
131       10.5      993.9       -0.25       0.44    1862.4        1.60
132       10.2     1063.5       -0.25       0.28    1758.6        1.27
133       11.2     1047.7       -0.08       0.50    2022.8        1.10
134       10.2     1063.5       -0.25       0.28    1758.6        1.27
135        9.3     1390.5        0.52       0.07    1589.4       -0.14
136       10.8     1013.6       -0.45      -0.24    1768.3        0.43
137       10.6      980.7       -0.25       0.35    1890.3        1.24
138        9.9     1076.4       -0.10       0.19    1748.2        1.70
139        9.3     1390.5        0.52       0.07    1589.4       -0.14
140        9.9     1076.4       -0.10       0.19    1748.2        1.70
141       10.6      980.7       -0.25       0.35    1890.3        1.24
142       10.2     1063.5       -0.25       0.28    1758.6        1.27
143       10.8     1013.6       -0.45      -0.24    1768.3        0.43
144       10.2     1063.5       -0.25       0.28    1758.6        1.27
145       11.2     1047.7       -0.08       0.50    2022.8        1.10
146        9.3     1390.5        0.52       0.07    1589.4       -0.14
147       10.8     1013.6       -0.45      -0.24    1768.3        0.43
148       11.2     1047.7       -0.08       0.50    2022.8        1.10
149       10.2     1063.5       -0.25       0.28    1758.6        1.27
150       10.6      980.7       -0.25       0.35    1890.3        1.24
151       10.2     1063.5       -0.25       0.28    1758.6        1.27
152        9.9     1076.4       -0.10       0.19    1748.2        1.70
153       10.6      980.7       -0.25       0.35    1890.3        1.24
154       11.2     1047.7       -0.08       0.50    2022.8        1.10
155        9.9     1076.4       -0.10       0.19    1748.2        1.70
156       10.8     1013.6       -0.45      -0.24    1768.3        0.43
157       10.2     1063.5       -0.25       0.28    1758.6        1.27
158        9.3     1390.5        0.52       0.07    1589.4       -0.14
159       10.2     1063.5       -0.25       0.28    1758.6        1.27
160        9.3     1390.5        0.52       0.07    1589.4       -0.14
161       10.8     1013.6       -0.45      -0.24    1768.3        0.43
162       10.2     1063.5       -0.25       0.28    1758.6        1.27
163        9.9     1076.4       -0.10       0.19    1748.2        1.70
164       10.2     1063.5       -0.25       0.28    1758.6        1.27
165       10.6      980.7       -0.25       0.35    1890.3        1.24
166       11.2     1047.7       -0.08       0.50    2022.8        1.10
167       10.6      980.7       -0.25       0.35    1890.3        1.24
168        9.9     1076.4       -0.10       0.19    1748.2        1.70
169       10.8     1013.6       -0.45      -0.24    1768.3        0.43
170       11.2     1047.7       -0.08       0.50    2022.8        1.10
171       10.2     1063.5       -0.25       0.28    1758.6        1.27
172        9.3     1390.5        0.52       0.07    1589.4       -0.14
173       10.2     1063.5       -0.25       0.28    1758.6        1.27
174       10.8     1013.6       -0.45      -0.24    1768.3        0.43
175       10.6      980.7       -0.25       0.35    1890.3        1.24
176       11.2     1047.7       -0.08       0.50    2022.8        1.10
177       10.2     1063.5       -0.25       0.28    1758.6        1.27
178        9.3     1390.5        0.52       0.07    1589.4       -0.14
179       10.2     1063.5       -0.25       0.28    1758.6        1.27
180        9.9     1076.4       -0.10       0.19    1748.2        1.70
181       10.8     1013.6       -0.45      -0.24    1768.3        0.43
182        9.9     1076.4       -0.10       0.19    1748.2        1.70
183        9.3     1390.5        0.52       0.07    1589.4       -0.14
184       10.2     1063.5       -0.25       0.28    1758.6        1.27
185       10.6      980.7       -0.25       0.35    1890.3        1.24
186       11.2     1047.7       -0.08       0.50    2022.8        1.10
187       10.2     1063.5       -0.25       0.28    1758.6        1.27
188       10.2     1063.5       -0.25       0.28    1758.6        1.27
189        9.9     1076.4       -0.10       0.19    1748.2        1.70
190        9.3     1390.5        0.52       0.07    1589.4       -0.14
191       10.6      980.7       -0.25       0.35    1890.3        1.24
192       10.8     1013.6       -0.45      -0.24    1768.3        0.43
193       11.2     1047.7       -0.08       0.50    2022.8        1.10
194       10.2     1063.5       -0.25       0.28    1758.6        1.27
195       10.6      980.7       -0.25       0.35    1890.3        1.24
196        9.3     1390.5        0.52       0.07    1589.4       -0.14
197       10.2     1063.5       -0.25       0.28    1758.6        1.27
198        9.9     1076.4       -0.10       0.19    1748.2        1.70
199       10.2     1063.5       -0.25       0.28    1758.6        1.27
200       11.2     1047.7       -0.08       0.50    2022.8        1.10
201       10.8     1013.6       -0.45      -0.24    1768.3        0.43
202       10.6      980.7       -0.25       0.35    1890.3        1.24
203       10.2     1063.5       -0.25       0.28    1758.6        1.27
204        9.3     1390.5        0.52       0.07    1589.4       -0.14
205       10.8     1013.6       -0.45      -0.24    1768.3        0.43
206        9.9     1076.4       -0.10       0.19    1748.2        1.70
207       10.2     1063.5       -0.25       0.28    1758.6        1.27
208       11.2     1047.7       -0.08       0.50    2022.8        1.10
209        9.3     1390.5        0.52       0.07    1589.4       -0.14
210       10.6      980.7       -0.25       0.35    1890.3        1.24
211       10.2     1063.5       -0.25       0.28    1758.6        1.27
212       10.8     1013.6       -0.45      -0.24    1768.3        0.43
213       10.2     1063.5       -0.25       0.28    1758.6        1.27
214       11.2     1047.7       -0.08       0.50    2022.8        1.10
215        9.9     1076.4       -0.10       0.19    1748.2        1.70
216        9.6     1072.9        0.21       0.14    1674.8       -0.28
217       10.9      856.3       -0.03       0.55    1974.4        3.07
218       10.3      919.3       -0.25       0.18    1748.3        2.00
220       11.4      836.8       -0.21       0.43    2078.9        1.03
221       10.6      972.1       -0.19       0.05    1828.8        0.43
222       11.2      900.8       -0.46      -0.09    1855.8        0.30
223       10.9      856.3       -0.03       0.55    1974.4        3.07
224       10.6      972.1       -0.19       0.05    1828.8        0.43
225       10.9      856.3       -0.03       0.55    1974.4        3.07
226       11.4      836.8       -0.21       0.43    2078.9        1.03
227        9.6     1072.9        0.21       0.14    1674.8       -0.28
228       10.9      856.3       -0.03       0.55    1974.4        3.07
229       11.2      900.8       -0.46      -0.09    1855.8        0.30
231       10.3      919.3       -0.25       0.18    1748.3        2.00
232       11.4      836.8       -0.21       0.43    2078.9        1.03
233       10.3      919.3       -0.25       0.18    1748.3        2.00
234       10.9      856.3       -0.03       0.55    1974.4        3.07
235       11.2      900.8       -0.46      -0.09    1855.8        0.30
236        9.6     1072.9        0.21       0.14    1674.8       -0.28
237       10.9      856.3       -0.03       0.55    1974.4        3.07
238       10.6      972.1       -0.19       0.05    1828.8        0.43
240       10.9      856.3       -0.03       0.55    1974.4        3.07
241       11.4      836.8       -0.21       0.43    2078.9        1.03
242       10.6      972.1       -0.19       0.05    1828.8        0.43
243       10.9      856.3       -0.03       0.55    1974.4        3.07
244       10.3      919.3       -0.25       0.18    1748.3        2.00
246       11.2      900.8       -0.46      -0.09    1855.8        0.30
247        9.6     1072.9        0.21       0.14    1674.8       -0.28
248        9.6     1072.9        0.21       0.14    1674.8       -0.28
249       10.9      856.3       -0.03       0.55    1974.4        3.07
250       11.2      900.8       -0.46      -0.09    1855.8        0.30
251       10.9      856.3       -0.03       0.55    1974.4        3.07
252       10.3      919.3       -0.25       0.18    1748.3        2.00
253       10.6      972.1       -0.19       0.05    1828.8        0.43
254       11.4      836.8       -0.21       0.43    2078.9        1.03
256       10.6      972.1       -0.19       0.05    1828.8        0.43
257       10.9      856.3       -0.03       0.55    1974.4        3.07
258       10.9      856.3       -0.03       0.55    1974.4        3.07
259       10.3      919.3       -0.25       0.18    1748.3        2.00
260        9.6     1072.9        0.21       0.14    1674.8       -0.28
261       11.2      900.8       -0.46      -0.09    1855.8        0.30
262       11.4      836.8       -0.21       0.43    2078.9        1.03
264        9.6     1072.9        0.21       0.14    1674.8       -0.28
265       11.4      836.8       -0.21       0.43    2078.9        1.03
267       10.3      919.3       -0.25       0.18    1748.3        2.00
268       11.2      900.8       -0.46      -0.09    1855.8        0.30
269       10.9      856.3       -0.03       0.55    1974.4        3.07
270       10.9      856.3       -0.03       0.55    1974.4        3.07
271       10.6      972.1       -0.19       0.05    1828.8        0.43
272       10.9      856.3       -0.03       0.55    1974.4        3.07
273       10.3      919.3       -0.25       0.18    1748.3        2.00
274        9.6     1072.9        0.21       0.14    1674.8       -0.28
276       11.2      900.8       -0.46      -0.09    1855.8        0.30
277       11.4      836.8       -0.21       0.43    2078.9        1.03
278       10.9      856.3       -0.03       0.55    1974.4        3.07
279       10.6      972.1       -0.19       0.05    1828.8        0.43
280       10.6      972.1       -0.19       0.05    1828.8        0.43
281       10.9      856.3       -0.03       0.55    1974.4        3.07
282        9.6     1072.9        0.21       0.14    1674.8       -0.28
283       11.2      900.8       -0.46      -0.09    1855.8        0.30
284       10.3      919.3       -0.25       0.18    1748.3        2.00
286       11.4      836.8       -0.21       0.43    2078.9        1.03
287       10.9      856.3       -0.03       0.55    1974.4        3.07
288       10.9      856.3       -0.03       0.55    1974.4        3.07
289        9.6     1072.9        0.21       0.14    1674.8       -0.28
290       11.2      900.8       -0.46      -0.09    1855.8        0.30
291       11.4      836.8       -0.21       0.43    2078.9        1.03
292       10.9      856.3       -0.03       0.55    1974.4        3.07
293       10.6      972.1       -0.19       0.05    1828.8        0.43
294       10.3      919.3       -0.25       0.18    1748.3        2.00
296       10.9      856.3       -0.03       0.55    1974.4        3.07
297       11.4      836.8       -0.21       0.43    2078.9        1.03
298       10.3      919.3       -0.25       0.18    1748.3        2.00
299        9.6     1072.9        0.21       0.14    1674.8       -0.28
301       11.2      900.8       -0.46      -0.09    1855.8        0.30
302       10.9      856.3       -0.03       0.55    1974.4        3.07
303       10.6      972.1       -0.19       0.05    1828.8        0.43
304        9.6     1072.9        0.21       0.14    1674.8       -0.28
305       11.4      836.8       -0.21       0.43    2078.9        1.03
306       10.3      919.3       -0.25       0.18    1748.3        2.00
307       10.6      972.1       -0.19       0.05    1828.8        0.43
308       10.9      856.3       -0.03       0.55    1974.4        3.07
309       11.2      900.8       -0.46      -0.09    1855.8        0.30
311       10.9      856.3       -0.03       0.55    1974.4        3.07
312       10.9      856.3       -0.03       0.55    1974.4        3.07
313        9.6     1072.9        0.21       0.14    1674.8       -0.28
315       10.6      972.1       -0.19       0.05    1828.8        0.43
316       10.3      919.3       -0.25       0.18    1748.3        2.00
317       11.2      900.8       -0.46      -0.09    1855.8        0.30
318       11.4      836.8       -0.21       0.43    2078.9        1.03
319       10.9      856.3       -0.03       0.55    1974.4        3.07
320       10.9      856.3       -0.03       0.55    1974.4        3.07
321        9.6     1072.9        0.21       0.14    1674.8       -0.28
322       10.9      856.3       -0.03       0.55    1974.4        3.07
323       11.2      900.8       -0.46      -0.09    1855.8        0.30
324       11.4      836.8       -0.21       0.43    2078.9        1.03
326       10.3      919.3       -0.25       0.18    1748.3        2.00
327       10.6      972.1       -0.19       0.05    1828.8        0.43
328       10.6      972.1       -0.19       0.05    1828.8        0.43
329       10.9      856.3       -0.03       0.55    1974.4        3.07
330       11.2      900.8       -0.46      -0.09    1855.8        0.30
332        9.6     1072.9        0.21       0.14    1674.8       -0.28
333       10.3      919.3       -0.25       0.18    1748.3        2.00
334       10.9      856.3       -0.03       0.55    1974.4        3.07
335       11.4      836.8       -0.21       0.43    2078.9        1.03
336       10.6      972.1       -0.19       0.05    1828.8        0.43
338        9.6     1072.9        0.21       0.14    1674.8       -0.28
339       11.4      836.8       -0.21       0.43    2078.9        1.03
340       10.9      856.3       -0.03       0.55    1974.4        3.07
341       11.2      900.8       -0.46      -0.09    1855.8        0.30
342       10.3      919.3       -0.25       0.18    1748.3        2.00
343       10.9      856.3       -0.03       0.55    1974.4        3.07
344       10.3      919.3       -0.25       0.18    1748.3        2.00
345       11.2      900.8       -0.46      -0.09    1855.8        0.30
346       10.9      856.3       -0.03       0.55    1974.4        3.07
347        9.6     1072.9        0.21       0.14    1674.8       -0.28
348       10.9      856.3       -0.03       0.55    1974.4        3.07
349       11.4      836.8       -0.21       0.43    2078.9        1.03
350       10.6      972.1       -0.19       0.05    1828.8        0.43
352       10.3      919.3       -0.25       0.18    1748.3        2.00
353       11.2      900.8       -0.46      -0.09    1855.8        0.30
354       10.9      856.3       -0.03       0.55    1974.4        3.07
355        9.6     1072.9        0.21       0.14    1674.8       -0.28
356       10.6      972.1       -0.19       0.05    1828.8        0.43
357       11.4      836.8       -0.21       0.43    2078.9        1.03
359       10.9      856.3       -0.03       0.55    1974.4        3.07
360        9.6     1072.9        0.21       0.14    1674.8       -0.28
361       10.3      919.3       -0.25       0.18    1748.3        2.00
363       11.2      900.8       -0.46      -0.09    1855.8        0.30
364       10.9      856.3       -0.03       0.55    1974.4        3.07
365       10.6      972.1       -0.19       0.05    1828.8        0.43
366       11.4      836.8       -0.21       0.43    2078.9        1.03
367       10.9      856.3       -0.03       0.55    1974.4        3.07
368       10.6      972.1       -0.19       0.05    1828.8        0.43
369        9.6     1072.9        0.21       0.14    1674.8       -0.28
370       11.2      900.8       -0.46      -0.09    1855.8        0.30
372       10.9      856.3       -0.03       0.55    1974.4        3.07
373       10.3      919.3       -0.25       0.18    1748.3        2.00
374       11.4      836.8       -0.21       0.43    2078.9        1.03
375       10.9      856.3       -0.03       0.55    1974.4        3.07
376       11.2      900.8       -0.46      -0.09    1855.8        0.30
377       10.6      972.1       -0.19       0.05    1828.8        0.43
378       10.3      919.3       -0.25       0.18    1748.3        2.00
379        9.6     1072.9        0.21       0.14    1674.8       -0.28
380       11.4      836.8       -0.21       0.43    2078.9        1.03
382       10.9      856.3       -0.03       0.55    1974.4        3.07
383       10.9      856.3       -0.03       0.55    1974.4        3.07
384       11.2      900.8       -0.46      -0.09    1855.8        0.30
385       10.6      972.1       -0.19       0.05    1828.8        0.43
387        9.6     1072.9        0.21       0.14    1674.8       -0.28
388       10.9      856.3       -0.03       0.55    1974.4        3.07
389       10.3      919.3       -0.25       0.18    1748.3        2.00
390       11.4      836.8       -0.21       0.43    2078.9        1.03
391       10.9      856.3       -0.03       0.55    1974.4        3.07
392        9.6     1072.9        0.21       0.14    1674.8       -0.28
393       10.3      919.3       -0.25       0.18    1748.3        2.00
394       11.2      900.8       -0.46      -0.09    1855.8        0.30
395       11.4      836.8       -0.21       0.43    2078.9        1.03
396       10.6      972.1       -0.19       0.05    1828.8        0.43
397       10.9      856.3       -0.03       0.55    1974.4        3.07
398       10.9      856.3       -0.03       0.55    1974.4        3.07
400       10.9      856.3       -0.03       0.55    1974.4        3.07
401       10.6      972.1       -0.19       0.05    1828.8        0.43
402       11.4      836.8       -0.21       0.43    2078.9        1.03
403       10.3      919.3       -0.25       0.18    1748.3        2.00
404        9.6     1072.9        0.21       0.14    1674.8       -0.28
405       11.2      900.8       -0.46      -0.09    1855.8        0.30
407       10.9      856.3       -0.03       0.55    1974.4        3.07
    NA_weather
55       FALSE
56       FALSE
57       FALSE
58       FALSE
59       FALSE
60       FALSE
61       FALSE
62       FALSE
63       FALSE
64       FALSE
65       FALSE
66       FALSE
67       FALSE
68       FALSE
69       FALSE
70       FALSE
71       FALSE
72       FALSE
73       FALSE
74       FALSE
75       FALSE
76       FALSE
77       FALSE
78       FALSE
79       FALSE
80       FALSE
81       FALSE
82       FALSE
83       FALSE
84       FALSE
85       FALSE
86       FALSE
87       FALSE
88       FALSE
89       FALSE
90       FALSE
91       FALSE
92       FALSE
93       FALSE
94       FALSE
95       FALSE
96       FALSE
97       FALSE
98       FALSE
99       FALSE
100      FALSE
101      FALSE
102      FALSE
103      FALSE
104      FALSE
105      FALSE
106      FALSE
107      FALSE
108      FALSE
109      FALSE
110      FALSE
111      FALSE
112      FALSE
113      FALSE
114      FALSE
115      FALSE
116      FALSE
117      FALSE
118      FALSE
119      FALSE
120      FALSE
121      FALSE
122      FALSE
123      FALSE
124      FALSE
125      FALSE
126      FALSE
127      FALSE
128      FALSE
129      FALSE
130      FALSE
131      FALSE
132      FALSE
133      FALSE
134      FALSE
135      FALSE
136      FALSE
137      FALSE
138      FALSE
139      FALSE
140      FALSE
141      FALSE
142      FALSE
143      FALSE
144      FALSE
145      FALSE
146      FALSE
147      FALSE
148      FALSE
149      FALSE
150      FALSE
151      FALSE
152      FALSE
153      FALSE
154      FALSE
155      FALSE
156      FALSE
157      FALSE
158      FALSE
159      FALSE
160      FALSE
161      FALSE
162      FALSE
163      FALSE
164      FALSE
165      FALSE
166      FALSE
167      FALSE
168      FALSE
169      FALSE
170      FALSE
171      FALSE
172      FALSE
173      FALSE
174      FALSE
175      FALSE
176      FALSE
177      FALSE
178      FALSE
179      FALSE
180      FALSE
181      FALSE
182      FALSE
183      FALSE
184      FALSE
185      FALSE
186      FALSE
187      FALSE
188      FALSE
189      FALSE
190      FALSE
191      FALSE
192      FALSE
193      FALSE
194      FALSE
195      FALSE
196      FALSE
197      FALSE
198      FALSE
199      FALSE
200      FALSE
201      FALSE
202      FALSE
203      FALSE
204      FALSE
205      FALSE
206      FALSE
207      FALSE
208      FALSE
209      FALSE
210      FALSE
211      FALSE
212      FALSE
213      FALSE
214      FALSE
215      FALSE
216      FALSE
217      FALSE
218      FALSE
220      FALSE
221      FALSE
222      FALSE
223      FALSE
224      FALSE
225      FALSE
226      FALSE
227      FALSE
228      FALSE
229      FALSE
231      FALSE
232      FALSE
233      FALSE
234      FALSE
235      FALSE
236      FALSE
237      FALSE
238      FALSE
240      FALSE
241      FALSE
242      FALSE
243      FALSE
244      FALSE
246      FALSE
247      FALSE
248      FALSE
249      FALSE
250      FALSE
251      FALSE
252      FALSE
253      FALSE
254      FALSE
256      FALSE
257      FALSE
258      FALSE
259      FALSE
260      FALSE
261      FALSE
262      FALSE
264      FALSE
265      FALSE
267      FALSE
268      FALSE
269      FALSE
270      FALSE
271      FALSE
272      FALSE
273      FALSE
274      FALSE
276      FALSE
277      FALSE
278      FALSE
279      FALSE
280      FALSE
281      FALSE
282      FALSE
283      FALSE
284      FALSE
286      FALSE
287      FALSE
288      FALSE
289      FALSE
290      FALSE
291      FALSE
292      FALSE
293      FALSE
294      FALSE
296      FALSE
297      FALSE
298      FALSE
299      FALSE
301      FALSE
302      FALSE
303      FALSE
304      FALSE
305      FALSE
306      FALSE
307      FALSE
308      FALSE
309      FALSE
311      FALSE
312      FALSE
313      FALSE
315      FALSE
316      FALSE
317      FALSE
318      FALSE
319      FALSE
320      FALSE
321      FALSE
322      FALSE
323      FALSE
324      FALSE
326      FALSE
327      FALSE
328      FALSE
329      FALSE
330      FALSE
332      FALSE
333      FALSE
334      FALSE
335      FALSE
336      FALSE
338      FALSE
339      FALSE
340      FALSE
341      FALSE
342      FALSE
343      FALSE
344      FALSE
345      FALSE
346      FALSE
347      FALSE
348      FALSE
349      FALSE
350      FALSE
352      FALSE
353      FALSE
354      FALSE
355      FALSE
356      FALSE
357      FALSE
359      FALSE
360      FALSE
361      FALSE
363      FALSE
364      FALSE
365      FALSE
366      FALSE
367      FALSE
368      FALSE
369      FALSE
370      FALSE
372      FALSE
373      FALSE
374      FALSE
375      FALSE
376      FALSE
377      FALSE
378      FALSE
379      FALSE
380      FALSE
382      FALSE
383      FALSE
384      FALSE
385      FALSE
387      FALSE
388      FALSE
389      FALSE
390      FALSE
391      FALSE
392      FALSE
393      FALSE
394      FALSE
395      FALSE
396      FALSE
397      FALSE
398      FALSE
400      FALSE
401      FALSE
402      FALSE
403      FALSE
404      FALSE
405      FALSE
407      FALSE</code></pre>
</div>
</div></div>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>we used machine learning methods to assess how much information different sets of variables (c.f. <code>P_var_sets</code>) have each on the dependent variable (Puptake, Y-rel, P-balance), how redundant this information is. The machine learning methods to quantify the predictive power of different variable sets are: i) ordinary least squares (OLS) as a baseline; ii) XGBoost (gradient boosting with tree-based models and hyperparameter tuning for learning rate and tree depth) (arxiv:1603.02754); iii) Random Forests (with default parameters) (doi:10.1023/A:1010933404324). Computations were performed using the mlr3 framework (doi:10.21105/joss.01903). Performance was measured as percentage of explained variance on hold-out data via 5-fold cross-validation, calculated as (1 - MSE/Variance(y)), where MSE represents mean squared error.</p>
<p>We tried adjusting for weather variables but it seems that the ML-methods rather reconstruct the site-specific patterns….</p>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>