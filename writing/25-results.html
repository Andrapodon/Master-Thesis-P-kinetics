<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="25-results_files/libs/clipboard/clipboard.min.js"></script>
<script src="25-results_files/libs/quarto-html/quarto.js"></script>
<script src="25-results_files/libs/quarto-html/popper.min.js"></script>
<script src="25-results_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="25-results_files/libs/quarto-html/anchor.min.js"></script>
<link href="25-results_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="25-results_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="25-results_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="25-results_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="25-results_files/libs/bootstrap/bootstrap-da28b95b2c8e9f4c91248a4d30485f58.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="results" class="level1">
<h1>Results</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>create_coef_table <span class="ot">&lt;-</span> <span class="cf">function</span>(lmer_models, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">covariate_order =</span> <span class="cn">NULL</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">covariate_labels =</span> <span class="cn">NULL</span>, <span class="co"># NEU: Benannter Vektor für Zeilennamen</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">model_labels =</span> <span class="cn">NULL</span>) {   <span class="co"># NEU: Benannter Vektor für Spaltennamen</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract coefficients and p-values (Ihre Originalfunktion, keine Änderung hier)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  extract_coef_info <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (keine Änderung, Ihr Code bleibt hier)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    coef_matrix <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">|&gt;</span> <span class="fu">coef</span>()</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> coef_matrix[, <span class="dv">1</span>]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    p_values <span class="ot">&lt;-</span> coef_matrix[, <span class="fu">ncol</span>(coef_matrix)]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    formatted_coef <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_along</span>(estimates), <span class="cf">function</span>(i) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      est_str <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, estimates[i])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      stars <span class="ot">&lt;-</span> <span class="cf">if</span> (p_values[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="st">"***"</span> <span class="cf">else</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span> (p_values[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="st">"** "</span> <span class="cf">else</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span> (p_values[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="st">"* "</span> <span class="cf">else</span>  <span class="st">""</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(stars, est_str)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(formatted_coef) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coef_matrix)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(formatted_coef)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract R-squared values (Ihre Originalfunktion, keine Änderung hier)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  extract_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (keine Änderung, Ihr Code bleibt hier)</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    r2_values <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">r.squaredGLMM</span>(model) <span class="co"># MuMIn:: hinzugefügt für Klarheit</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2m =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, r2_values[<span class="dv">1</span>, <span class="st">"R2m"</span>]),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2c =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, r2_values[<span class="dv">1</span>, <span class="st">"R2c"</span>])</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Daten extrahieren (Ihr Originalcode)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  all_coefs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lmer_models, extract_coef_info)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  all_r_squared <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lmer_models, extract_r_squared)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  all_covariate_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(all_coefs, names)))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(covariate_order)) {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    covariate_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="fu">sort</span>(all_covariate_names[all_covariate_names <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]))</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  covariate_order <span class="ot">&lt;-</span> covariate_order[covariate_order <span class="sc">%in%</span> all_covariate_names]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  final_order <span class="ot">&lt;-</span> <span class="fu">c</span>(covariate_order, <span class="st">"R2m"</span>, <span class="st">"R2c"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Matrix erstellen (Ihr Originalcode)</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  results_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">""</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">nrow =</span> <span class="fu">length</span>(final_order),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="fu">length</span>(lmer_models),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dimnames =</span> <span class="fu">list</span>(final_order, <span class="fu">names</span>(lmer_models)))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Matrix füllen (Ihr Originalcode)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(lmer_models)) {</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    model_coefs <span class="ot">&lt;-</span> all_coefs[[model_name]]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (covar <span class="cf">in</span> <span class="fu">names</span>(model_coefs)) {</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (covar <span class="sc">%in%</span> covariate_order) {</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        results_matrix[covar, model_name] <span class="ot">&lt;-</span> model_coefs[covar]</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    r2_values <span class="ot">&lt;-</span> all_r_squared[[model_name]]</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    results_matrix[<span class="st">"R2m"</span>, model_name] <span class="ot">&lt;-</span> r2_values[<span class="st">"R2m"</span>]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    results_matrix[<span class="st">"R2c"</span>, model_name] <span class="ot">&lt;-</span> r2_values[<span class="st">"R2c"</span>]</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- NEU: Zeilen- und Spaltennamen ersetzen ---</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ersetze die Zeilennamen (Kovariaten), falls covariate_labels übergeben wurde</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(covariate_labels)) {</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finde die Übereinstimmungen in den aktuellen Zeilennamen</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    row_matches <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(results_matrix), <span class="fu">names</span>(covariate_labels))</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ersetze nur die, die gefunden wurden</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    new_rownames <span class="ot">&lt;-</span> <span class="fu">rownames</span>(results_matrix)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    new_rownames[<span class="sc">!</span><span class="fu">is.na</span>(row_matches)] <span class="ot">&lt;-</span> covariate_labels[row_matches[<span class="sc">!</span><span class="fu">is.na</span>(row_matches)]]</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(results_matrix) <span class="ot">&lt;-</span> new_rownames</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ersetze die Spaltennamen (Modelle), falls model_labels übergeben wurde</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(model_labels)) {</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    col_matches <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">colnames</span>(results_matrix), <span class="fu">names</span>(model_labels))</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    new_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(results_matrix)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    new_colnames[<span class="sc">!</span><span class="fu">is.na</span>(col_matches)] <span class="ot">&lt;-</span> model_labels[col_matches[<span class="sc">!</span><span class="fu">is.na</span>(col_matches)]]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(results_matrix) <span class="ot">&lt;-</span> new_colnames</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Ende der neuen Sektion ---</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to data frame for kable</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Covariate =</span> <span class="fu">rownames</span>(results_matrix),</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                           results_matrix,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                           <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="co"># Verhindert, dass R Spaltennamen ändert</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                           <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  results_df</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results of this study are presented in two main parts. First, the development and validation of the phosphorus (P) desorption kinetic model are detailed, justifying the final modeling approach. Second, the descriptive trends of both agronomic outcomes and soil P parameters in response to long-term fertilization and site differences are explored visually. Finally, the predictive power of the kinetic and standard P parameters is formally evaluated using linear mixed-effects models.</p>
<section id="establishment-of-the-p-desorption-kinetic-model" class="level2">
<h2 class="anchored" data-anchor-id="establishment-of-the-p-desorption-kinetic-model">Establishment of the P-Desorption Kinetic Model</h2>
<p>The primary goal was to derive two key parameters for each soil sample: the desorbable P pool (<span class="math inline">\(P_{desorb}\)</span>) and the rate constant (<span class="math inline">\(k\)</span>). The analysis proceeded in two stages: an initial test of a linearized model, followed by the implementation of a more robust non-linear model.</p>
<section id="initial-approach-failure-of-the-linearized-model" class="level3">
<h3 class="anchored" data-anchor-id="initial-approach-failure-of-the-linearized-model">Initial Approach: Failure of the Linearized Model</h3>
<p>Following the conceptual framework of Flossmann and Richter (1982), the first-order kinetic equation was linearized. A core assumption of this model is that the linear relationship must pass through the origin. To test this, linear models were fitted to the transformed data for each sample individually. The results revealed a systematic failure of this assumption, as the estimated intercepts for the majority of samples were highly significantly different from zero (p &lt; 0.05). This consistent statistical deviation indicated that the linearized approach was not a valid representation of the data. The visual evidence in Figure 3.1 supports this conclusion.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-linearized-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearized-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-linearized-model-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearized-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Test of the linearized first-order kinetic model. The plot visually supports the statistical finding that many intercepts are not zero.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="final-approach-successful-non-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="final-approach-successful-non-linear-model">Final Approach: Successful Non-Linear Model</h3>
<p>Given the statistical failure of the linearized model, a direct non-linear modeling approach was adopted to estimate both <span class="math inline">\(P_{desorb}\)</span> and <span class="math inline">\(k\)</span> simultaneously from the untransformed data. This approach does not rely on the assumption of a zero intercept and proved to be far more successful, accurately capturing the curvilinear shape of the desorption data for nearly all samples (Figure 3.2). The final parameters were extracted from a non-linear mixed-effects model (<code>nlme</code>) to account for the hierarchical data structure. <strong>These final <code>nlme</code>-derived coefficients were used for all subsequent analyses.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nonlinear-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nonlinear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-nonlinear-model-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonlinear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Non-linear first-order kinetic model fits for P desorption over time. Points represent measured data and solid lines represent the fitted model for each replicate.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="comparison-with-isotopic-exchange-kinetics-iek" class="level2">
<h2 class="anchored" data-anchor-id="comparison-with-isotopic-exchange-kinetics-iek">Comparison with Isotopic Exchange Kinetics (IEK)</h2>
<p>To validate the newly derived kinetic parameters against an established benchmark, the capacity (<span class="math inline">\(P_{desorb}\)</span>) and kinetic (<span class="math inline">\(k\)</span>) parameters were compared to data from Isotopic Exchange Kinetics (IEK) studies previously conducted on the same long-term trial sites by Demaria et al.&nbsp;(2013). This comparison aims to determine if the simpler, non-equilibrium desorption method used in this thesis captures similar aspects of soil P dynamics as the more complex, equilibrium-based IEK method.</p>
<p>The size of the desorbable P pool (<span class="math inline">\(P_{desorb}\)</span>) was compared against the long-term isotopically exchangeable P pool measured after 7 days (<span class="math inline">\(E_{exp\_10080}\)</span>). The desorption rate constant (<span class="math inline">\(k\)</span>) was compared against the IEK kinetic parameter measured after 24 hours (<span class="math inline">\(n_{1440}\)</span>). Spearman’s rank correlation was used to robustly test for monotonic trends between the different methods.</p>
<div id="fig-iek-comparison" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iek-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-iek-comparison" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-iek-comparison-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-iek-comparison-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-iek-comparison-1.png" class="img-fluid figure-img" data-ref-parent="fig-iek-comparison">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-iek-comparison-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Capacity: P_desorb vs E_7d
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-iek-comparison" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-iek-comparison-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-iek-comparison-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-iek-comparison-2.png" class="img-fluid figure-img" data-ref-parent="fig-iek-comparison">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-iek-comparison-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Kinetics: k vs n_1d
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iek-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Correlation between desorption-derived kinetic parameters and IEK-derived parameters. (A) Capacity parameters: Desorbable P (<span class="math inline">\(P_{desorb}\)</span>) vs.&nbsp;Isotopically Exchangeable P (<span class="math inline">\(E_{7d}\)</span>). (B) Kinetic parameters: Rate Constant (<span class="math inline">\(k\)</span>) vs.&nbsp;IEK kinetic parameter (<span class="math inline">\(n_{1d}\)</span>).
</figcaption>
</figure>
</div>
<p>The analysis revealed a statistically significant, moderate positive correlation between the capacity parameters, <span class="math inline">\(P_{desorb}\)</span> and <span class="math inline">\(E_{exp\_10080}\)</span> (Figure 3.5A). The Spearman’s rank correlation coefficient was 0.4 with a p-value of &lt; 0.001.</p>
<p>Similarly, a statistically significant, moderate positive correlation was found between the kinetic parameters, <span class="math inline">\(k\)</span> and <span class="math inline">\(n_{1440}\)</span> (Figure 3.5B). The Spearman’s rank correlation coefficient was 0.36 with a p-value of &lt; 0.001.</p>
<p>These results indicate that the simpler, non-equilibrium desorption method used in this study successfully captures both the capacity and intensity aspects of soil P lability, providing results that are consistent with the more complex, equilibrium-based IEK method reported by Demaria et al.&nbsp;(2013).</p>
</section>
<section id="effects-of-fertilization-on-agronomic-and-soil-parameters" class="level2">
<h2 class="anchored" data-anchor-id="effects-of-fertilization-on-agronomic-and-soil-parameters">Effects of Fertilization on Agronomic and Soil Parameters</h2>
<p>Having established a robust method to determine the kinetic parameters, the next step was to explore the effects of the long-term P fertilization treatments on both the agronomic outcomes and the soil P test parameters.</p>
<section id="agronomic-responses-to-p-fertilization" class="level3">
<h3 class="anchored" data-anchor-id="agronomic-responses-to-p-fertilization">Agronomic Responses to P Fertilization</h3>
<p>The long-term application of different P fertilization levels had a pronounced impact on the primary agronomic outcomes, including two different metrics for yield, P Uptake (<span class="math inline">\(P_{up}\)</span>), and P Balance (<span class="math inline">\(P_{bal}\)</span>), though the response varied considerably between sites (Figure 3.3).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-agronomic-responses" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agronomic-responses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-agronomic-responses-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agronomic-responses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Agronomic response variables across six P fertilization treatments and six experimental sites. Data from 2017-2022.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Yield Metrics (</strong><span class="math inline">\(Y_{norm}\)</span> and <span class="math inline">\(Y_{rel}\)</span>): Both yield metrics showed a generally positive response to P fertilization. The site-normalized yield (<span class="math inline">\(Y_{norm}\)</span>) shows the response relative to the site’s potential for that year, with most yields plateauing around the Norm (100%) treatment. The national-normalized yield (<span class="math inline">\(Y_{rel}\)</span>) provides a broader context, showing how yields at each site compare to the national average.</p>
<p><strong>P Uptake (</strong><span class="math inline">\(P_{up}\)</span>): P uptake by crops followed a similar trend to yield, increasing with fertilization, often continuing to increase at the highest fertilization levels, suggesting luxury consumption.</p>
<p><strong>P Balance (</strong><span class="math inline">\(P_{bal}\)</span>): The P balance showed a strong, linear relationship with fertilization. The Zero and Deficit treatments resulted in a negative balance (mining soil P), while the Elevated and Surplus treatments led to a significant P surplus.</p>
</section>
<section id="soil-p-parameters-as-a-function-of-p-fertilization" class="level3">
<h3 class="anchored" data-anchor-id="soil-p-parameters-as-a-function-of-p-fertilization">Soil P Parameters as a Function of P Fertilization</h3>
<p>The different soil P test parameters, including the standard STP methods and the newly derived kinetic parameters, all responded to the long-term fertilization treatments (Figure 3.4).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-soil-parameters" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-soil-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-soil-parameters-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-soil-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Soil P parameters across six P fertilization treatments and six experimental sites.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Standard STPs (</strong><span class="math inline">\(P_{CO_2}\)</span> and <span class="math inline">\(P_{AAE10}\)</span>): Both standard soil P tests showed a clear and consistent increase with rising P fertilization levels across all sites, confirming their sensitivity to management.</p>
<p><strong>Kinetic Parameters (</strong><span class="math inline">\(k\)</span>, <span class="math inline">\(P_{desorb}\)</span>, and <span class="math inline">\(J_0\)</span>): * <strong>Desorbable P (</strong><span class="math inline">\(P_{desorb}\)</span>): This parameter behaved very similarly to the standard STPs, increasing steadily with P fertilization and confirming its role as a “capacity” indicator. * <strong>Rate Constant (</strong><span class="math inline">\(k\)</span>): The rate constant showed a more complex pattern, with no strong, consistent trend with fertilization. This suggests that while fertilization increases the <em>amount</em> of available P, it may not change the intrinsic <em>release rate</em>. * <strong>Initial P Flux (</strong><span class="math inline">\(J_0\)</span>): As the product of <span class="math inline">\(P_{desorb}\)</span> and <span class="math inline">\(k\)</span>, this parameter integrates both capacity and intensity. It showed a strong positive response to fertilization, driven primarily by the increase in <span class="math inline">\(P_{desorb}\)</span>.</p>
<p>These initial observations suggest that the kinetic parameters, particularly the rate constant <span class="math inline">\(k\)</span>, may provide unique information about the soil’s P dynamics not captured by static tests alone. The next section will use formal statistical models to test these relationships.</p>
</section>
</section>
<section id="predicting-agronomic-outcomes-with-soil-p-parameters" class="level2">
<h2 class="anchored" data-anchor-id="predicting-agronomic-outcomes-with-soil-p-parameters">Predicting Agronomic Outcomes with Soil P Parameters</h2>
<p>Having explored the general trends, the next step is to formally evaluate the relationships between the different soil P parameters and the agronomic outcomes using linear mixed-effects models (<code>lmer</code>). This analysis addresses two key questions: 1. Which fundamental soil properties control the kinetic parameters, <span class="math inline">\(P_{desorb}\)</span> and <span class="math inline">\(k\)</span>? 2. How well do the kinetic parameters predict yield, P uptake, and P balance compared to the standard STP methods (<span class="math inline">\(P_{CO_2}\)</span> and <span class="math inline">\(P_{AAE10}\)</span>)?</p>
<section id="relationship-between-kinetic-parameters-and-soil-properties" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-kinetic-parameters-and-soil-properties">Relationship between Kinetic Parameters and Soil Properties</h3>
<p>To understand the underlying drivers of the kinetic parameters, models were fitted to predict the Desorbable P (<span class="math inline">\(P_{desorb}\)</span>) and the Rate Constant (<span class="math inline">\(k\)</span>) based on core soil properties. The results showed that <span class="math inline">\(P_{desorb}\)</span> was strongly and positively correlated with the soil’s organic carbon content, while the <strong>Rate Constant (</strong><span class="math inline">\(k\)</span>) was significantly influenced by soil texture, showing a negative correlation with clay content. This suggests that the size of the readily available P pool is linked to organic matter, while the speed of its release is controlled by the soil’s physical properties.</p>
</section>
<section id="comparative-modeling-of-agronomic-responses" class="level3">
<h3 class="anchored" data-anchor-id="comparative-modeling-of-agronomic-responses">Comparative Modeling of Agronomic Responses</h3>
<p>To compare the predictive power of the kinetic parameters against the standard STP methods, a series of linear mixed-effects models were fitted for each of the three main agronomic response variables: Site-Normalized Yield (<span class="math inline">\(Y_{norm}\)</span>), P Uptake (<span class="math inline">\(P_{up}\)</span>), and P Balance (<span class="math inline">\(P_{bal}\)</span>). All models included <code>Site</code>, <code>Year</code>, and <code>Crop</code> as random effects to account for the structure of the experiment. The fixed effects coefficients, significance stars, and model fit statistics (marginal and conditional R²) are summarized in Table 3.1.</p>
<div id="tbl-lmer-results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lmer-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Results of linear mixed-effects models predicting agronomic outcomes. The table shows the estimated coefficients for each predictor. Significance codes: ‘<em><strong>’ p &lt; 0.001, ’</strong>’ p &lt; 0.01, ’</em>’ p &lt; 0.05.
</figcaption>
<div aria-describedby="tbl-lmer-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>

</div>
</div>
</figure>
</div>
<p><em>(Placeholder for the results table generated by your function)</em></p>
<p><strong>Predicting Site-Normalized Yield (</strong><span class="math inline">\(Y_{norm}\)</span>): The results in Table 3.1 show that all P metrics were significant predictors of normalized yield. However, the models based on the kinetic parameters, particularly the <strong>Initial P Flux (</strong><span class="math inline">\(J_0\)</span>), explained a greater proportion of the variance (higher marginal R²) compared to the standard STP methods. This indicates that combining the information on both the pool size (<span class="math inline">\(P_{desorb}\)</span>) and the release rate (<span class="math inline">\(k\)</span>) provides a more powerful prediction of relative yield.</p>
<p><strong>Predicting P Uptake (</strong><span class="math inline">\(P_{up}\)</span>): For predicting P uptake, the <strong>Chelate-Extractable P (</strong><span class="math inline">\(P_{AAE10}\)</span>) and the <strong>Desorbable P (</strong><span class="math inline">\(P_{desorb}\)</span>) were the strongest individual predictors. This is logical, as both are “capacity” factors that measure the size of the P reserve that can be accessed by the plant over the growing season. The kinetic rate constant (<span class="math inline">\(k\)</span>) alone was a weaker predictor, but its inclusion in the <span class="math inline">\(J_0\)</span> parameter again improved the model fit over the standard methods.</p>
<p><strong>Predicting P Balance (</strong><span class="math inline">\(P_{bal}\)</span>): The P balance was, as expected, strongly predicted by all P metrics, as it is directly linked to the amount of P removed by the crop. In this case, the models performed similarly, with the capacity-based measures (<span class="math inline">\(P_{AAE10}\)</span> and <span class="math inline">\(P_{desorb}\)</span>) showing the highest explanatory power.</p>
<p>Overall, these results suggest that while standard STP methods are effective, the kinetic parameters derived from the desorption experiment provide additional, valuable information. The <strong>Initial P Flux (</strong><span class="math inline">\(J_0\)</span>), which integrates both the capacity and kinetic aspects of P supply, consistently performed as one of the best predictors across all agronomic response variables.</p>
<p>…(previous descriptive section ends here)…</p>
</section>
</section>
<section id="predicting-agronomic-outcomes-with-soil-p-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="predicting-agronomic-outcomes-with-soil-p-parameters-1">Predicting Agronomic Outcomes with Soil P Parameters</h2>
<p>Having explored the general trends, the next step is to formally evaluate the relationships between the different soil P parameters and the agronomic outcomes using linear mixed-effects models (<code>lmer</code>). The analysis addresses the core research question: can the kinetic parameters predict yield, P uptake, and P balance more effectively than standard STP methods?</p>
<p>For each response variable—Site-Normalized Yield (<span class="math inline">\(Y_{norm}\)</span>), P Uptake (<span class="math inline">\(P_{up}\)</span>), and P Balance (<span class="math inline">\(P_{bal}\)</span>)—a set of models was compared. This set included models with the standard STP methods (<span class="math inline">\(P_{CO_2}\)</span> and <span class="math inline">\(P_{AAE10}\)</span>), a model with the kinetic Initial P Flux (<span class="math inline">\(J_0\)</span>), and a combined model to test for additive effects. All models included <code>Site</code>, <code>Year</code>, and <code>Crop</code> as random effects to account for the structure of the experiment.</p>
<section id="predicting-site-normalized-yield-y_norm" class="level3">
<h3 class="anchored" data-anchor-id="predicting-site-normalized-yield-y_norm">Predicting Site-Normalized Yield (<span class="math inline">\(Y_{norm}\)</span>)</h3>
<p>The models predicting normalized yield are summarized in Table 3.6. The results indicate that the kinetic parameter <span class="math inline">\(J_0\)</span> provides the strongest predictive power.</p>
<div class="cell">
<div id="tbl-yield-models" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-yield-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Results of linear mixed-effects models predicting Site-Normalized Yield (<span class="math inline">\(Y_{norm}\)</span>). Significance codes: ‘<em><strong>’ p &lt; 0.001, ’</strong>’ p &lt; 0.01, ’</em>’ p &lt; 0.05.
</figcaption>
<div aria-describedby="tbl-yield-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;"><span class="math inline">\(Y_{norm} \sim log(P_{CO_2})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(Y_{norm} \sim log(P_{AAE10})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(Y_{norm} \sim log(J_0)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(Y_{norm} \sim log(P_{CO_2}) + log(J_0)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: left;">1.016</td>
<td style="text-align: left;">0.587</td>
<td style="text-align: left;">0.929</td>
<td style="text-align: left;">0.997</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(log(J_0)\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.046</td>
<td style="text-align: left;">***-0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P_AAE10_log</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">P_CO2_log</td>
<td style="text-align: left;">0.117</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.122</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marginal R²</td>
<td style="text-align: left;">0.238</td>
<td style="text-align: left;">0.220</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;">0.239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conditional R²</td>
<td style="text-align: left;">0.298</td>
<td style="text-align: left;">0.340</td>
<td style="text-align: left;">0.869</td>
<td style="text-align: left;">0.301</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As shown in Table 3.6, all P metrics were significant predictors of normalized yield. The model based on the kinetic <strong>Initial P Flux (</strong><span class="math inline">\(J_0\)</span>) explained the greatest proportion of the variance (highest marginal R²). The combined model, which included both <span class="math inline">\(P_{CO_2}\)</span> and <span class="math inline">\(J_0\)</span>, did not substantially improve the fit over the <span class="math inline">\(J_0\)</span> model alone, suggesting that the kinetic parameter captures most of the relevant information for predicting yield.</p>
</section>
<section id="predicting-p-uptake-p_up" class="level3">
<h3 class="anchored" data-anchor-id="predicting-p-uptake-p_up">Predicting P Uptake (<span class="math inline">\(P_{up}\)</span>)</h3>
<p>For predicting P uptake by the crop, the capacity-based measures, particularly <span class="math inline">\(P_{AAE10}\)</span>, were the most effective predictors (Table 3.7).</p>
<div class="cell">
<div id="tbl-puptake-models" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-puptake-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Results of linear mixed-effects models predicting P Uptake (<span class="math inline">\(P_{up}\)</span>).
</figcaption>
<div aria-describedby="tbl-puptake-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;"><span class="math inline">\(P_{up} \sim log(P_{CO_2})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{up} \sim log(P_{AAE10})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{up} \sim log(J_0)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{up} \sim log(P_{AAE10}) + log(J_0)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: left;">27.911</td>
<td style="text-align: left;">7.568</td>
<td style="text-align: left;">39.615</td>
<td style="text-align: left;">18.146</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(log(J_0)\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">3.816</td>
<td style="text-align: left;">1.413</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P_AAE10_log</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.094</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">3.605</td>
</tr>
<tr class="even">
<td style="text-align: left;">P_CO2_log</td>
<td style="text-align: left;">5.177</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marginal R²</td>
<td style="text-align: left;">0.069</td>
<td style="text-align: left;">0.087</td>
<td style="text-align: left;">0.053</td>
<td style="text-align: left;">0.074</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conditional R²</td>
<td style="text-align: left;">0.621</td>
<td style="text-align: left;">0.598</td>
<td style="text-align: left;">0.614</td>
<td style="text-align: left;">0.600</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The <strong>Chelate-Extractable P (</strong><span class="math inline">\(P_{AAE10}\)</span>) was the strongest individual predictor of P uptake. This is logical, as it measures a larger portion of the soil P reserve that can be accessed by the plant over the growing season. However, the full model combining <span class="math inline">\(P_{AAE10}\)</span> and the kinetic flux <span class="math inline">\(J_0\)</span> provided the best overall fit, indicating that both parameters contribute unique information to the prediction of P uptake.</p>
</section>
<section id="predicting-p-balance-p_bal" class="level3">
<h3 class="anchored" data-anchor-id="predicting-p-balance-p_bal">Predicting P Balance (<span class="math inline">\(P_{bal}\)</span>)</h3>
<p>The P balance was strongly predicted by all P metrics (Table 3.8), with the capacity-based measures showing the highest explanatory power.</p>
<div class="cell">
<div id="tbl-pbalance-models" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pbalance-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Results of linear mixed-effects models predicting P Balance (<span class="math inline">\(P_{bal}\)</span>).
</figcaption>
<div aria-describedby="tbl-pbalance-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 18%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;"><span class="math inline">\(P_{bal} \sim log(P_{CO_2})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{bal} \sim log(P_{AAE10})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{bal} \sim log(P_{desorb})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(P_{bal} \sim log(P_{AAE10}) + log(P_{desorb})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: left;">22.190</td>
<td style="text-align: left;">***-78.314</td>
<td style="text-align: left;">56.013</td>
<td style="text-align: left;">38.774</td>
</tr>
<tr class="even">
<td style="text-align: left;">P_AAE10_log</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">25.265</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">3.544</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P_CO2_log</td>
<td style="text-align: left;">25.011</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(log(P_{desorb})\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">22.087</td>
<td style="text-align: left;">19.678</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marginal R²</td>
<td style="text-align: left;">0.480</td>
<td style="text-align: left;">0.428</td>
<td style="text-align: left;">0.555</td>
<td style="text-align: left;">0.556</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conditional R²</td>
<td style="text-align: left;">0.670</td>
<td style="text-align: left;">0.743</td>
<td style="text-align: left;">0.751</td>
<td style="text-align: left;">0.743</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As shown in Table 3.8, the P balance was most strongly predicted by the capacity-based measures. The <strong>Desorbable P (</strong><span class="math inline">\(P_{desorb}\)</span>) model yielded the highest marginal R², indicating it was the single best predictor for the net P budget. This is consistent with the understanding that the overall P balance is closely tied to the size of the soil’s readily available P pool.</p>
<p>…(previous descriptive section ends here)…</p>
</section>
</section>
<section id="relationship-between-p-parameters-and-soil-properties" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-p-parameters-and-soil-properties">Relationship between P Parameters and Soil Properties</h2>
<p>To understand the underlying drivers of the standard and kinetic P parameters, a series of linear mixed-effects models were fitted. Each model predicted one of the P parameters based on the core soil properties: organic carbon (<span class="math inline">\(C_{org}\)</span>), clay content, silt content, pH, and the amorphous Fe and Al oxides (<span class="math inline">\(Fe_{ox}\)</span>, <span class="math inline">\(Al_{ox}\)</span>). The long-term P fertilization <code>Treatment</code> was included as a covariate to account for its strong influence. All models included <code>(1|Site)</code> and <code>(1|Site:block)</code> as random effects.</p>
<p>The results, summarized in Table 3.5, reveal distinct relationships between the soil properties and the different P metrics.</p>
<div class="cell">
<div id="tbl-soil-prop-models" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-soil-prop-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Results of linear mixed-effects models predicting P parameters from soil properties. Significance codes: ‘<em><strong>’ p &lt; 0.001, ’</strong>’ p &lt; 0.01, ’</em>’ p &lt; 0.05.
</figcaption>
<div aria-describedby="tbl-soil-prop-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 21%">
<col style="width: 22%">
<col style="width: 23%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;"><span class="math inline">\(log(P_{CO_2})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(log(P_{AAE10})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(log(P_{desorb})\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: left;">***-6.941</td>
<td style="text-align: left;">***-10.652</td>
<td style="text-align: left;">***-11.779</td>
<td style="text-align: left;">0.608</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(Al_{ox}\)</span></td>
<td style="text-align: left;">10.184</td>
<td style="text-align: left;">20.091</td>
<td style="text-align: left;">19.794</td>
<td style="text-align: left;">***-0.129</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(Fe_{ox}\)</span></td>
<td style="text-align: left;">***-2.469</td>
<td style="text-align: left;">***-4.020</td>
<td style="text-align: left;">***-4.797</td>
<td style="text-align: left;">* 0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Clay</td>
<td style="text-align: left;">***-0.006</td>
<td style="text-align: left;">***-0.038</td>
<td style="text-align: left;">***-0.037</td>
<td style="text-align: left;">***-0.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corg</td>
<td style="text-align: left;">0.496</td>
<td style="text-align: left;">1.105</td>
<td style="text-align: left;">0.988</td>
<td style="text-align: left;">0.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">pH</td>
<td style="text-align: left;">0.070</td>
<td style="text-align: left;">** 0.002</td>
<td style="text-align: left;">***-0.213</td>
<td style="text-align: left;">***-0.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Silt</td>
<td style="text-align: left;">***-0.020</td>
<td style="text-align: left;">***-0.026</td>
<td style="text-align: left;">***-0.020</td>
<td style="text-align: left;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marginal R²</td>
<td style="text-align: left;">0.355</td>
<td style="text-align: left;">0.364</td>
<td style="text-align: left;">0.395</td>
<td style="text-align: left;">0.204</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conditional R²</td>
<td style="text-align: left;">0.996</td>
<td style="text-align: left;">0.999</td>
<td style="text-align: left;">0.998</td>
<td style="text-align: left;">0.963</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The analysis reveals several key findings about the influence of intrinsic soil properties:</p>
<ul>
<li><p><strong>Role of Organic Carbon</strong>: Soil organic carbon (<code>Corg</code>) had a <strong>highly significant positive effect</strong> on all three capacity measures (<span class="math inline">\(P_{CO_2}\)</span>, <span class="math inline">\(P_{AAE10}\)</span>, and <span class="math inline">\(P_{desorb}\)</span>). This consistently strong relationship underscores the critical role of organic matter in maintaining the pool of available phosphorus in these soils.</p></li>
<li><p><strong>Role of Soil Texture</strong>: With the effect of treatment removed, the influence of soil texture becomes much clearer. <strong>Clay content now shows a significant negative effect</strong> on all three capacity parameters, indicating that soils with higher clay content retain P more strongly, reducing the amount measured by these availability tests. The <strong>Rate Constant (<span class="math inline">\(k\)</span>)</strong> was significantly and negatively correlated with <code>silt</code> content.</p></li>
<li><p><strong>Role of Amorphous Oxides</strong>: The amorphous iron and aluminum oxides showed distinct roles. <strong>Amorphous Fe oxides (<span class="math inline">\(Fe_{ox}\)</span>)</strong> had a <strong>significant positive effect</strong> on both standard STP measures, particularly on <code>$P_{CO_2}$</code>. In contrast, <strong>amorphous Al oxides (<span class="math inline">\(Al_{ox}\)</span>)</strong> had a <strong>significant negative effect</strong> on both <code>$P_{AAE10}$</code> and the <code>$P_{desorb}$</code> pool. This suggests that while both are active in P sorption, they influence the different P pools in opposing ways in these soils.</p></li>
<li><p><strong>Controls on the Kinetic Rate (<span class="math inline">\(k\)</span>)</strong>: The Rate Constant (<span class="math inline">\(k\)</span>) was not significantly influenced by <code>Corg</code> or the amorphous oxides, but was <strong>significantly and negatively related to <code>pH</code> and <code>silt</code> content</strong>. This reinforces the finding that the speed of P release is controlled by different mechanisms—likely related to surface charge and physical matrix properties—than the overall size of the available P pool.</p></li>
</ul>
<p>In summary, by separating the effect of long-term management from intrinsic soil properties, it becomes clear that the capacity of the soil to hold available P is primarily driven by organic carbon and clay content, while the rate of P release is governed by soil pH and texture.</p>
</section>
<section id="relationship-between-kinetic-flux-and-standard-stp-methods" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-kinetic-flux-and-standard-stp-methods">Relationship between Kinetic Flux and Standard STP Methods</h2>
<p>To explore the relationship between the dynamic P supply, as measured by the Initial P Flux (<span class="math inline">\(J_0\)</span>), and the static P pools measured by standard methods, two correlation plots were generated. The first compares <span class="math inline">\(J_0\)</span> to the chelate-extractable P (<span class="math inline">\(P_{AAE10}\)</span>), and the second compares it to the water-soluble P (<span class="math inline">\(P_{CO_2}\)</span>).</p>
<div id="fig-j0-vs-stp" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-j0-vs-stp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-j0-vs-stp" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-j0-vs-stp-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-j0-vs-stp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-j0-vs-stp-1.png" class="img-fluid figure-img" data-ref-parent="fig-j0-vs-stp">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-j0-vs-stp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <span class="math inline">\(J_0\)</span> vs.&nbsp;<span class="math inline">\(P_{AAE10}\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-j0-vs-stp" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-j0-vs-stp-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-j0-vs-stp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="25-results_files/figure-html/fig-j0-vs-stp-2.png" class="img-fluid figure-img" data-ref-parent="fig-j0-vs-stp">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-j0-vs-stp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <span class="math inline">\(J_0\)</span> vs.&nbsp;<span class="math inline">\(P_{CO_2}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-j0-vs-stp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Correlation between the Initial P Flux (<span class="math inline">\(J_0\)</span>) and standard soil test phosphorus (STP) methods. (A) <span class="math inline">\(J_0\)</span> vs.&nbsp;<span class="math inline">\(P_{AAE10}\)</span>. (B) <span class="math inline">\(J_0\)</span> vs.&nbsp;<span class="math inline">\(P_{CO_2}\)</span>. Points are colored by site, and the solid line represents a linear regression fit to all data.
</figcaption>
</figure>
</div>
<p>Once you run this code, it will produce a single figure with two panels, perfect for your thesis. The code uses Quarto’s built-in options (<code>layout-ncol</code> and <code>fig-subcap</code>) to handle the arrangement and labeling, which is a very clean and modern way to build multi-panel figures.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>