<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.42">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Lukas Graz">
    <meta name="dcterms.date" content="2025-02-13">

    <title>Modeling of relative Yield, P-Uptake and P-Balance</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cbf367297292b8e2858f4d7b7fd861d6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <style>
.quarto-notebook .cell-container .cell-decorator {
  display: none;
}
</style>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> mlr3</h6>

            <a href="../notebooks/mlr3.qmd" class="btn btn-primary quarto-download-embed" download="mlr3.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Modeling of relative Yield, P-Uptake and P-Balance</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>Lukas Graz </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">February 13, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" id="toc-predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" class="nav-link" data-scroll-target="#predicting-yield-variables-withwithout-weather-data-with-earth-dynamics">Predicting Yield variables (with/without Weather data) with Earth-dynamics</a>
  <ul class="collapse">
  <li><a href="#with-weather-data" id="toc-with-weather-data" class="nav-link" data-scroll-target="#with-weather-data">With Weather data</a></li>
  <li><a href="#without-weather-data" id="toc-without-weather-data" class="nav-link" data-scroll-target="#without-weather-data">Without Weather data</a></li>
  </ul></li>
  <li><a href="#predicting-earth-dynamics-via-soil-variables-withwithout-treatment" id="toc-predicting-earth-dynamics-via-soil-variables-withwithout-treatment" class="nav-link" data-scroll-target="#predicting-earth-dynamics-via-soil-variables-withwithout-treatment">Predicting Earth-dynamics via soil variables (with/without Treatment)</a>
  <ul class="collapse">
  <li><a href="#legacy-code" id="toc-legacy-code" class="nav-link" data-scroll-target="#legacy-code">Legacy Code</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>RES <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/RES.rds"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> RES<span class="sc">$</span>D</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># d &lt;- RES$data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Benchmark helper function</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3verse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">"regr.mse"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">interactive</span>())</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  lgr<span class="sc">::</span><span class="fu">get_logger</span>(<span class="st">"mlr3"</span>)<span class="sc">$</span><span class="fu">set_threshold</span>(<span class="st">"warn"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>get_benchi_table <span class="ot">&lt;-</span> <span class="cf">function</span>(tasks, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">resamplings =</span> <span class="cn">NULL</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  learners <span class="ot">&lt;-</span> <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">"regr.featureless"</span>, <span class="st">"regr.lm"</span>, <span class="st">"regr.xgboost"</span>, <span class="st">"regr.ranger"</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  learners<span class="sc">$</span>regr.xgboost<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">set_values</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.04</span>, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">300</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">2</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  benchi <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">benchmark</span>(<span class="fu">benchmark_grid</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      tasks, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      learners, </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(resamplings)) <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> nfolds) <span class="cf">else</span> resamplings</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"benchmark.rds"</span>, </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> <span class="st">"cache/"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">hash =</span> <span class="fu">list</span>(tasks, nfolds)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(benchi<span class="sc">$</span><span class="fu">aggregate</span>(mse), </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> task_id,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> learner_id,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> regr.mse</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(res) <span class="ot">&lt;-</span> res<span class="sc">$</span>task_id</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> res[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"regr."</span>, <span class="st">""</span>, <span class="fu">colnames</span>(res))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">any</span>(<span class="fu">colnames</span>(res) <span class="sc">==</span> <span class="st">"featureless"</span>))</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> res <span class="sc">/</span> res<span class="sc">$</span>featureless</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  res[, <span class="sc">-</span><span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Testing prediction quality using</p>
<ul>
<li>Linear models</li>
<li>Random forests (default parameters)</li>
<li>XGBoost (with parameter tuning)</li>
</ul>
<p><strong>Weather Variables:</strong></p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Weather_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"anavg_temp"</span>, <span class="st">"ansum_prec"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"juvdev_prec"</span>, <span class="st">"juvdev_sun"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ansum_sun"</span>, <span class="st">"juvdev_temp"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set NA's to 0 but include a column to indicate that</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>NA_weather <span class="ot">&lt;-</span> <span class="fu">is.na</span>(D<span class="sc">$</span>juvdev_sun)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>D[NA_weather, Weather_vars] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>NA_weather <span class="ot">&lt;-</span> NA_weather</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Weather_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(Weather_vars, <span class="st">"NA_weather"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(Weather_vars <span class="sc">%in%</span> <span class="fu">names</span>(D)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Weather_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "anavg_temp"  "ansum_prec"  "juvdev_prec" "juvdev_sun"  "ansum_sun"  
[6] "juvdev_temp" "NA_weather" </code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>P_var_sets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyweather =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="st">"k"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PS =</span> <span class="st">"PS_log"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kPS =</span> <span class="fu">c</span>(<span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10 =</span> <span class="st">"P_AAE10_log"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2 =</span> <span class="st">"P_CO2_log"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2 =</span> <span class="fu">c</span>(<span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>, <span class="st">"P_AAE10_CO2_loglog"</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AAE10_CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">CO2_kPS =</span> <span class="fu">c</span>(<span class="st">"P_CO2_log"</span>, <span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>Earth_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soil_0_20_clay"</span>, <span class="st">"soil_0_20_pH_H2O"</span>, <span class="st">"soil_0_20_Corg"</span>, <span class="st">"soil_0_20_silt"</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Y_vars_yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ymain_norm"</span>, <span class="st">"Ymain_rel"</span>, <span class="st">"annual_P_uptake"</span>, <span class="st">"annual_P_balance"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Y_vars_earth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PS_log"</span>, <span class="st">"k"</span>, <span class="st">"kPS_log"</span>, <span class="st">"P_AAE10_log"</span>, <span class="st">"P_CO2_log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>impute NA’s for Earth variables. impute value with the mean of Site X block</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># xtabs(~is.na(D$soil_0_20_silt) + Site + block, D)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> Earth_vars) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  D[[var]] <span class="ot">&lt;-</span> <span class="fu">ave</span>(D[[var]], D<span class="sc">$</span>Site, D<span class="sc">$</span>block, <span class="at">FUN =</span> \(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), x))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>remove Cadenazzoo since too many crucial data missing</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> D[D<span class="sc">$</span>site <span class="sc">!=</span> <span class="st">"CAD"</span>, ]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(D<span class="sc">$</span>Site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Now check NA’s</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(D[, <span class="fu">unique</span>(<span class="fu">c</span>(Y_vars_yield, Y_vars_earth, Weather_vars, <span class="fu">unlist</span>(P_var_sets), Earth_vars))], </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  \(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)<span class="sc">|</span><span class="fu">is.nan</span>(x))) <span class="sc">|&gt;</span> <span class="fu">cbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
Ymain_norm           70
Ymain_rel           164
annual_P_uptake     117
annual_P_balance    102
PS_log                0
k                     0
kPS_log               0
P_AAE10_log          47
P_CO2_log            47
anavg_temp            0
ansum_prec            0
juvdev_prec           0
juvdev_sun            0
ansum_sun             0
juvdev_temp           0
NA_weather            0
P_AAE10_CO2_loglog   47
soil_0_20_clay        0
soil_0_20_pH_H2O      0
soil_0_20_Corg        0
soil_0_20_silt        0</code></pre>
</div>
</div></div>
</section>
<section id="predicting-yield-variables-withwithout-weather-data-with-earth-dynamics" class="level2">
<h2 class="anchored" data-anchor-id="predicting-yield-variables-withwithout-weather-data-with-earth-dynamics">Predicting Yield variables (with/without Weather data) with Earth-dynamics</h2>
<section id="with-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="with-weather-data">With Weather data</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>P_var_sets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$onlyweather
NULL

$k
[1] "k"

$PS
[1] "PS_log"

$kPS
[1] "PS_log"  "k"       "kPS_log"

$AAE10
[1] "P_AAE10_log"

$CO2
[1] "P_CO2_log"

$AAE10_CO2
[1] "P_AAE10_log"        "P_CO2_log"          "P_AAE10_CO2_loglog"

$AAE10_CO2_kPS
[1] "P_AAE10_log" "P_CO2_log"   "PS_log"      "k"           "kPS_log"    

$CO2_kPS
[1] "P_CO2_log" "PS_log"    "k"         "kPS_log"  </code></pre>
</div>
</div></div>
<p>Algorithm learns to predict location from weather since we do not do stratified cross-validation (leaving out locations).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_yield){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar ,Weather_vars, <span class="fu">unlist</span>(P_var_sets)))])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  mytsks <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (nam <span class="cf">in</span> <span class="fu">names</span>(P_var_sets)) {</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Weather_vars, P_var_sets[[nam]])],</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> nam)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    mytsks[[nam]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  Tables_yield_weather[[yvar]] <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>Tables_yield_weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Ymain_norm
                  lm xgboost ranger
onlyweather   -0.009  -0.040 -0.043
k              0.004   0.108  0.027
PS             0.208   0.261  0.261
kPS            0.229   0.303  0.286
AAE10          0.154   0.060  0.134
CO2            0.221   0.276  0.276
AAE10_CO2      0.225   0.295  0.315
AAE10_CO2_kPS  0.224   0.266  0.269
CO2_kPS        0.259   0.238  0.238

$Ymain_rel
                 lm xgboost ranger
onlyweather   0.138   0.544  0.542
k             0.107   0.553  0.512
PS            0.195   0.572  0.599
kPS           0.141   0.570  0.624
AAE10         0.255   0.605  0.605
CO2           0.200   0.647  0.634
AAE10_CO2     0.208   0.647  0.655
AAE10_CO2_kPS 0.197   0.661  0.628
CO2_kPS       0.183   0.666  0.624

$annual_P_uptake
                 lm xgboost ranger
onlyweather   0.382   0.770  0.768
k             0.375   0.793  0.773
PS            0.440   0.819  0.839
kPS           0.395   0.796  0.829
AAE10         0.497   0.841  0.836
CO2           0.473   0.846  0.848
AAE10_CO2     0.492   0.804  0.834
AAE10_CO2_kPS 0.482   0.762  0.836
CO2_kPS       0.426   0.803  0.831

$annual_P_balance
                 lm xgboost ranger
onlyweather   0.129   0.213  0.211
k             0.127   0.610  0.289
PS            0.626   0.881  0.761
kPS           0.623   0.892  0.865
AAE10         0.444   0.634  0.600
CO2           0.519   0.737  0.723
AAE10_CO2     0.509   0.748  0.739
AAE10_CO2_kPS 0.623   0.874  0.842
CO2_kPS       0.615   0.893  0.852</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(Tables_yield_weather, \(x) x<span class="sc">$</span>lm)); </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_yield_weather[[<span class="dv">1</span>]])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>(Tables_yield_weather_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Ymain_norm Ymain_rel annual_P_uptake annual_P_balance
onlyweather       -0.009     0.138           0.382            0.129
k                  0.004     0.107           0.375            0.127
PS                 0.208     0.195           0.440            0.626
kPS                0.229     0.141           0.395            0.623
AAE10              0.154     0.255           0.497            0.444
CO2                0.221     0.200           0.473            0.519
AAE10_CO2          0.225     0.208           0.492            0.509
AAE10_CO2_kPS      0.224     0.197           0.482            0.623
CO2_kPS            0.259     0.183           0.426            0.615</code></pre>
</div>
</div></div>
</section>
<section id="without-weather-data" class="level3">
<h3 class="anchored" data-anchor-id="without-weather-data">Without Weather data</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>P_var_sets_noweather <span class="ot">&lt;-</span> P_var_sets[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Tables_yield <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_yield){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar, <span class="fu">unlist</span>(P_var_sets_noweather)))])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  mytsks <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (nam <span class="cf">in</span> <span class="fu">names</span>(P_var_sets_noweather)) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      D[ind,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(yvar, P_var_sets_noweather[[nam]]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> nam)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    mytsks[[nam]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  Tables_yield[[yvar]] <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>Tables_yield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Ymain_norm
                 lm xgboost ranger
k             0.014   0.168  0.146
PS            0.220   0.206  0.138
kPS           0.228   0.213  0.153
AAE10         0.150   0.072 -0.017
CO2           0.206   0.193  0.150
AAE10_CO2     0.196   0.134  0.158
AAE10_CO2_kPS 0.228   0.251  0.207
CO2_kPS       0.224   0.211  0.169

$Ymain_rel
                  lm xgboost ranger
k             -0.010   0.058 -0.008
PS             0.035  -0.018 -0.124
kPS            0.024   0.001 -0.060
AAE10          0.124   0.064 -0.107
CO2            0.092  -0.009 -0.137
AAE10_CO2      0.130   0.025  0.100
AAE10_CO2_kPS  0.117   0.109  0.079
CO2_kPS        0.051  -0.031 -0.042

$annual_P_uptake
                  lm xgboost ranger
k             -0.013  -0.081 -0.160
PS             0.035  -0.080 -0.181
kPS            0.029  -0.106 -0.166
AAE10          0.077  -0.071 -0.170
CO2            0.057  -0.066 -0.181
AAE10_CO2      0.083   0.049  0.006
AAE10_CO2_kPS  0.029  -0.189 -0.141
CO2_kPS        0.057  -0.048 -0.096

$annual_P_balance
                 lm xgboost ranger
k             0.017   0.448  0.572
PS            0.553   0.603  0.566
kPS           0.536   0.614  0.588
AAE10         0.324   0.292  0.208
CO2           0.438   0.432  0.347
AAE10_CO2     0.442   0.449  0.461
AAE10_CO2_kPS 0.550   0.605  0.609
CO2_kPS       0.544   0.586  0.570</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(Tables_yield, \(x) x<span class="sc">$</span>lm));</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_yield[[<span class="dv">1</span>]])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>(Tables_yield_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Ymain_norm Ymain_rel annual_P_uptake annual_P_balance
k                  0.014    -0.010          -0.013            0.017
PS                 0.220     0.035           0.035            0.553
kPS                0.228     0.024           0.029            0.536
AAE10              0.150     0.124           0.077            0.324
CO2                0.206     0.092           0.057            0.438
AAE10_CO2          0.196     0.130           0.083            0.442
AAE10_CO2_kPS      0.228     0.117           0.029            0.550
CO2_kPS            0.224     0.051           0.057            0.544</code></pre>
</div>
</div></div>
<p>xgboost &amp; ranger are no good in this setting since only very few variables available</p>
</section>
</section>
<section id="predicting-earth-dynamics-via-soil-variables-withwithout-treatment" class="level2">
<h2 class="anchored" data-anchor-id="predicting-earth-dynamics-via-soil-variables-withwithout-treatment">Predicting Earth-dynamics via soil variables (with/without Treatment)</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Earth_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "soil_0_20_clay"   "soil_0_20_pH_H2O" "soil_0_20_Corg"   "soil_0_20_silt"  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Y_vars_earth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PS_log"      "k"           "kPS_log"     "P_AAE10_log" "P_CO2_log"  </code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>is.trt0 <span class="ot">&lt;-</span> D<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"P0"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>is.trt1 <span class="ot">&lt;-</span> D<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"P100"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>mytsks_treatment <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>mytsks_notreatment <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(yvar <span class="cf">in</span> Y_vars_earth){</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(D[,<span class="fu">unique</span>(<span class="fu">c</span>(yvar, <span class="fu">unlist</span>(P_var_sets_noweather)))])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Earth_vars, <span class="st">"is.trt1"</span>, <span class="st">"is.trt0"</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> yvar)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    mytsks_treatment[[yvar]] <span class="ot">&lt;-</span> mytsk</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    mytsk <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>      D[ind, <span class="fu">c</span>(yvar, Earth_vars</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ,"Site"</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        )],</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">target =</span> yvar,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> yvar)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mytsk$set_col_roles("Site", "group")</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    mytsks_notreatment[[yvar]] <span class="ot">&lt;-</span> mytsk    </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>Tables_earth_treatment <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks_treatment)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>Tables_earth_notreatment <span class="ot">&lt;-</span> <span class="fu">get_benchi_table</span>(mytsks_notreatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Tables_earth_treatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               lm xgboost ranger
PS_log      0.888   0.959  0.967
k           0.351   0.695  0.811
kPS_log     0.750   0.919  0.938
P_AAE10_log 0.809   0.836  0.873
P_CO2_log   0.738   0.790  0.804</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Tables_earth_notreatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               lm xgboost ranger
PS_log      0.048   0.075  0.209
k           0.283   0.521  0.591
kPS_log     0.004   0.037  0.191
P_AAE10_log 0.278   0.333  0.410
P_CO2_log   0.084   0.129  0.216</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soil + treatment"</span> <span class="ot">=</span> Tables_earth_treatment[[<span class="st">"lm"</span>]],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"only soil"</span> <span class="ot">=</span> Tables_earth_notreatment[[<span class="st">"lm"</span>]]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Tables_earth_treatment)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>(Tables_earth_lm <span class="ot">&lt;-</span> tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 PS_log     k kPS_log P_AAE10_log P_CO2_log
soil + treatment  0.888 0.351   0.750       0.809     0.738
only soil         0.048 0.283   0.004       0.278     0.084</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="fu">list</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield =</span> Tables_yield,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_weather =</span> Tables_yield_weather,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_treatment =</span> Tables_earth_treatment,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_notreatment =</span> Tables_earth_notreatment,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_lm =</span> Tables_yield_lm,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_yield_weather_lm =</span> Tables_yield_weather_lm,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tables_earth_lm =</span> Tables_earth_lm</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>), <span class="st">"cache/benchmark-tables.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<hr>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>annual_P_balance, D<span class="sc">$</span>PS) <span class="co"># 0.54389</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>fert_P_tot, D<span class="sc">$</span>PS) <span class="co"># 0.48236</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.584526</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(D<span class="sc">$</span>annual_P_uptake, D<span class="sc">$</span>PS) <span class="co"># 0.070678</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div></div>
<p>We did manage to have high predictive power for weather. This could also be due to our regression models recovering location&amp;year from it and hence still overfitting on the test set.</p>
<p>Without Weather data we only managed for annual balance to get some predictive power (30%). Since we the balance is uptake - fert_P, this means that we mostly predicted fert_P. Interestingly PS is best to predict this quantity</p>
<section id="legacy-code" class="level3">
<h3 class="anchored" data-anchor-id="legacy-code">Legacy Code</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<details class="code-fold">
<summary>XGBoost - Parameter Tuning</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter estimates for XGBoost</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as_task_regr</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(D[<span class="fu">complete.cases</span>(D<span class="sc">$</span>annual_P_balance),], </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"annual_P_balance"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS<span class="co">#, Weather_vars</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">target =</span> <span class="st">"annual_P_balance"</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"regr.xgboost"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="dv">500</span>  <span class="co"># More iterations due to lower learning rate</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create search space</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ps</span>(</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">p_int</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">p_dbl</span>(<span class="fl">0.001</span>, <span class="fl">0.3</span>, <span class="at">tags =</span> <span class="st">"logscale"</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup tuning</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>instance <span class="ot">&lt;-</span> <span class="fu">ti</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">task =</span> t,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> l,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>),</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">"regr.mse"</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">terminator =</span> <span class="fu">trm</span>(<span class="st">"none"</span>),</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">search_space =</span> ps</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid search</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>tuner <span class="ot">&lt;-</span> mlr3tuning<span class="sc">::</span><span class="fu">tnr</span>(<span class="st">"grid_search"</span>)</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>tuner<span class="sc">$</span><span class="fu">optimize</span>(instance)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>instance<span class="sc">$</span>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Ymain_rel max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.067444 &lt;list[5]&gt; &lt;list[2]&gt; 177.18</num></list></list></num></int></p>
<p>P uptake max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 137.41</num></list></list></num></int></p>
<p>annual_P_balance max_depth eta learner_param_vals x_domain regr.mse <int> <num> <list> <list> <num> 1: 2 0.034222 &lt;list[5]&gt; &lt;list[2]&gt; 145.21</num></list></list></num></int></p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef$kPS_log &lt;- nlme.coef$k * nlme.coef$PS</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nlme.coef.mrg &lt;- merge(nlme.coef,allP[allP$year&gt;=2017,],by = "uid")</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # add log-transformed versions</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># D$kPS_log &lt;- log(D$kPS_log)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># D$PS_log &lt;- log(D$PS)</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># D$soil_0_20_P_AAE10_log &lt;- log(D$soil_0_20_P_AAE10)</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># D$soil_0_20_P_CO2_log &lt;- log(D$soil_0_20_P_CO2)</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># D$k</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(D, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Ymain_rel"</span>, P_var_sets<span class="sc">$</span>AAE10_CO2_kPS, Weather_vars))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Ymain_rel P_AAE10_log    P_CO2_log     PS_log          k   kPS_log
25      65.60   1.8870696 -1.469675970 -2.9145147 0.20191085 -4.514444
26      72.33   2.1162555 -1.237874356 -2.9145147 0.20191085 -4.514444
27      84.81   2.3321439 -1.272965676 -2.9145147 0.20191085 -4.514444
28         NA   2.2300144 -1.469675970 -2.9145147 0.20191085 -4.514444
29         NA   2.4069451 -1.171182982 -2.9145147 0.20191085 -4.514444
30         NA   2.3321439 -1.272965676 -2.9145147 0.20191085 -4.514444
31      92.91   2.3887628 -1.237874356 -2.9145147 0.20191085 -4.514444
32     189.25          NA           NA -2.9145147 0.20191085 -4.514444
33         NA   2.1972246 -1.078809661 -2.9145147 0.20191085 -4.514444
34      69.17   1.8245493 -1.347073648 -2.6264148 0.23310593 -4.082677
35     167.07          NA           NA -2.6264148 0.23310593 -4.082677
36         NA   2.3795461 -1.108662625 -2.6264148 0.23310593 -4.082677
37     106.32   2.4849066 -1.171182982 -2.6264148 0.23310593 -4.082677
38      82.00   2.3223877 -1.021651248 -2.6264148 0.23310593 -4.082677
39         NA   2.3418058 -1.108662625 -2.6264148 0.23310593 -4.082677
40      84.97   2.3418058 -1.108662625 -2.6264148 0.23310593 -4.082677
41         NA   2.1400662 -1.386294361 -2.6264148 0.23310593 -4.082677
42         NA   2.2925348 -0.941608540 -2.6264148 0.23310593 -4.082677
43      74.25   0.8329091 -1.832581464 -3.3408312 0.15014993 -5.236952
44      89.08   1.9878743 -1.514127733 -3.3408312 0.15014993 -5.236952
45         NA   1.7047481 -1.660731207 -3.3408312 0.15014993 -5.236952
46         NA   2.9069011 -1.237874356 -3.3408312 0.15014993 -5.236952
47      81.01   1.7047481 -1.660731207 -3.3408312 0.15014993 -5.236952
48         NA   1.1939225 -2.207274913 -3.3408312 0.15014993 -5.236952
49         NA   1.7917595 -1.609437912 -3.3408312 0.15014993 -5.236952
50     194.54          NA           NA -3.3408312 0.15014993 -5.236952
51      66.00   1.6292405 -1.272965676 -3.3408312 0.15014993 -5.236952
52         NA   1.7749524 -1.469675970 -3.8896385 0.13492618 -5.892666
53      79.31   2.6461748 -1.237874356 -3.8896385 0.13492618 -5.892666
54         NA   1.4586150 -2.207274913 -3.8896385 0.13492618 -5.892666
55     149.91          NA           NA -3.8896385 0.13492618 -5.892666
56      92.33   1.9878743 -1.237874356 -3.8896385 0.13492618 -5.892666
57         NA   2.1282317 -1.469675970 -3.8896385 0.13492618 -5.892666
58         NA   2.1162555 -1.386294361 -3.8896385 0.13492618 -5.892666
59      74.44   1.8870696 -1.347073648 -3.8896385 0.13492618 -5.892666
60      80.85   2.1162555 -1.386294361 -3.8896385 0.13492618 -5.892666
61      91.33   3.1441523 -0.248461359 -1.4927360 0.11739091 -3.634982
62         NA   3.4111477 -0.198450939 -1.4927360 0.11739091 -3.634982
63         NA   3.2425924 -0.314710745 -1.4927360 0.11739091 -3.634982
64     203.81          NA           NA -1.4927360 0.11739091 -3.634982
65      91.61   3.1863526 -0.198450939 -1.4927360 0.11739091 -3.634982
66     109.20   3.4045252 -0.314710745 -1.4927360 0.11739091 -3.634982
67         NA   3.1945831 -0.198450939 -1.4927360 0.11739091 -3.634982
68         NA   3.1863526 -0.198450939 -1.4927360 0.11739091 -3.634982
69      63.16   3.1045867 -0.385662481 -1.4927360 0.11739091 -3.634982
70     198.18          NA           NA -2.1350669 0.17309044 -3.889008
71         NA   2.7850112 -0.673344553 -2.1350669 0.17309044 -3.889008
72         NA   2.7972813 -0.843970070 -2.1350669 0.17309044 -3.889008
73         NA   2.9014216 -0.356674944 -2.1350669 0.17309044 -3.889008
74      68.61   2.8449094 -0.634878272 -2.1350669 0.17309044 -3.889008
75      73.44   2.8094027 -0.733969175 -2.1350669 0.17309044 -3.889008
76      78.32   2.7850112 -0.673344553 -2.1350669 0.17309044 -3.889008
77     101.92   3.2580965 -0.510825624 -2.1350669 0.17309044 -3.889008
78         NA   3.0007198 -0.562118918 -2.1350669 0.17309044 -3.889008
79      80.26   2.4069451 -1.171182982 -2.2181329 0.17801699 -3.944009
80      95.57   2.6026897 -0.941608540 -2.2181329 0.17801699 -3.944009
81         NA   2.8033604 -0.843970070 -2.2181329 0.17801699 -3.944009
82         NA   2.6026897 -0.941608540 -2.2181329 0.17801699 -3.944009
83         NA   2.5726122 -1.237874356 -2.2181329 0.17801699 -3.944009
84      72.56   2.7663191 -2.525728644 -2.2181329 0.17801699 -3.944009
85         NA   2.7343675 -0.673344553 -2.2181329 0.17801699 -3.944009
86     190.38          NA           NA -2.2181329 0.17801699 -3.944009
87     107.85   2.9069011 -0.867500568 -2.2181329 0.17801699 -3.944009
88         NA   2.8903718 -0.867500568 -2.2067423 0.17736688 -3.936277
89     204.59          NA           NA -2.2067423 0.17736688 -3.936277
90      52.11   3.0587071 -0.579818495 -2.2067423 0.17736688 -3.936277
91         NA   2.9069011 -0.733969175 -2.2067423 0.17736688 -3.936277
92      93.51   2.9069011 -0.733969175 -2.2067423 0.17736688 -3.936277
93      72.61   3.1045867 -0.916290732 -2.2067423 0.17736688 -3.936277
94         NA   2.8390785 -0.941608540 -2.2067423 0.17736688 -3.936277
95      69.74   2.6741486 -0.941608540 -2.2067423 0.17736688 -3.936277
96         NA   3.3809947 -0.385662481 -2.2067423 0.17736688 -3.936277
97      62.97   4.2017031  0.765467842 -0.9083699 0.23219455 -2.368550
98      90.42   4.3907386  0.636576829 -0.9083699 0.23219455 -2.368550
99         NA   4.3000028  0.652325186 -0.9083699 0.23219455 -2.368550
100     90.11   4.0412953  0.239016900 -0.9083699 0.23219455 -2.368550
101    222.79          NA           NA -0.9083699 0.23219455 -2.368550
102        NA   4.1697612  0.604315967 -0.9083699 0.23219455 -2.368550
103     94.15   4.0656021  0.494696242 -0.9083699 0.23219455 -2.368550
104        NA   4.2640873  0.559615788 -0.9083699 0.23219455 -2.368550
105        NA   4.0656021  0.494696242 -0.9083699 0.23219455 -2.368550
106        NA   3.1822118 -0.198450939 -1.6359640 0.15615814 -3.492850
107     97.94   2.6461748 -0.733969175 -1.6359640 0.15615814 -3.492850
108    104.41   3.3809947 -0.342490309 -1.6359640 0.15615814 -3.492850
109     81.58   3.0540012 -0.510825624 -1.6359640 0.15615814 -3.492850
110    204.59          NA           NA -1.6359640 0.15615814 -3.492850
111        NA   3.0726933 -0.634878272 -1.6359640 0.15615814 -3.492850
112     85.44   3.0955776 -1.171182982 -1.6359640 0.15615814 -3.492850
113        NA   2.6461748 -0.733969175 -1.6359640 0.15615814 -3.492850
114        NA   3.0056826 -0.478035801 -1.6359640 0.15615814 -3.492850
115    195.84          NA           NA -1.3788326 0.17699689 -3.110456
116     76.88   3.4873751 -0.105360516 -1.3788326 0.17699689 -3.110456
117        NA   3.5945688  0.231111721 -1.3788326 0.17699689 -3.110456
118     83.33   3.7424202 -0.105360516 -1.3788326 0.17699689 -3.110456
119        NA   3.8044378  0.165514438 -1.3788326 0.17699689 -3.110456
120     87.03   3.5945688  0.231111721 -1.3788326 0.17699689 -3.110456
121     47.89   3.4531571 -0.051293294 -1.3788326 0.17699689 -3.110456
122        NA   4.0412953  0.425267735 -1.3788326 0.17699689 -3.110456
123        NA   3.6480575  0.048790164 -1.3788326 0.17699689 -3.110456
124    125.95   2.7013612 -1.272965676 -3.3238864 0.22062441 -4.835180
125     66.48   2.7472709 -1.514127733 -3.3238864 0.22062441 -4.835180
126     83.27   2.8507065 -0.994252273 -3.3238864 0.22062441 -4.835180
127        NA   2.7472709 -1.272965676 -3.3238864 0.22062441 -4.835180
128    139.69          NA           NA -3.3238864 0.22062441 -4.835180
129        NA   2.6100698 -1.771956842 -3.3238864 0.22062441 -4.835180
130        NA   2.4069451 -1.609437912 -3.3238864 0.22062441 -4.835180
131    132.89   2.6390573 -1.171182982 -3.3238864 0.22062441 -4.835180
132        NA   2.7013612 -1.272965676 -3.3238864 0.22062441 -4.835180
133        NA   3.1223649 -1.108662625 -3.2178905 0.18943117 -4.881620
134     75.56   2.8622009 -1.237874356 -3.2178905 0.18943117 -4.881620
135    140.99          NA           NA -3.2178905 0.18943117 -4.881620
136        NA   2.9123507 -1.966112856 -3.2178905 0.18943117 -4.881620
137    117.88   3.1223649 -1.108662625 -3.2178905 0.18943117 -4.881620
138        NA   2.8507065 -1.347073648 -3.2178905 0.18943117 -4.881620
139     65.52   3.0106209 -1.386294361 -3.2178905 0.18943117 -4.881620
140     91.54   3.0492730 -1.078809661 -3.2178905 0.18943117 -4.881620
141        NA   2.1860513 -1.386294361 -3.2178905 0.18943117 -4.881620
142        NA   2.9391619 -1.237874356 -3.6548744 0.28439752 -4.912257
143     65.33   2.9014216 -1.609437912 -3.6548744 0.28439752 -4.912257
144        NA   2.9652731 -1.469675970 -3.6548744 0.28439752 -4.912257
145    133.86   2.9391619 -1.237874356 -3.6548744 0.28439752 -4.912257
146        NA   2.8903718 -2.120263536 -3.6548744 0.28439752 -4.912257
147     77.26   3.1570004 -1.108662625 -3.6548744 0.28439752 -4.912257
148    132.58          NA           NA -3.6548744 0.28439752 -4.912257
149        NA   3.1045867 -1.347073648 -3.6548744 0.28439752 -4.912257
150     93.11   3.1570004 -0.941608540 -3.6548744 0.28439752 -4.912257
151     89.10   2.7972813 -1.272965676 -3.3755708 0.21679430 -4.904377
152        NA   2.4336134 -2.407945609 -3.3755708 0.21679430 -4.904377
153     86.78   2.8033604 -1.609437912 -3.3755708 0.21679430 -4.904377
154        NA   2.7146947 -1.386294361 -3.3755708 0.21679430 -4.904377
155        NA   2.3608540 -1.514127733 -3.3755708 0.21679430 -4.904377
156     54.11   2.2407097 -1.237874356 -3.3755708 0.21679430 -4.904377
157    126.90   2.7146947 -1.386294361 -3.3755708 0.21679430 -4.904377
158        NA   2.3702437 -1.237874356 -3.3755708 0.21679430 -4.904377
159    117.94          NA           NA -3.3755708 0.21679430 -4.904377
160        NA   3.4468079 -0.916290732 -2.3555262 0.34791259 -3.411330
161        NA   3.2580965 -0.994252273 -2.3555262 0.34791259 -3.411330
162    135.70          NA           NA -2.3555262 0.34791259 -3.411330
163    109.78   3.4011974 -0.693147181 -2.3555262 0.34791259 -3.411330
164     87.36   3.3534067 -1.078809661 -2.3555262 0.34791259 -3.411330
165        NA   3.3141860 -0.733969175 -2.3555262 0.34791259 -3.411330
166        NA   3.0056826 -0.916290732 -2.3555262 0.34791259 -3.411330
167     90.60   3.5055574 -0.693147181 -2.3555262 0.34791259 -3.411330
168    145.89   3.2580965 -0.994252273 -2.3555262 0.34791259 -3.411330
169        NA   3.1986731 -0.867500568 -2.4402754 0.30702495 -3.621102
170     92.78   3.5025499 -0.673344553 -2.4402754 0.30702495 -3.621102
171    139.72   3.3741687 -0.798507696 -2.4402754 0.30702495 -3.621102
172        NA   3.4812401 -1.108662625 -2.4402754 0.30702495 -3.621102
173    151.13          NA           NA -2.4402754 0.30702495 -3.621102
174     79.12   3.3741687 -1.108662625 -2.4402754 0.30702495 -3.621102
175        NA   3.3741687 -0.798507696 -2.4402754 0.30702495 -3.621102
176     94.92   3.4750672 -0.579818495 -2.4402754 0.30702495 -3.621102
177        NA   3.3393220 -0.941608540 -2.4402754 0.30702495 -3.621102
178    153.12          NA           NA -2.5704141 0.25060055 -3.954309
179     87.56   3.6163088 -0.693147181 -2.5704141 0.25060055 -3.954309
180        NA   3.4719665 -0.798507696 -2.5704141 0.25060055 -3.954309
181     92.11   3.6988298 -0.634878272 -2.5704141 0.25060055 -3.954309
182        NA   3.6788291 -1.108662625 -2.5704141 0.25060055 -3.954309
183        NA   3.4242627 -0.867500568 -2.5704141 0.25060055 -3.954309
184    138.29   3.5496174 -0.733969175 -2.5704141 0.25060055 -3.954309
185        NA   3.5496174 -0.733969175 -2.5704141 0.25060055 -3.954309
186     77.97   3.2542430 -1.272965676 -2.5704141 0.25060055 -3.954309
187    125.74          NA           NA -2.8188200 0.16133292 -4.643105
188        NA   2.7343675 -0.941608540 -2.8188200 0.16133292 -4.643105
189     96.55   3.1223649 -1.171182982 -2.8188200 0.16133292 -4.643105
190    137.97   2.8390785 -1.108662625 -2.8188200 0.16133292 -4.643105
191     90.00   2.8033604 -0.843970070 -2.8188200 0.16133292 -4.643105
192        NA   2.7343675 -1.078809661 -2.8188200 0.16133292 -4.643105
193        NA   2.8390785 -1.108662625 -2.8188200 0.16133292 -4.643105
194     96.80   3.1267605 -0.798507696 -2.8188200 0.16133292 -4.643105
195        NA   2.7972813 -1.771956842 -2.8188200 0.16133292 -4.643105
196        NA   3.2771447 -0.510825624 -2.0165660 0.29038401 -3.253117
197        NA   3.5973123 -0.385662481 -2.0165660 0.29038401 -3.253117
198    148.44          NA           NA -2.0165660 0.29038401 -3.253117
199        NA   3.5751507 -0.510825624 -2.0165660 0.29038401 -3.253117
200        NA   3.5695327 -0.478035801 -2.0165660 0.29038401 -3.253117
201    134.81   3.5695327 -0.478035801 -2.0165660 0.29038401 -3.253117
202     88.53   3.8712010 -0.430782916 -2.0165660 0.29038401 -3.253117
203     84.67   3.1441523 -0.776528789 -2.0165660 0.29038401 -3.253117
204     58.00   3.6163088 -0.400477567 -2.0165660 0.29038401 -3.253117
205    117.78   4.0741419 -0.094310679 -1.8173600 0.22557569 -3.306459
206     92.53   3.7352858 -0.733969175 -1.8173600 0.22557569 -3.306459
207        NA   3.8329798 -0.579818495 -1.8173600 0.22557569 -3.306459
208     97.18   3.9039908 -0.385662481 -1.8173600 0.22557569 -3.306459
209        NA   3.6584202 -0.478035801 -1.8173600 0.22557569 -3.306459
210    132.12   3.6635616 -0.527632742 -1.8173600 0.22557569 -3.306459
211        NA   3.6635616 -0.527632742 -1.8173600 0.22557569 -3.306459
212        NA   3.7376696 -0.430782916 -1.8173600 0.22557569 -3.306459
213    140.29          NA           NA -1.8173600 0.22557569 -3.306459
214     91.44   3.8133070 -0.274436846 -1.6506135 0.13768829 -3.633376
215    137.66   3.6963515 -0.478035801 -1.6506135 0.13768829 -3.633376
216        NA   3.6963515 -0.478035801 -1.6506135 0.13768829 -3.633376
217        NA   3.7954892 -0.446287103 -1.6506135 0.13768829 -3.633376
218        NA   3.5890591 -0.400477567 -1.6506135 0.13768829 -3.633376
219    123.83          NA           NA -1.6506135 0.13768829 -3.633376
220     90.98   3.9512437 -0.162518929 -1.6506135 0.13768829 -3.633376
221     98.28   3.9160150 -0.446287103 -1.6506135 0.13768829 -3.633376
222        NA   3.7773481 -0.314710745 -1.6506135 0.13768829 -3.633376
223    119.84          NA           NA -1.7109028 0.06500092 -4.444257
224     92.34   3.6737658 -0.693147181 -1.7109028 0.06500092 -4.444257
225     94.74   3.8372995 -0.510825624 -1.7109028 0.06500092 -4.444257
226    108.89   3.7447871 -0.356674944 -1.7109028 0.06500092 -4.444257
227        NA   3.6813512 -0.162518929 -1.7109028 0.06500092 -4.444257
228        NA   3.6838669 -0.579818495 -1.7109028 0.06500092 -4.444257
229        NA   3.4307562 -0.693147181 -1.7109028 0.06500092 -4.444257
230        NA   3.7954892 -0.673344553 -1.7109028 0.06500092 -4.444257
231    132.91   3.6838669 -0.579818495 -1.7109028 0.06500092 -4.444257
233     98.67   2.4765384 -1.272965676 -3.0602039 0.22808615 -4.538236
234     98.64   2.7911651 -1.021651248 -3.0602039 0.22808615 -4.538236
235        NA   2.7725887 -0.941608540 -3.0602039 0.22808615 -4.538236
236    108.37   2.6741486 -1.108662625 -3.0602039 0.22808615 -4.538236
237     90.23   2.9338569 -0.941608540 -3.0602039 0.22808615 -4.538236
238        NA   2.7725887 -1.108662625 -3.0602039 0.22808615 -4.538236
239     94.74   2.5649494 -1.469675970 -3.0602039 0.22808615 -4.538236
240    123.40          NA           NA -3.0602039 0.22808615 -4.538236
241        NA   2.6741486 -1.108662625 -3.0602039 0.22808615 -4.538236
242        NA   2.6672282 -1.021651248 -2.9064446 0.20616803 -4.485508
243     81.61   2.9123507 -1.078809661 -2.9064446 0.20616803 -4.485508
244    115.94   2.6878475 -1.108662625 -2.9064446 0.20616803 -4.485508
245        NA   2.7013612 -1.237874356 -2.9064446 0.20616803 -4.485508
246     83.91   2.9704145 -1.078809661 -2.9064446 0.20616803 -4.485508
247    156.85          NA           NA -2.9064446 0.20616803 -4.485508
248        NA   2.6878475 -1.108662625 -2.9064446 0.20616803 -4.485508
249     89.10   2.6390573 -1.469675970 -2.9064446 0.20616803 -4.485508
251     82.03   2.7600099 -1.237874356 -2.9064446 0.20616803 -4.485508
252    104.22   2.8213789 -1.078809661 -2.6081966 0.15273297 -4.487261
253        NA   3.0540012 -0.673344553 -2.6081966 0.15273297 -4.487261
254        NA   2.8903718 -1.108662625 -2.6081966 0.15273297 -4.487261
256     83.28   3.0252911 -0.916290732 -2.6081966 0.15273297 -4.487261
257    152.86          NA           NA -2.6081966 0.15273297 -4.487261
258     93.87   3.2228678 -0.941608540 -2.6081966 0.15273297 -4.487261
259     92.86   3.2695689 -1.347073648 -2.6081966 0.15273297 -4.487261
260        NA   3.0106209 -1.078809661 -2.6081966 0.15273297 -4.487261
261    113.04   3.0106209 -1.078809661 -2.6081966 0.15273297 -4.487261
263    164.73          NA           NA -2.5903371 0.14899842 -4.494157
264        NA   2.4510051 -1.171182982 -2.5903371 0.14899842 -4.494157
265        NA   2.4423470 -0.127833372 -2.5903371 0.14899842 -4.494157
266     96.24   2.2823824 -1.514127733 -2.5903371 0.14899842 -4.494157
267    104.70   2.5416020 -1.237874356 -2.5903371 0.14899842 -4.494157
268     97.49   2.6461748 -1.021651248 -2.5903371 0.14899842 -4.494157
269        NA   2.2823824 -1.078809661 -2.5903371 0.14899842 -4.494157
270     91.95   2.7911651 -1.237874356 -2.5903371 0.14899842 -4.494157
271    110.14   2.4510051 -1.171182982 -2.5903371 0.14899842 -4.494157
272    100.00   3.5174978 -0.527632742 -2.0944336 0.19984180 -3.704663
273     98.85   3.6609943 -0.400477567 -2.0944336 0.19984180 -3.704663
274     92.15   3.9019727 -0.174353387 -2.0944336 0.19984180 -3.704663
275     86.47   3.4843123 -0.562118918 -2.0944336 0.19984180 -3.704663
276    133.02          NA           NA -2.0944336 0.19984180 -3.704663
277        NA   3.4078419 -0.446287103 -2.0944336 0.19984180 -3.704663
278        NA   3.4372078 -0.342490309 -2.0944336 0.19984180 -3.704663
280        NA   3.6323091 -0.162518929 -2.0944336 0.19984180 -3.704663
281    107.57   3.4078419 -0.446287103 -2.0944336 0.19984180 -3.704663
282        NA   3.4499875 -0.385662481 -1.6439616 0.10705720 -3.878354
284        NA   3.3741687 -0.248461359 -1.6439616 0.10705720 -3.878354
285     96.38   3.2733640 -0.400477567 -1.6439616 0.10705720 -3.878354
286     94.92   3.3286267 -0.400477567 -1.6439616 0.10705720 -3.878354
287    134.75          NA           NA -1.6439616 0.10705720 -3.878354
288        NA   3.3877744 -0.105360516 -1.6439616 0.10705720 -3.878354
289     92.53   3.6813512 -0.301105093 -1.6439616 0.10705720 -3.878354
290    140.42   3.3741687 -0.248461359 -1.6439616 0.10705720 -3.878354
291    100.00   3.4307562 -0.198450939 -1.6439616 0.10705720 -3.878354
293        NA   3.5263605 -0.385662481 -2.1715576 0.21193823 -3.723018
294    113.27   3.5467397 -0.430782916 -2.1715576 0.21193823 -3.723018
295    160.75          NA           NA -2.1715576 0.21193823 -3.723018
296     95.02   4.1541846 -0.127833372 -2.1715576 0.21193823 -3.723018
297        NA   3.8649314 -0.020202707 -2.1715576 0.21193823 -3.723018
298     97.18   3.4339872 -0.673344553 -2.1715576 0.21193823 -3.723018
299        NA   3.6296601 -0.430782916 -2.1715576 0.21193823 -3.723018
300    126.25   3.5263605 -0.385662481 -2.1715576 0.21193823 -3.723018
301     96.34   3.8372995 -0.139262067 -2.1715576 0.21193823 -3.723018
302     99.28   3.0955776 -0.733969175 -2.0030331 0.18423357 -3.694584
303        NA   3.2386785 -0.634878272 -2.0030331 0.18423357 -3.694584
304    104.28   3.4594663 -0.430782916 -2.0030331 0.18423357 -3.694584
305    119.16   3.2386785 -0.634878272 -2.0030331 0.18423357 -3.694584
306        NA   3.3178158 -0.673344553 -2.0030331 0.18423357 -3.694584
307        NA   3.4339872 -0.094310679 -2.0030331 0.18423357 -3.694584
308    102.07   3.1484534 -0.673344553 -2.0030331 0.18423357 -3.694584
310     94.25   3.6712245 -0.478035801 -2.0030331 0.18423357 -3.694584
311    158.67          NA           NA -2.0030331 0.18423357 -3.694584
312        NA   3.7062281 -0.210721031 -1.5511331 0.13120470 -3.582130
313        NA   3.6349511  0.019802627 -1.5511331 0.13120470 -3.582130
314    100.75   3.6428355 -0.162518929 -1.5511331 0.13120470 -3.582130
315     96.66   3.7977339  0.039220713 -1.5511331 0.13120470 -3.582130
316     93.30   4.2766661  0.357674444 -1.5511331 0.13120470 -3.582130
317    161.09          NA           NA -1.5511331 0.13120470 -3.582130
318    130.60   3.6349511  0.019802627 -1.5511331 0.13120470 -3.582130
319    108.69   3.7424202 -0.040821995 -1.5511331 0.13120470 -3.582130
321        NA   3.8607297  0.343589704 -1.5511331 0.13120470 -3.582130
322        NA   3.6712245  0.122217633 -1.2221855 0.10473925 -3.478467
323    157.02          NA           NA -1.2221855 0.10473925 -3.478467
324        NA   3.4339872 -0.162518929 -1.2221855 0.10473925 -3.478467
325     99.69   3.7208625  0.048790164 -1.2221855 0.10473925 -3.478467
326        NA   3.7352858  0.277631737 -1.2221855 0.10473925 -3.478467
327     85.16   3.6323091  0.076961041 -1.2221855 0.10473925 -3.478467
328     97.51   3.9569964 -0.040821995 -1.2221855 0.10473925 -3.478467
329    111.65   3.5174978 -0.094310679 -1.2221855 0.10473925 -3.478467
330    128.34   3.4339872 -0.162518929 -1.2221855 0.10473925 -3.478467
332        NA   3.4688560 -0.235722334 -1.2647377 0.13141530 -3.294130
334     93.42   3.5204608 -0.385662481 -1.2647377 0.13141530 -3.294130
335        NA   3.6661225  0.009950331 -1.2647377 0.13141530 -3.294130
336     88.06   3.6082116 -0.235722334 -1.2647377 0.13141530 -3.294130
337        NA   3.7887248 -0.040821995 -1.2647377 0.13141530 -3.294130
338    130.43   3.4688560 -0.235722334 -1.2647377 0.13141530 -3.294130
339     94.44   4.1125119  0.148420005 -1.2647377 0.13141530 -3.294130
340    169.15          NA           NA -1.2647377 0.13141530 -3.294130
341    106.17   3.6270041 -0.210721031 -1.2647377 0.13141530 -3.294130
342        NA   4.0758411  0.239016900 -1.2757306 0.21076772 -2.832729
343    106.02   4.0621657 -0.051293294 -1.2757306 0.21076772 -2.832729
345    158.15          NA           NA -1.2757306 0.21076772 -2.832729
346    133.49   3.9627161 -0.105360516 -1.2757306 0.21076772 -2.832729
347    100.42   3.9926809 -0.105360516 -1.2757306 0.21076772 -2.832729
348        NA   3.9627161 -0.105360516 -1.2757306 0.21076772 -2.832729
349     94.25   4.1447208 -0.198450939 -1.2757306 0.21076772 -2.832729
350        NA   4.2556127  0.300104592 -1.2757306 0.21076772 -2.832729
351     96.86   4.0360090  0.076961041 -1.2757306 0.21076772 -2.832729
352     91.63   2.9856819 -1.272965676 -3.8181685 0.18211399 -5.521291
353     86.01   2.5095993 -1.660731207 -3.8181685 0.18211399 -5.521291
354     69.73   3.0301337 -1.272965676 -3.8181685 0.18211399 -5.521291
355    164.56          NA           NA -3.8181685 0.18211399 -5.521291
357        NA   2.7013612 -1.660731207 -3.8181685 0.18211399 -5.521291
358    104.08   2.7212954 -1.237874356 -3.8181685 0.18211399 -5.521291
359        NA   2.8094027 -1.272965676 -3.8181685 0.18211399 -5.521291
360     80.08   2.6810215 -1.771956842 -3.8181685 0.18211399 -5.521291
361        NA   2.9856819 -1.272965676 -3.8181685 0.18211399 -5.521291
362     67.05   2.9177707 -1.609437912 -3.7414147 0.22288952 -5.242494
363        NA   2.7408400 -1.609437912 -3.7414147 0.22288952 -5.242494
364    153.73          NA           NA -3.7414147 0.22288952 -5.242494
365     81.18   2.8213789 -1.832581464 -3.7414147 0.22288952 -5.242494
367     61.28   3.0155349 -1.771956842 -3.7414147 0.22288952 -5.242494
368        NA   2.9549103 -1.609437912 -3.7414147 0.22288952 -5.242494
369        NA   2.5572273 -1.832581464 -3.7414147 0.22288952 -5.242494
370     66.34   2.9549103 -1.609437912 -3.7414147 0.22288952 -5.242494
371     94.25   2.9014216 -1.469675970 -3.7414147 0.22288952 -5.242494
372     75.10   3.5263605 -1.108662625 -3.8931747 0.14517478 -5.822992
373    166.64          NA           NA -3.8931747 0.14517478 -5.822992
374        NA   3.6136170 -0.693147181 -3.8931747 0.14517478 -5.822992
375        NA   3.4563167 -1.108662625 -3.8931747 0.14517478 -5.822992
376        NA   3.2958369 -1.660731207 -3.8931747 0.14517478 -5.822992
377    129.31   3.4563167 -1.108662625 -3.8931747 0.14517478 -5.822992
378    110.97   3.6216707 -0.867500568 -3.8931747 0.14517478 -5.822992
379     94.92   3.5234150 -1.347073648 -3.8931747 0.14517478 -5.822992
381     98.91   3.3286267 -1.469675970 -3.8931747 0.14517478 -5.822992
382     88.90   2.9014216 -1.469675970 -3.6735278 0.26166020 -5.014236
384        NA   2.7663191 -1.469675970 -3.6735278 0.26166020 -5.014236
385     65.52   2.9391619 -1.386294361 -3.6735278 0.26166020 -5.014236
386        NA   2.6246686 -1.966112856 -3.6735278 0.26166020 -5.014236
387     64.66   2.8390785 -1.832581464 -3.6735278 0.26166020 -5.014236
388        NA   2.5014360 -1.771956842 -3.6735278 0.26166020 -5.014236
389     75.85   2.7663191 -1.469675970 -3.6735278 0.26166020 -5.014236
390    165.68          NA           NA -3.6735278 0.26166020 -5.014236
391     71.26   3.1696856 -1.272965676 -3.6735278 0.26166020 -5.014236
392     86.78   4.1383614  0.067658648 -2.0697768 0.21782370 -3.593846
393    153.64          NA           NA -2.0697768 0.21782370 -3.593846
394    106.63   3.8501476 -0.478035801 -2.0697768 0.21782370 -3.593846
395        NA   4.1141472  0.009950331 -2.0697768 0.21782370 -3.593846
396        NA   4.0342406  0.190620360 -2.0697768 0.21782370 -3.593846
397    135.27   4.1141472  0.009950331 -2.0697768 0.21782370 -3.593846
399        NA   3.9759363 -0.446287103 -2.0697768 0.21782370 -3.593846
400    100.10   3.9239516 -0.072570693 -2.0697768 0.21782370 -3.593846
401    114.85   4.2253728 -0.235722334 -2.0697768 0.21782370 -3.593846
402    105.43   3.9180051 -0.478035801 -2.3967665 0.21384349 -3.939277
403    162.91          NA           NA -2.3967665 0.21384349 -3.939277
404        NA   3.8351420 -0.693147181 -2.3967665 0.21384349 -3.939277
405     97.89   4.2061840  0.173953307 -2.3967665 0.21384349 -3.939277
406     99.69   3.9796817 -0.235722334 -2.3967665 0.21384349 -3.939277
407    109.77   3.9376908 -0.579818495 -2.3967665 0.21384349 -3.939277
408        NA   3.8774316 -0.072570693 -2.3967665 0.21384349 -3.939277
410    145.25   3.9852735 -0.301105093 -2.3967665 0.21384349 -3.939277
411        NA   3.9852735 -0.301105093 -2.3967665 0.21384349 -3.939277
412     88.12   3.6686767 -0.634878272 -2.6575735 0.21147919 -4.211202
413    129.95   3.5723456 -0.798507696 -2.6575735 0.21147919 -4.211202
415     97.83   3.2228678 -1.272965676 -2.6575735 0.21147919 -4.211202
416        NA   3.5695327 -1.171182982 -2.6575735 0.21147919 -4.211202
417    108.05   3.3568971 -0.733969175 -2.6575735 0.21147919 -4.211202
418        NA   3.2347492 -0.994252273 -2.6575735 0.21147919 -4.211202
419    168.54          NA           NA -2.6575735 0.21147919 -4.211202
420    108.65   3.5582011 -0.994252273 -2.6575735 0.21147919 -4.211202
421        NA   3.5723456 -0.798507696 -2.6575735 0.21147919 -4.211202
422        NA   3.7037681 -0.385662481 -2.6521244 0.21152273 -4.205547
424        NA   3.6054978 -0.634878272 -2.6521244 0.21152273 -4.205547
425    117.23   3.8066625 -0.356674944 -2.6521244 0.21152273 -4.205547
426    110.24   3.8416005 -0.356674944 -2.6521244 0.21152273 -4.205547
427    102.63   3.7013020 -0.634878272 -2.6521244 0.21152273 -4.205547
428        NA   3.8066625 -0.356674944 -2.6521244 0.21152273 -4.205547
429     81.61   4.2106450  0.418710335 -2.6521244 0.21152273 -4.205547
430    168.54          NA           NA -2.6521244 0.21152273 -4.205547
431    109.17   3.5582011 -0.579818495 -2.6521244 0.21152273 -4.205547
432        NA   4.3832759  0.190620360 -1.4624073 0.18550740 -3.147068
433     89.46   4.6288867  0.703097511 -1.4624073 0.18550740 -3.147068
434        NA   4.3502779 -0.094310679 -1.4624073 0.18550740 -3.147068
435    113.99   4.2499228 -0.174353387 -1.4624073 0.18550740 -3.147068
436     98.22   4.3956830  0.438254931 -1.4624073 0.18550740 -3.147068
437    131.88   4.3832759  0.190620360 -1.4624073 0.18550740 -3.147068
438        NA   4.3254563  0.262364264 -1.4624073 0.18550740 -3.147068
439    166.55          NA           NA -1.4624073 0.18550740 -3.147068
441    106.02   4.3385971  0.076961041 -1.4624073 0.18550740 -3.147068
442        NA   4.3770141  0.683096845 -1.2422076 0.13496530 -3.244945
443     99.62   4.5358201  0.900161350 -1.2422076 0.13496530 -3.244945
444    111.18   4.3081110  0.488580015 -1.2422076 0.13496530 -3.244945
445    103.50   4.2282925  0.067658648 -1.2422076 0.13496530 -3.244945
446    177.90          NA           NA -1.2422076 0.13496530 -3.244945
447        NA   4.3515674  0.451075619 -1.2422076 0.13496530 -3.244945
448    143.00   4.3515674  0.451075619 -1.2422076 0.13496530 -3.244945
450    113.35   4.5174313  0.678033543 -1.2422076 0.13496530 -3.244945
451        NA   4.4601444  0.357674444 -1.2422076 0.13496530 -3.244945
452        NA   4.2668963  0.165514438 -1.5757798 0.20749743 -3.148416
453    134.86   4.1972019 -0.105360516 -1.5757798 0.20749743 -3.148416
454        NA   4.2456340  0.254642218 -1.5757798 0.20749743 -3.148416
455        NA   4.3294167  0.703097511 -1.5757798 0.20749743 -3.148416
456     89.85   4.3993753  0.963174318 -1.5757798 0.20749743 -3.148416
458    132.21   4.2456340  0.254642218 -1.5757798 0.20749743 -3.148416
459    114.85   4.2668963  0.113328685 -1.5757798 0.20749743 -3.148416
460    163.00          NA           NA -1.5757798 0.20749743 -3.148416
461     92.89   4.1287460  0.076961041 -1.5757798 0.20749743 -3.148416
462    125.60   3.9702919  0.425267735 -2.1617951 0.28873132 -3.404054
463        NA   3.7376696 -0.274436846 -2.1617951 0.28873132 -3.404054
464        NA   3.9702919  0.425267735 -2.1617951 0.28873132 -3.404054
465    110.14   4.0758411  0.717839793 -2.1617951 0.28873132 -3.404054
466    128.47   3.9039908  0.398776120 -2.1617951 0.28873132 -3.404054
467    107.89   4.0656021  0.536493371 -2.1617951 0.28873132 -3.404054
469    177.56          NA           NA -2.1617951 0.28873132 -3.404054
470        NA   3.9473901  0.542324291 -2.1617951 0.28873132 -3.404054
471     81.03   4.1972019  0.457424847 -2.1617951 0.28873132 -3.404054
    anavg_temp ansum_prec juvdev_prec juvdev_sun ansum_sun juvdev_temp
25        11.3      725.8       -0.38       0.42    2019.7        1.00
26        10.1     1035.6        0.23       0.22    1960.0        1.37
27        10.5      993.9       -0.25       0.44    1862.4        1.60
28         0.0        0.0        0.00       0.00       0.0        0.00
29        10.7      870.9       -0.35       0.18    1886.0        1.10
30        10.5      993.9       -0.25       0.44    1862.4        1.60
31        11.2      752.6       -0.36      -0.02    2105.7        0.40
32        11.3     1060.6       -0.26       0.14    1721.4        1.37
33         9.5     1029.7        0.23       0.13    1692.1       -0.34
34        11.3      725.8       -0.38       0.42    2019.7        1.00
35        11.3     1060.6       -0.26       0.14    1721.4        1.37
36        10.7      870.9       -0.35       0.18    1886.0        1.10
37        11.2      752.6       -0.36      -0.02    2105.7        0.40
38        10.1     1035.6        0.23       0.22    1960.0        1.37
39        10.5      993.9       -0.25       0.44    1862.4        1.60
40        10.5      993.9       -0.25       0.44    1862.4        1.60
41         0.0        0.0        0.00       0.00       0.0        0.00
42         9.5     1029.7        0.23       0.13    1692.1       -0.34
43        11.3      725.8       -0.38       0.42    2019.7        1.00
44        11.2      752.6       -0.36      -0.02    2105.7        0.40
45        10.5      993.9       -0.25       0.44    1862.4        1.60
46         9.5     1029.7        0.23       0.13    1692.1       -0.34
47        10.5      993.9       -0.25       0.44    1862.4        1.60
48         0.0        0.0        0.00       0.00       0.0        0.00
49        10.7      870.9       -0.35       0.18    1886.0        1.10
50        11.3     1060.6       -0.26       0.14    1721.4        1.37
51        10.1     1035.6        0.23       0.22    1960.0        1.37
52         9.5     1029.7        0.23       0.13    1692.1       -0.34
53        11.2      752.6       -0.36      -0.02    2105.7        0.40
54         0.0        0.0        0.00       0.00       0.0        0.00
55        11.3     1060.6       -0.26       0.14    1721.4        1.37
56        10.1     1035.6        0.23       0.22    1960.0        1.37
57        10.7      870.9       -0.35       0.18    1886.0        1.10
58        10.5      993.9       -0.25       0.44    1862.4        1.60
59        11.3      725.8       -0.38       0.42    2019.7        1.00
60        10.5      993.9       -0.25       0.44    1862.4        1.60
61        10.1     1035.6        0.23       0.22    1960.0        1.37
62        10.7      870.9       -0.35       0.18    1886.0        1.10
63         0.0        0.0        0.00       0.00       0.0        0.00
64        11.3     1060.6       -0.26       0.14    1721.4        1.37
65        10.5      993.9       -0.25       0.44    1862.4        1.60
66        11.2      752.6       -0.36      -0.02    2105.7        0.40
67         9.5     1029.7        0.23       0.13    1692.1       -0.34
68        10.5      993.9       -0.25       0.44    1862.4        1.60
69        11.3      725.8       -0.38       0.42    2019.7        1.00
70        11.3     1060.6       -0.26       0.14    1721.4        1.37
71        10.5      993.9       -0.25       0.44    1862.4        1.60
72         0.0        0.0        0.00       0.00       0.0        0.00
73         9.5     1029.7        0.23       0.13    1692.1       -0.34
74        11.3      725.8       -0.38       0.42    2019.7        1.00
75        10.1     1035.6        0.23       0.22    1960.0        1.37
76        10.5      993.9       -0.25       0.44    1862.4        1.60
77        11.2      752.6       -0.36      -0.02    2105.7        0.40
78        10.7      870.9       -0.35       0.18    1886.0        1.10
79        11.3      725.8       -0.38       0.42    2019.7        1.00
80        10.5      993.9       -0.25       0.44    1862.4        1.60
81        10.7      870.9       -0.35       0.18    1886.0        1.10
82        10.5      993.9       -0.25       0.44    1862.4        1.60
83         0.0        0.0        0.00       0.00       0.0        0.00
84        10.1     1035.6        0.23       0.22    1960.0        1.37
85         9.5     1029.7        0.23       0.13    1692.1       -0.34
86        11.3     1060.6       -0.26       0.14    1721.4        1.37
87        11.2      752.6       -0.36      -0.02    2105.7        0.40
88         0.0        0.0        0.00       0.00       0.0        0.00
89        11.3     1060.6       -0.26       0.14    1721.4        1.37
90        10.1     1035.6        0.23       0.22    1960.0        1.37
91        10.5      993.9       -0.25       0.44    1862.4        1.60
92        10.5      993.9       -0.25       0.44    1862.4        1.60
93        11.2      752.6       -0.36      -0.02    2105.7        0.40
94        10.7      870.9       -0.35       0.18    1886.0        1.10
95        11.3      725.8       -0.38       0.42    2019.7        1.00
96         9.5     1029.7        0.23       0.13    1692.1       -0.34
97        11.3      725.8       -0.38       0.42    2019.7        1.00
98        11.2      752.6       -0.36      -0.02    2105.7        0.40
99         0.0        0.0        0.00       0.00       0.0        0.00
100       10.1     1035.6        0.23       0.22    1960.0        1.37
101       11.3     1060.6       -0.26       0.14    1721.4        1.37
102        9.5     1029.7        0.23       0.13    1692.1       -0.34
103       10.5      993.9       -0.25       0.44    1862.4        1.60
104       10.7      870.9       -0.35       0.18    1886.0        1.10
105       10.5      993.9       -0.25       0.44    1862.4        1.60
106       10.7      870.9       -0.35       0.18    1886.0        1.10
107       10.5      993.9       -0.25       0.44    1862.4        1.60
108       11.2      752.6       -0.36      -0.02    2105.7        0.40
109       11.3      725.8       -0.38       0.42    2019.7        1.00
110       11.3     1060.6       -0.26       0.14    1721.4        1.37
111        0.0        0.0        0.00       0.00       0.0        0.00
112       10.1     1035.6        0.23       0.22    1960.0        1.37
113       10.5      993.9       -0.25       0.44    1862.4        1.60
114        9.5     1029.7        0.23       0.13    1692.1       -0.34
115       11.3     1060.6       -0.26       0.14    1721.4        1.37
116       11.3      725.8       -0.38       0.42    2019.7        1.00
117       10.5      993.9       -0.25       0.44    1862.4        1.60
118       11.2      752.6       -0.36      -0.02    2105.7        0.40
119        0.0        0.0        0.00       0.00       0.0        0.00
120       10.5      993.9       -0.25       0.44    1862.4        1.60
121       10.1     1035.6        0.23       0.22    1960.0        1.37
122        9.5     1029.7        0.23       0.13    1692.1       -0.34
123       10.7      870.9       -0.35       0.18    1886.0        1.10
124       10.2     1063.5       -0.25       0.28    1758.6        1.27
125       10.8     1013.6       -0.45      -0.24    1768.3        0.43
126       11.2     1047.7       -0.08       0.50    2022.8        1.10
127       10.6      980.7       -0.25       0.35    1890.3        1.24
128       11.2     1210.1       -0.35       0.13    1742.3        1.67
129        0.0        0.0        0.00       0.00       0.0        0.00
130        9.3     1390.5        0.52       0.07    1589.4       -0.14
131        9.9     1076.4       -0.10       0.19    1748.2        1.70
132       10.2     1063.5       -0.25       0.28    1758.6        1.27
133       10.2     1063.5       -0.25       0.28    1758.6        1.27
134        9.9     1076.4       -0.10       0.19    1748.2        1.70
135       11.2     1210.1       -0.35       0.13    1742.3        1.67
136        0.0        0.0        0.00       0.00       0.0        0.00
137       10.2     1063.5       -0.25       0.28    1758.6        1.27
138       10.6      980.7       -0.25       0.35    1890.3        1.24
139       10.8     1013.6       -0.45      -0.24    1768.3        0.43
140       11.2     1047.7       -0.08       0.50    2022.8        1.10
141        9.3     1390.5        0.52       0.07    1589.4       -0.14
142       10.2     1063.5       -0.25       0.28    1758.6        1.27
143       10.8     1013.6       -0.45      -0.24    1768.3        0.43
144        9.3     1390.5        0.52       0.07    1589.4       -0.14
145       10.2     1063.5       -0.25       0.28    1758.6        1.27
146        0.0        0.0        0.00       0.00       0.0        0.00
147       11.2     1047.7       -0.08       0.50    2022.8        1.10
148       11.2     1210.1       -0.35       0.13    1742.3        1.67
149       10.6      980.7       -0.25       0.35    1890.3        1.24
150        9.9     1076.4       -0.10       0.19    1748.2        1.70
151       11.2     1047.7       -0.08       0.50    2022.8        1.10
152        0.0        0.0        0.00       0.00       0.0        0.00
153       10.8     1013.6       -0.45      -0.24    1768.3        0.43
154       10.2     1063.5       -0.25       0.28    1758.6        1.27
155       10.6      980.7       -0.25       0.35    1890.3        1.24
156        9.9     1076.4       -0.10       0.19    1748.2        1.70
157       10.2     1063.5       -0.25       0.28    1758.6        1.27
158        9.3     1390.5        0.52       0.07    1589.4       -0.14
159       11.2     1210.1       -0.35       0.13    1742.3        1.67
160        0.0        0.0        0.00       0.00       0.0        0.00
161       10.2     1063.5       -0.25       0.28    1758.6        1.27
162       11.2     1210.1       -0.35       0.13    1742.3        1.67
163        9.9     1076.4       -0.10       0.19    1748.2        1.70
164       10.8     1013.6       -0.45      -0.24    1768.3        0.43
165       10.6      980.7       -0.25       0.35    1890.3        1.24
166        9.3     1390.5        0.52       0.07    1589.4       -0.14
167       11.2     1047.7       -0.08       0.50    2022.8        1.10
168       10.2     1063.5       -0.25       0.28    1758.6        1.27
169        9.3     1390.5        0.52       0.07    1589.4       -0.14
170        9.9     1076.4       -0.10       0.19    1748.2        1.70
171       10.2     1063.5       -0.25       0.28    1758.6        1.27
172        0.0        0.0        0.00       0.00       0.0        0.00
173       11.2     1210.1       -0.35       0.13    1742.3        1.67
174       10.8     1013.6       -0.45      -0.24    1768.3        0.43
175       10.2     1063.5       -0.25       0.28    1758.6        1.27
176       11.2     1047.7       -0.08       0.50    2022.8        1.10
177       10.6      980.7       -0.25       0.35    1890.3        1.24
178       11.2     1210.1       -0.35       0.13    1742.3        1.67
179        9.9     1076.4       -0.10       0.19    1748.2        1.70
180        9.3     1390.5        0.52       0.07    1589.4       -0.14
181       11.2     1047.7       -0.08       0.50    2022.8        1.10
182        0.0        0.0        0.00       0.00       0.0        0.00
183       10.6      980.7       -0.25       0.35    1890.3        1.24
184       10.2     1063.5       -0.25       0.28    1758.6        1.27
185       10.2     1063.5       -0.25       0.28    1758.6        1.27
186       10.8     1013.6       -0.45      -0.24    1768.3        0.43
187       11.2     1210.1       -0.35       0.13    1742.3        1.67
188        9.3     1390.5        0.52       0.07    1589.4       -0.14
189       10.8     1013.6       -0.45      -0.24    1768.3        0.43
190       10.2     1063.5       -0.25       0.28    1758.6        1.27
191        9.9     1076.4       -0.10       0.19    1748.2        1.70
192       10.6      980.7       -0.25       0.35    1890.3        1.24
193       10.2     1063.5       -0.25       0.28    1758.6        1.27
194       11.2     1047.7       -0.08       0.50    2022.8        1.10
195        0.0        0.0        0.00       0.00       0.0        0.00
196        9.3     1390.5        0.52       0.07    1589.4       -0.14
197       10.6      980.7       -0.25       0.35    1890.3        1.24
198       11.2     1210.1       -0.35       0.13    1742.3        1.67
199        0.0        0.0        0.00       0.00       0.0        0.00
200       10.2     1063.5       -0.25       0.28    1758.6        1.27
201       10.2     1063.5       -0.25       0.28    1758.6        1.27
202       11.2     1047.7       -0.08       0.50    2022.8        1.10
203       10.8     1013.6       -0.45      -0.24    1768.3        0.43
204        9.9     1076.4       -0.10       0.19    1748.2        1.70
205        9.9     1076.4       -0.10       0.19    1748.2        1.70
206       10.8     1013.6       -0.45      -0.24    1768.3        0.43
207        0.0        0.0        0.00       0.00       0.0        0.00
208       11.2     1047.7       -0.08       0.50    2022.8        1.10
209        9.3     1390.5        0.52       0.07    1589.4       -0.14
210       10.2     1063.5       -0.25       0.28    1758.6        1.27
211       10.2     1063.5       -0.25       0.28    1758.6        1.27
212       10.6      980.7       -0.25       0.35    1890.3        1.24
213       11.2     1210.1       -0.35       0.13    1742.3        1.67
214        9.9     1076.4       -0.10       0.19    1748.2        1.70
215       10.2     1063.5       -0.25       0.28    1758.6        1.27
216       10.2     1063.5       -0.25       0.28    1758.6        1.27
217        0.0        0.0        0.00       0.00       0.0        0.00
218       10.6      980.7       -0.25       0.35    1890.3        1.24
219       11.2     1210.1       -0.35       0.13    1742.3        1.67
220       11.2     1047.7       -0.08       0.50    2022.8        1.10
221       10.8     1013.6       -0.45      -0.24    1768.3        0.43
222        9.3     1390.5        0.52       0.07    1589.4       -0.14
223       11.2     1210.1       -0.35       0.13    1742.3        1.67
224       10.8     1013.6       -0.45      -0.24    1768.3        0.43
225       11.2     1047.7       -0.08       0.50    2022.8        1.10
226        9.9     1076.4       -0.10       0.19    1748.2        1.70
227        9.3     1390.5        0.52       0.07    1589.4       -0.14
228       10.2     1063.5       -0.25       0.28    1758.6        1.27
229       10.6      980.7       -0.25       0.35    1890.3        1.24
230        0.0        0.0        0.00       0.00       0.0        0.00
231       10.2     1063.5       -0.25       0.28    1758.6        1.27
233       10.6      972.1       -0.19       0.05    1828.8        0.43
234       10.3      919.3       -0.25       0.18    1748.3        2.00
235        9.6     1072.9        0.21       0.14    1674.8       -0.28
236       10.9      856.3       -0.03       0.55    1974.4        3.07
237       11.2      900.8       -0.46      -0.09    1855.8        0.30
238        0.0        0.0        0.00       0.00       0.0        0.00
239       11.4      836.8       -0.21       0.43    2078.9        1.03
240       11.5     1097.9       -0.26       0.11    1745.3        1.50
241       10.9      856.3       -0.03       0.55    1974.4        3.07
242        9.6     1072.9        0.21       0.14    1674.8       -0.28
243       11.2      900.8       -0.46      -0.09    1855.8        0.30
244       10.9      856.3       -0.03       0.55    1974.4        3.07
245        0.0        0.0        0.00       0.00       0.0        0.00
246       10.3      919.3       -0.25       0.18    1748.3        2.00
247       11.5     1097.9       -0.26       0.11    1745.3        1.50
248       10.9      856.3       -0.03       0.55    1974.4        3.07
249       11.4      836.8       -0.21       0.43    2078.9        1.03
251       10.6      972.1       -0.19       0.05    1828.8        0.43
252       10.6      972.1       -0.19       0.05    1828.8        0.43
253        9.6     1072.9        0.21       0.14    1674.8       -0.28
254        0.0        0.0        0.00       0.00       0.0        0.00
256       10.3      919.3       -0.25       0.18    1748.3        2.00
257       11.5     1097.9       -0.26       0.11    1745.3        1.50
258       11.2      900.8       -0.46      -0.09    1855.8        0.30
259       11.4      836.8       -0.21       0.43    2078.9        1.03
260       10.9      856.3       -0.03       0.55    1974.4        3.07
261       10.9      856.3       -0.03       0.55    1974.4        3.07
263       11.5     1097.9       -0.26       0.11    1745.3        1.50
264       10.9      856.3       -0.03       0.55    1974.4        3.07
265        0.0        0.0        0.00       0.00       0.0        0.00
266       11.4      836.8       -0.21       0.43    2078.9        1.03
267       10.6      972.1       -0.19       0.05    1828.8        0.43
268       10.3      919.3       -0.25       0.18    1748.3        2.00
269        9.6     1072.9        0.21       0.14    1674.8       -0.28
270       11.2      900.8       -0.46      -0.09    1855.8        0.30
271       10.9      856.3       -0.03       0.55    1974.4        3.07
272       10.6      972.1       -0.19       0.05    1828.8        0.43
273       10.3      919.3       -0.25       0.18    1748.3        2.00
274       11.2      900.8       -0.46      -0.09    1855.8        0.30
275       11.4      836.8       -0.21       0.43    2078.9        1.03
276       11.5     1097.9       -0.26       0.11    1745.3        1.50
277       10.9      856.3       -0.03       0.55    1974.4        3.07
278        0.0        0.0        0.00       0.00       0.0        0.00
280        9.6     1072.9        0.21       0.14    1674.8       -0.28
281       10.9      856.3       -0.03       0.55    1974.4        3.07
282        0.0        0.0        0.00       0.00       0.0        0.00
284       10.9      856.3       -0.03       0.55    1974.4        3.07
285       10.6      972.1       -0.19       0.05    1828.8        0.43
286       11.4      836.8       -0.21       0.43    2078.9        1.03
287       11.5     1097.9       -0.26       0.11    1745.3        1.50
288        9.6     1072.9        0.21       0.14    1674.8       -0.28
289       11.2      900.8       -0.46      -0.09    1855.8        0.30
290       10.9      856.3       -0.03       0.55    1974.4        3.07
291       10.3      919.3       -0.25       0.18    1748.3        2.00
293       10.9      856.3       -0.03       0.55    1974.4        3.07
294       10.6      972.1       -0.19       0.05    1828.8        0.43
295       11.5     1097.9       -0.26       0.11    1745.3        1.50
296       11.2      900.8       -0.46      -0.09    1855.8        0.30
297        9.6     1072.9        0.21       0.14    1674.8       -0.28
298       11.4      836.8       -0.21       0.43    2078.9        1.03
299        0.0        0.0        0.00       0.00       0.0        0.00
300       10.9      856.3       -0.03       0.55    1974.4        3.07
301       10.3      919.3       -0.25       0.18    1748.3        2.00
302       10.6      972.1       -0.19       0.05    1828.8        0.43
303       10.9      856.3       -0.03       0.55    1974.4        3.07
304       10.3      919.3       -0.25       0.18    1748.3        2.00
305       10.9      856.3       -0.03       0.55    1974.4        3.07
306        0.0        0.0        0.00       0.00       0.0        0.00
307        9.6     1072.9        0.21       0.14    1674.8       -0.28
308       11.4      836.8       -0.21       0.43    2078.9        1.03
310       11.2      900.8       -0.46      -0.09    1855.8        0.30
311       11.5     1097.9       -0.26       0.11    1745.3        1.50
312        0.0        0.0        0.00       0.00       0.0        0.00
313       10.9      856.3       -0.03       0.55    1974.4        3.07
314       11.4      836.8       -0.21       0.43    2078.9        1.03
315       10.3      919.3       -0.25       0.18    1748.3        2.00
316       11.2      900.8       -0.46      -0.09    1855.8        0.30
317       11.5     1097.9       -0.26       0.11    1745.3        1.50
318       10.9      856.3       -0.03       0.55    1974.4        3.07
319       10.6      972.1       -0.19       0.05    1828.8        0.43
321        9.6     1072.9        0.21       0.14    1674.8       -0.28
322        0.0        0.0        0.00       0.00       0.0        0.00
323       11.5     1097.9       -0.26       0.11    1745.3        1.50
324       10.9      856.3       -0.03       0.55    1974.4        3.07
325       10.3      919.3       -0.25       0.18    1748.3        2.00
326        9.6     1072.9        0.21       0.14    1674.8       -0.28
327       10.6      972.1       -0.19       0.05    1828.8        0.43
328       11.2      900.8       -0.46      -0.09    1855.8        0.30
329       11.4      836.8       -0.21       0.43    2078.9        1.03
330       10.9      856.3       -0.03       0.55    1974.4        3.07
332       10.9      856.3       -0.03       0.55    1974.4        3.07
334       11.4      836.8       -0.21       0.43    2078.9        1.03
335        9.6     1072.9        0.21       0.14    1674.8       -0.28
336       10.6      972.1       -0.19       0.05    1828.8        0.43
337        0.0        0.0        0.00       0.00       0.0        0.00
338       10.9      856.3       -0.03       0.55    1974.4        3.07
339       11.2      900.8       -0.46      -0.09    1855.8        0.30
340       11.5     1097.9       -0.26       0.11    1745.3        1.50
341       10.3      919.3       -0.25       0.18    1748.3        2.00
342        9.6     1072.9        0.21       0.14    1674.8       -0.28
343       11.4      836.8       -0.21       0.43    2078.9        1.03
345       11.5     1097.9       -0.26       0.11    1745.3        1.50
346       10.9      856.3       -0.03       0.55    1974.4        3.07
347       10.3      919.3       -0.25       0.18    1748.3        2.00
348       10.9      856.3       -0.03       0.55    1974.4        3.07
349       11.2      900.8       -0.46      -0.09    1855.8        0.30
350        0.0        0.0        0.00       0.00       0.0        0.00
351       10.6      972.1       -0.19       0.05    1828.8        0.43
352       10.9      856.3       -0.03       0.55    1974.4        3.07
353       10.6      972.1       -0.19       0.05    1828.8        0.43
354       11.2      900.8       -0.46      -0.09    1855.8        0.30
355       11.5     1097.9       -0.26       0.11    1745.3        1.50
357        0.0        0.0        0.00       0.00       0.0        0.00
358       10.3      919.3       -0.25       0.18    1748.3        2.00
359        9.6     1072.9        0.21       0.14    1674.8       -0.28
360       11.4      836.8       -0.21       0.43    2078.9        1.03
361       10.9      856.3       -0.03       0.55    1974.4        3.07
362       11.2      900.8       -0.46      -0.09    1855.8        0.30
363        9.6     1072.9        0.21       0.14    1674.8       -0.28
364       11.5     1097.9       -0.26       0.11    1745.3        1.50
365       10.6      972.1       -0.19       0.05    1828.8        0.43
367       11.4      836.8       -0.21       0.43    2078.9        1.03
368       10.9      856.3       -0.03       0.55    1974.4        3.07
369        0.0        0.0        0.00       0.00       0.0        0.00
370       10.9      856.3       -0.03       0.55    1974.4        3.07
371       10.3      919.3       -0.25       0.18    1748.3        2.00
372       11.2      900.8       -0.46      -0.09    1855.8        0.30
373       11.5     1097.9       -0.26       0.11    1745.3        1.50
374        9.6     1072.9        0.21       0.14    1674.8       -0.28
375       10.9      856.3       -0.03       0.55    1974.4        3.07
376        0.0        0.0        0.00       0.00       0.0        0.00
377       10.9      856.3       -0.03       0.55    1974.4        3.07
378       10.3      919.3       -0.25       0.18    1748.3        2.00
379       11.4      836.8       -0.21       0.43    2078.9        1.03
381       10.6      972.1       -0.19       0.05    1828.8        0.43
382       10.6      972.1       -0.19       0.05    1828.8        0.43
384       10.9      856.3       -0.03       0.55    1974.4        3.07
385       11.2      900.8       -0.46      -0.09    1855.8        0.30
386        9.6     1072.9        0.21       0.14    1674.8       -0.28
387       11.4      836.8       -0.21       0.43    2078.9        1.03
388        0.0        0.0        0.00       0.00       0.0        0.00
389       10.9      856.3       -0.03       0.55    1974.4        3.07
390       11.5     1097.9       -0.26       0.11    1745.3        1.50
391       10.3      919.3       -0.25       0.18    1748.3        2.00
392       11.2      900.8       -0.46      -0.09    1855.8        0.30
393       11.5     1097.9       -0.26       0.11    1745.3        1.50
394       10.6      972.1       -0.19       0.05    1828.8        0.43
395       10.9      856.3       -0.03       0.55    1974.4        3.07
396        9.6     1072.9        0.21       0.14    1674.8       -0.28
397       10.9      856.3       -0.03       0.55    1974.4        3.07
399        0.0        0.0        0.00       0.00       0.0        0.00
400       10.3      919.3       -0.25       0.18    1748.3        2.00
401       11.4      836.8       -0.21       0.43    2078.9        1.03
402       10.6      972.1       -0.19       0.05    1828.8        0.43
403       11.5     1097.9       -0.26       0.11    1745.3        1.50
404        0.0        0.0        0.00       0.00       0.0        0.00
405       11.2      900.8       -0.46      -0.09    1855.8        0.30
406       10.3      919.3       -0.25       0.18    1748.3        2.00
407       11.4      836.8       -0.21       0.43    2078.9        1.03
408        9.6     1072.9        0.21       0.14    1674.8       -0.28
410       10.9      856.3       -0.03       0.55    1974.4        3.07
411       10.9      856.3       -0.03       0.55    1974.4        3.07
412       11.2      900.8       -0.46      -0.09    1855.8        0.30
413       10.9      856.3       -0.03       0.55    1974.4        3.07
415       10.6      972.1       -0.19       0.05    1828.8        0.43
416        0.0        0.0        0.00       0.00       0.0        0.00
417       10.3      919.3       -0.25       0.18    1748.3        2.00
418        9.6     1072.9        0.21       0.14    1674.8       -0.28
419       11.5     1097.9       -0.26       0.11    1745.3        1.50
420       11.4      836.8       -0.21       0.43    2078.9        1.03
421       10.9      856.3       -0.03       0.55    1974.4        3.07
422        9.6     1072.9        0.21       0.14    1674.8       -0.28
424        0.0        0.0        0.00       0.00       0.0        0.00
425       10.9      856.3       -0.03       0.55    1974.4        3.07
426       10.3      919.3       -0.25       0.18    1748.3        2.00
427       11.4      836.8       -0.21       0.43    2078.9        1.03
428       10.9      856.3       -0.03       0.55    1974.4        3.07
429       11.2      900.8       -0.46      -0.09    1855.8        0.30
430       11.5     1097.9       -0.26       0.11    1745.3        1.50
431       10.6      972.1       -0.19       0.05    1828.8        0.43
432       10.9      856.3       -0.03       0.55    1974.4        3.07
433       11.2      900.8       -0.46      -0.09    1855.8        0.30
434        0.0        0.0        0.00       0.00       0.0        0.00
435       10.6      972.1       -0.19       0.05    1828.8        0.43
436       10.3      919.3       -0.25       0.18    1748.3        2.00
437       10.9      856.3       -0.03       0.55    1974.4        3.07
438        9.6     1072.9        0.21       0.14    1674.8       -0.28
439       11.5     1097.9       -0.26       0.11    1745.3        1.50
441       11.4      836.8       -0.21       0.43    2078.9        1.03
442        9.6     1072.9        0.21       0.14    1674.8       -0.28
443       11.2      900.8       -0.46      -0.09    1855.8        0.30
444       10.3      919.3       -0.25       0.18    1748.3        2.00
445       10.6      972.1       -0.19       0.05    1828.8        0.43
446       11.5     1097.9       -0.26       0.11    1745.3        1.50
447       10.9      856.3       -0.03       0.55    1974.4        3.07
448       10.9      856.3       -0.03       0.55    1974.4        3.07
450       11.4      836.8       -0.21       0.43    2078.9        1.03
451        0.0        0.0        0.00       0.00       0.0        0.00
452        0.0        0.0        0.00       0.00       0.0        0.00
453       10.6      972.1       -0.19       0.05    1828.8        0.43
454       10.9      856.3       -0.03       0.55    1974.4        3.07
455        9.6     1072.9        0.21       0.14    1674.8       -0.28
456       11.2      900.8       -0.46      -0.09    1855.8        0.30
458       10.9      856.3       -0.03       0.55    1974.4        3.07
459       11.4      836.8       -0.21       0.43    2078.9        1.03
460       11.5     1097.9       -0.26       0.11    1745.3        1.50
461       10.3      919.3       -0.25       0.18    1748.3        2.00
462       10.9      856.3       -0.03       0.55    1974.4        3.07
463        0.0        0.0        0.00       0.00       0.0        0.00
464       10.9      856.3       -0.03       0.55    1974.4        3.07
465       10.3      919.3       -0.25       0.18    1748.3        2.00
466       10.6      972.1       -0.19       0.05    1828.8        0.43
467       11.4      836.8       -0.21       0.43    2078.9        1.03
469       11.5     1097.9       -0.26       0.11    1745.3        1.50
470        9.6     1072.9        0.21       0.14    1674.8       -0.28
471       11.2      900.8       -0.46      -0.09    1855.8        0.30
    NA_weather
25       FALSE
26       FALSE
27       FALSE
28        TRUE
29       FALSE
30       FALSE
31       FALSE
32       FALSE
33       FALSE
34       FALSE
35       FALSE
36       FALSE
37       FALSE
38       FALSE
39       FALSE
40       FALSE
41        TRUE
42       FALSE
43       FALSE
44       FALSE
45       FALSE
46       FALSE
47       FALSE
48        TRUE
49       FALSE
50       FALSE
51       FALSE
52       FALSE
53       FALSE
54        TRUE
55       FALSE
56       FALSE
57       FALSE
58       FALSE
59       FALSE
60       FALSE
61       FALSE
62       FALSE
63        TRUE
64       FALSE
65       FALSE
66       FALSE
67       FALSE
68       FALSE
69       FALSE
70       FALSE
71       FALSE
72        TRUE
73       FALSE
74       FALSE
75       FALSE
76       FALSE
77       FALSE
78       FALSE
79       FALSE
80       FALSE
81       FALSE
82       FALSE
83        TRUE
84       FALSE
85       FALSE
86       FALSE
87       FALSE
88        TRUE
89       FALSE
90       FALSE
91       FALSE
92       FALSE
93       FALSE
94       FALSE
95       FALSE
96       FALSE
97       FALSE
98       FALSE
99        TRUE
100      FALSE
101      FALSE
102      FALSE
103      FALSE
104      FALSE
105      FALSE
106      FALSE
107      FALSE
108      FALSE
109      FALSE
110      FALSE
111       TRUE
112      FALSE
113      FALSE
114      FALSE
115      FALSE
116      FALSE
117      FALSE
118      FALSE
119       TRUE
120      FALSE
121      FALSE
122      FALSE
123      FALSE
124      FALSE
125      FALSE
126      FALSE
127      FALSE
128      FALSE
129       TRUE
130      FALSE
131      FALSE
132      FALSE
133      FALSE
134      FALSE
135      FALSE
136       TRUE
137      FALSE
138      FALSE
139      FALSE
140      FALSE
141      FALSE
142      FALSE
143      FALSE
144      FALSE
145      FALSE
146       TRUE
147      FALSE
148      FALSE
149      FALSE
150      FALSE
151      FALSE
152       TRUE
153      FALSE
154      FALSE
155      FALSE
156      FALSE
157      FALSE
158      FALSE
159      FALSE
160       TRUE
161      FALSE
162      FALSE
163      FALSE
164      FALSE
165      FALSE
166      FALSE
167      FALSE
168      FALSE
169      FALSE
170      FALSE
171      FALSE
172       TRUE
173      FALSE
174      FALSE
175      FALSE
176      FALSE
177      FALSE
178      FALSE
179      FALSE
180      FALSE
181      FALSE
182       TRUE
183      FALSE
184      FALSE
185      FALSE
186      FALSE
187      FALSE
188      FALSE
189      FALSE
190      FALSE
191      FALSE
192      FALSE
193      FALSE
194      FALSE
195       TRUE
196      FALSE
197      FALSE
198      FALSE
199       TRUE
200      FALSE
201      FALSE
202      FALSE
203      FALSE
204      FALSE
205      FALSE
206      FALSE
207       TRUE
208      FALSE
209      FALSE
210      FALSE
211      FALSE
212      FALSE
213      FALSE
214      FALSE
215      FALSE
216      FALSE
217       TRUE
218      FALSE
219      FALSE
220      FALSE
221      FALSE
222      FALSE
223      FALSE
224      FALSE
225      FALSE
226      FALSE
227      FALSE
228      FALSE
229      FALSE
230       TRUE
231      FALSE
233      FALSE
234      FALSE
235      FALSE
236      FALSE
237      FALSE
238       TRUE
239      FALSE
240      FALSE
241      FALSE
242      FALSE
243      FALSE
244      FALSE
245       TRUE
246      FALSE
247      FALSE
248      FALSE
249      FALSE
251      FALSE
252      FALSE
253      FALSE
254       TRUE
256      FALSE
257      FALSE
258      FALSE
259      FALSE
260      FALSE
261      FALSE
263      FALSE
264      FALSE
265       TRUE
266      FALSE
267      FALSE
268      FALSE
269      FALSE
270      FALSE
271      FALSE
272      FALSE
273      FALSE
274      FALSE
275      FALSE
276      FALSE
277      FALSE
278       TRUE
280      FALSE
281      FALSE
282       TRUE
284      FALSE
285      FALSE
286      FALSE
287      FALSE
288      FALSE
289      FALSE
290      FALSE
291      FALSE
293      FALSE
294      FALSE
295      FALSE
296      FALSE
297      FALSE
298      FALSE
299       TRUE
300      FALSE
301      FALSE
302      FALSE
303      FALSE
304      FALSE
305      FALSE
306       TRUE
307      FALSE
308      FALSE
310      FALSE
311      FALSE
312       TRUE
313      FALSE
314      FALSE
315      FALSE
316      FALSE
317      FALSE
318      FALSE
319      FALSE
321      FALSE
322       TRUE
323      FALSE
324      FALSE
325      FALSE
326      FALSE
327      FALSE
328      FALSE
329      FALSE
330      FALSE
332      FALSE
334      FALSE
335      FALSE
336      FALSE
337       TRUE
338      FALSE
339      FALSE
340      FALSE
341      FALSE
342      FALSE
343      FALSE
345      FALSE
346      FALSE
347      FALSE
348      FALSE
349      FALSE
350       TRUE
351      FALSE
352      FALSE
353      FALSE
354      FALSE
355      FALSE
357       TRUE
358      FALSE
359      FALSE
360      FALSE
361      FALSE
362      FALSE
363      FALSE
364      FALSE
365      FALSE
367      FALSE
368      FALSE
369       TRUE
370      FALSE
371      FALSE
372      FALSE
373      FALSE
374      FALSE
375      FALSE
376       TRUE
377      FALSE
378      FALSE
379      FALSE
381      FALSE
382      FALSE
384      FALSE
385      FALSE
386      FALSE
387      FALSE
388       TRUE
389      FALSE
390      FALSE
391      FALSE
392      FALSE
393      FALSE
394      FALSE
395      FALSE
396      FALSE
397      FALSE
399       TRUE
400      FALSE
401      FALSE
402      FALSE
403      FALSE
404       TRUE
405      FALSE
406      FALSE
407      FALSE
408      FALSE
410      FALSE
411      FALSE
412      FALSE
413      FALSE
415      FALSE
416       TRUE
417      FALSE
418      FALSE
419      FALSE
420      FALSE
421      FALSE
422      FALSE
424       TRUE
425      FALSE
426      FALSE
427      FALSE
428      FALSE
429      FALSE
430      FALSE
431      FALSE
432      FALSE
433      FALSE
434       TRUE
435      FALSE
436      FALSE
437      FALSE
438      FALSE
439      FALSE
441      FALSE
442      FALSE
443      FALSE
444      FALSE
445      FALSE
446      FALSE
447      FALSE
448      FALSE
450      FALSE
451       TRUE
452       TRUE
453      FALSE
454      FALSE
455      FALSE
456      FALSE
458      FALSE
459      FALSE
460      FALSE
461      FALSE
462      FALSE
463       TRUE
464      FALSE
465      FALSE
466      FALSE
467      FALSE
469      FALSE
470      FALSE
471      FALSE</code></pre>
</div>
</div></div>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>we used machine learning methods to assess how much information different sets of variables (c.f. <code>P_var_sets</code>) have each on the dependent variable (Puptake, Y-rel, P-balance), how redundant this information is. The machine learning methods to quantify the predictive power of different variable sets are: i) ordinary least squares (OLS) as a baseline; ii) XGBoost (gradient boosting with tree-based models and hyperparameter tuning for learning rate and tree depth) (arxiv:1603.02754); iii) Random Forests (with default parameters) (doi:10.1023/A:1010933404324). Computations were performed using the mlr3 framework (doi:10.21105/joss.01903). Performance was measured as percentage of explained variance on hold-out data via 5-fold cross-validation, calculated as (1 - MSE/Variance(y)), where MSE represents mean squared error.</p>
<p>We tried adjusting for weather variables but it seems that the ML-methods rather reconstruct the site-specific patterns….</p>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>